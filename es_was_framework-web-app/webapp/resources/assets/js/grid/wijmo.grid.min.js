/*!
    *
    * Wijmo Library 5.20193.646
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}();!function(e){!function(t){"use strict";var i=function(){function DataMap(t,i,o){this.mapChanged=new e.Event;if(e.isArray(t)&&!i&&!o){t=t.map((function(e){return{value:e}}));i=o="value"}this._cv=e.asCollectionView(t);this._keyPath=e.asString(i,!1);this._displayPath=e.asString(o,!1);this._cv.collectionChanged.addHandler(this.onMapChanged,this)}Object.defineProperty(DataMap.prototype,"sortByDisplayValues",{get:function(){return 1!=this._sortByKey},set:function(t){this._sortByKey=!e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(DataMap.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0});Object.defineProperty(DataMap.prototype,"selectedValuePath",{get:function(){return this._keyPath},enumerable:!0,configurable:!0});Object.defineProperty(DataMap.prototype,"displayMemberPath",{get:function(){return this._displayPath},enumerable:!0,configurable:!0});DataMap.prototype.getDataItem=function(t){var i=this;if(!this._hash){var o=this._cv.sourceCollection,n={};e.isArray(o)&&this._keyPath&&o.forEach((function(e){var t=e[i._keyPath];null==n[t]&&(n[t]=e)}));this._hash=n}return this._hash[t]};DataMap.prototype.getDisplayValue=function(e){var t=this._displayPath,i=this.getDataItem(e);return t&&i?i[t]:e};DataMap.prototype.getKeyValue=function(e,t){var i=this._displayPath,o=this._indexOf(e,i,t,!0);o<0&&(o=this._indexOf(e,i,t,!1));return o>-1?this._cv.sourceCollection[o][this._keyPath]:null};DataMap.prototype.getDisplayValues=function(e){var t=this;return this._cv&&this._displayPath?this._cv.items.map((function(e){return e[t._displayPath]})):[]};DataMap.prototype.getKeyValues=function(){var e=this;return this._cv&&this._keyPath?this._cv.items.map((function(t){return t[e._keyPath]})):[]};Object.defineProperty(DataMap.prototype,"isEditable",{get:function(){return this._editable},set:function(t){this._editable=e.asBoolean(t)},enumerable:!0,configurable:!0});DataMap.prototype.onMapChanged=function(e){this._hash=null;this.mapChanged.raise(this,e)};DataMap.prototype._indexOf=function(t,i,o,n){var r=-1,l=-1;if(this._cv&&i)for(var s=null!=t?t.toString():"",a=n?s:s.toLowerCase(),c=this._cv.sourceCollection,u=0;u<c.length;u++){var d=c[u],h=d[i];o&&(h=e.toPlainText(h));h==t?r=u:n||h.length!=a.length||h.toLowerCase()!=a?null!=h&&h.toString()==s&&(r=u):r=u;if(r==u){if(!this._cv.filter||this._cv.filter(d))return r;l<0&&(l=r)}}return l};return DataMap}();t.DataMap=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i=function(){function CellRange(e,t,i,o){void 0===e&&(e=-1);void 0===t&&(t=-1);void 0===i&&(i=e);void 0===o&&(o=t);this.setRange(e,t,i,o)}CellRange.prototype.setRange=function(t,i,o,n){void 0===t&&(t=-1);void 0===i&&(i=-1);void 0===o&&(o=t);void 0===n&&(n=i);this._row=e.asInt(t);this._col=e.asInt(i);this._row2=e.asInt(o);this._col2=e.asInt(n)};Object.defineProperty(CellRange.prototype,"row",{get:function(){return this._row},set:function(t){this._row=e.asInt(t)},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"col",{get:function(){return this._col},set:function(t){this._col=e.asInt(t)},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"row2",{get:function(){return this._row2},set:function(t){this._row2=e.asInt(t)},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"col2",{get:function(){return this._col2},set:function(t){this._col2=e.asInt(t)},enumerable:!0,configurable:!0});CellRange.prototype.clone=function(){return new CellRange(this._row,this._col,this._row2,this._col2)};CellRange.prototype.copy=function(e){this.setRange(e._row,e._col,e._row2,e._col2)};Object.defineProperty(CellRange.prototype,"rowSpan",{get:function(){return Math.abs(this._row2-this._row)+1},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"columnSpan",{get:function(){return Math.abs(this._col2-this._col)+1},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"topRow",{get:function(){return Math.min(this._row,this._row2)},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"bottomRow",{get:function(){return Math.max(this._row,this._row2)},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"leftCol",{get:function(){return Math.min(this._col,this._col2)},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"rightCol",{get:function(){return Math.max(this._col,this._col2)},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"isValid",{get:function(){return this._row>-1&&this._col>-1&&this._row2>-1&&this._col2>-1},enumerable:!0,configurable:!0});Object.defineProperty(CellRange.prototype,"isSingleCell",{get:function(){return this._row==this._row2&&this._col==this._col2},enumerable:!0,configurable:!0});CellRange.prototype.contains=function(t,i){var o=e.tryCast(t,CellRange);if(o)return o.topRow>=this.topRow&&o.bottomRow<=this.bottomRow&&o.leftCol>=this.leftCol&&o.rightCol<=this.rightCol;if(e.isInt(t)&&e.isInt(i))return t>=this.topRow&&t<=this.bottomRow&&i>=this.leftCol&&i<=this.rightCol;throw"contains expects a CellRange or row/column indices."};CellRange.prototype.containsRow=function(t){return e.asInt(t)>=this.topRow&&t<=this.bottomRow};CellRange.prototype.containsColumn=function(t){return e.asInt(t)>=this.leftCol&&t<=this.rightCol};CellRange.prototype.intersects=function(e){return this.intersectsRow(e)&&this.intersectsColumn(e)};CellRange.prototype.intersectsRow=function(e){return e&&!(this.bottomRow<e.topRow||this.topRow>e.bottomRow)};CellRange.prototype.intersectsColumn=function(e){return e&&!(this.rightCol<e.leftCol||this.leftCol>e.rightCol)};CellRange.prototype.getRenderSize=function(t){var i=new e.Size(0,0);if(this.isValid){for(var o=this.topRow;o<=this.bottomRow;o++)i.height+=t.rows[o].renderSize;for(var n=this.leftCol;n<=this.rightCol;n++)i.width+=t.columns[n].renderSize}return i};CellRange.prototype.equals=function(e){return e instanceof CellRange&&this._row==e._row&&this._col==e._col&&this._row2==e._row2&&this._col2==e._col2};return CellRange}();t.CellRange=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i=function(i){__extends(CellRangeEventArgs,i);function CellRangeEventArgs(o,n,r){var l=i.call(this)||this;l._p=e.asType(o,t.GridPanel,!0);l._rng=e.asType(n,t.CellRange,!0);l._data=r;return l}Object.defineProperty(CellRangeEventArgs.prototype,"panel",{get:function(){return this._p},enumerable:!0,configurable:!0});Object.defineProperty(CellRangeEventArgs.prototype,"range",{get:function(){return this._rng.clone()},enumerable:!0,configurable:!0});Object.defineProperty(CellRangeEventArgs.prototype,"row",{get:function(){return this._rng.row},enumerable:!0,configurable:!0});Object.defineProperty(CellRangeEventArgs.prototype,"col",{get:function(){return this._rng.col},enumerable:!0,configurable:!0});Object.defineProperty(CellRangeEventArgs.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0});return CellRangeEventArgs}(e.CancelEventArgs);t.CellRangeEventArgs=i;var o=function(t){__extends(FormatItemEventArgs,t);function FormatItemEventArgs(i,o,n){var r=t.call(this,i,o)||this;r._cell=e.asType(n,HTMLElement);return r}Object.defineProperty(FormatItemEventArgs.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0});return FormatItemEventArgs}(i);t.FormatItemEventArgs=o;var n=function(t){__extends(CellEditEndingEventArgs,t);function CellEditEndingEventArgs(){var e=null!==t&&t.apply(this,arguments)||this;e._stayInEditMode=!1;e._refresh=!0;return e}Object.defineProperty(CellEditEndingEventArgs.prototype,"stayInEditMode",{get:function(){return this._stayInEditMode},set:function(t){this._stayInEditMode=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(CellEditEndingEventArgs.prototype,"refresh",{get:function(){return this._refresh},set:function(t){this._refresh=e.asBoolean(t)},enumerable:!0,configurable:!0});return CellEditEndingEventArgs}(i);t.CellEditEndingEventArgs=n}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i,o;!function(e){e[e.None=0]="None";e[e.Cell=1]="Cell";e[e.CellRange=2]="CellRange";e[e.Row=3]="Row";e[e.RowRange=4]="RowRange";e[e.ListBox=5]="ListBox";e[e.MultiRange=6]="MultiRange"}(i=t.SelectionMode||(t.SelectionMode={}));!function(e){e[e.None=0]="None";e[e.Selected=1]="Selected";e[e.Cursor=2]="Cursor";e[e.Active=3]="Active"}(t.SelectedState||(t.SelectedState={}));!function(e){e[e.None=0]="None";e[e.Next=1]="Next";e[e.Prev=2]="Prev";e[e.NextPage=3]="NextPage";e[e.PrevPage=4]="PrevPage";e[e.Home=5]="Home";e[e.End=6]="End";e[e.NextCell=7]="NextCell";e[e.PrevCell=8]="PrevCell"}(o=t.SelMove||(t.SelMove={}));var n=function(){function _SelectionHandler(o){this._sel=new t.CellRange(0,0);this._mode=i.CellRange;this._rng=new t.CellRange(0,0);this._xsel=new e.collections.ObservableArray;this._g=o;this._e=new t.CellRangeEventArgs(o.cells,this._rng);this._xsel.collectionChanged.addHandler((function(){o.invalidate()}))}Object.defineProperty(_SelectionHandler.prototype,"selectionMode",{get:function(){return this._mode},set:function(e){if(e!=this._mode){var o=i;if(e==o.ListBox||this._mode==o.ListBox)for(var n=this._g.rows,r=0;r<n.length;r++){var l=e==i.ListBox&&this._sel.containsRow(r);n[r]._setFlag(t.RowColFlags.Selected,l,!0)}this._xsel.clear();var s=this._sel.clone();switch(e){case o.None:s.setRange(-1,-1);break;case o.Cell:s.row2=s.row;s.col2=s.col;break;case o.Row:s.row2=s.row}this._mode=e;this.select(s,!1,!0);this._g.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(_SelectionHandler.prototype,"selection",{get:function(){return this._sel},set:function(e){this.select(e)},enumerable:!0,configurable:!0});Object.defineProperty(_SelectionHandler.prototype,"extendedSelection",{get:function(){return this._xsel},enumerable:!0,configurable:!0});_SelectionHandler.prototype.select=function(o,n,r){void 0===n&&(n=!0);void 0===r&&(r=!1);if(e.isNumber(o)&&e.isNumber(n)){this._rng.setRange(o,n);n=!0}else o instanceof t.CellRange?this._rng.copy(o):e.assert(!1,"CellRange expected");var l=this._g,s=this._sel,a=this._rng,c=!1,u=i;switch(l.selectionMode){case u.Cell:a.row2=a.row;a.col2=a.col;break;case u.Row:a.row2=a.row;break;case u.ListBox:c=!0}var d=a.equals(s);c&&a.row>-1&&a.row<l.rows.length&&(l.rows[a.row].isSelected||(d=!1));if(d){n&&this._showSelection();return!0}var h=this._e;h._rng=a;h.cancel=!1;if(!l.onSelectionChanging(h)&&!r)return!1;if(c&&(a.row!=s.row||a.rowSpan>1||s.rowSpan>1))for(var g=0;g<l.rows.length;g++)l.rows[g]._setFlag(t.RowColFlags.Selected,a.containsRow(g),!0);a.row=Math.min(a.row,l.rows.length-1);a.row2=Math.min(a.row2,l.rows.length-1);this._sel.copy(a);l.refreshCells(!1,!0,!0);n&&this._showSelection();if(l.collectionView){var f=l._getCvIndex(a.row);l.collectionView.moveCurrentToPosition(f)}l.onSelectionChanged(h);return!0};_SelectionHandler.prototype.moveSelection=function(e,i,n){var r=this._g,l=this._sel,s=n&&r.anchorCursor?new t.CellRange(l.row2,l.col2):new t.CellRange(l.row,l.col);this._adjustReferenceCell(s,e,i);var a=s.row,c=s.col,u=r.rows,d=r.columns,h=Math.max(0,r._szClient.height-r.columnHeaders.height),g=o;switch(i){case g.NextCell:if((c=d.getNextCell(c,g.Next,h))==s.col&&(a=u.getNextCell(a,g.Next,h))>s.row){c=d.getNextCell(0,g.Next,h);c=d.getNextCell(c,g.Prev,h)}r.select(a,c);break;case g.PrevCell:if((c=d.getNextCell(s.col,g.Prev,h))==s.col&&(a=u.getNextCell(a,g.Prev,h))<s.row){c=d.getNextCell(d.length-1,g.Prev,h);c=d.getNextCell(c,g.Next,h)}r.select(a,c);break;default:a=u.getNextCell(a,e,h);c=d.getNextCell(c,i,h);n?r.selection=r.anchorCursor?new t.CellRange(l.row,l.col,a,c):new t.CellRange(a,c,l.row2,l.col2):r.select(a,c)}};_SelectionHandler.prototype._showSelection=function(){var e=this._g,t=this._sel;e.anchorCursor?e.scrollIntoView(t.row2,t.col2):e.scrollIntoView(t.row,t.col)};_SelectionHandler.prototype._adjustReferenceCell=function(e,t,i){var n=this._g,r=n.getMergedRange(n.cells,e.row,e.col);if(r&&!r.isSingleCell){var l=o;switch(t){case l.Next:case l.NextCell:e.row=r.bottomRow;break;case l.Prev:case l.PrevCell:e.row=r.topRow}switch(i){case l.Next:case l.NextCell:e.col=r.rightCol;break;case l.Prev:case l.PrevCell:e.col=r.leftCol}}};return _SelectionHandler}();t._SelectionHandler=n}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i;!function(e){e[e.Visible=1]="Visible";e[e.AllowResizing=2]="AllowResizing";e[e.AllowDragging=4]="AllowDragging";e[e.AllowMerging=8]="AllowMerging";e[e.AllowSorting=16]="AllowSorting";e[e.AutoGenerated=32]="AutoGenerated";e[e.Collapsed=64]="Collapsed";e[e.ParentCollapsed=128]="ParentCollapsed";e[e.Selected=256]="Selected";e[e.ReadOnly=512]="ReadOnly";e[e.HtmlContent=1024]="HtmlContent";e[e.WordWrap=2048]="WordWrap";e[e.MultiLine=4096]="MultiLine";e[e.HasTemplate=8192]="HasTemplate";e[e.RowDefault=3]="RowDefault";e[e.ColumnDefault=23]="ColumnDefault"}(i=t.RowColFlags||(t.RowColFlags={}));var o=function(){function RowCol(){this._pos=0;this._idx=-1;this._vidx=-1;this.gridChanged=new e.Event}Object.defineProperty(RowCol.prototype,"binding",{get:function(){return this._binding?this._binding.path:null},set:function(t){if(t!=this.binding){var i=e.asString(t);this._binding=i?new e.Binding(i):null;if(!this._type&&this.grid&&this._binding){var o=this.grid.collectionView;if(o&&o.sourceCollection&&o.sourceCollection.length){var n=o.sourceCollection[0];this._type=e.getType(this._binding.getValue(n))}}this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"sortMemberPath",{get:function(){return this._bindingSort?this._bindingSort.path:null},set:function(t){if(t!=this.sortMemberPath){var i=e.asString(t);this._bindingSort=i?new e.Binding(i):null;this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"dataType",{get:function(){return this._type},set:function(t){t=e.asEnum(t,e.DataType,!0);if(this._type!=t){this._type=t;this.grid&&this.grid.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"inputType",{get:function(){return this._inpType},set:function(t){this._inpType=e.asString(t,!0)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask=e.asString(t,!0)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"maxLength",{get:function(){return this._maxLen},set:function(t){this._maxLen=e.asNumber(t,!0,!0)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"align",{get:function(){return this._align},set:function(e){if(this._align!=e){this._align=e;this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"format",{get:function(){return this._fmt},set:function(e){if(this._fmt!=e){this._fmt=e;this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"dataMap",{get:function(){return this._map},set:function(i){if(this._map!=i){this._map&&this._map.mapChanged.removeHandler(this.onPropertyChanged,this);e.isArray(i)&&(i=new t.DataMap(i,null,null));this._map=e.asType(i,t.DataMap,!0);this._map&&this._map.mapChanged.addHandler(this.onPropertyChanged,this);this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"showDropDown",{get:function(){return this._showDropDown},set:function(t){if(t!=this._showDropDown){this._showDropDown=e.asBoolean(t,!0);this.grid&&this.grid.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"dropDownCssClass",{get:function(){return this._ddCssClass},set:function(t){this._ddCssClass=e.asString(t)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"visible",{get:function(){return this._getFlag(i.Visible)},set:function(e){this._setFlag(i.Visible,e)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"isVisible",{get:function(){return!!this._getFlag(i.Visible)&&(!this._getFlag(i.ParentCollapsed)||this instanceof t._NewRowTemplate)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"pos",{get:function(){this._list&&this._list._dirty&&this._list._update();return this._pos},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"index",{get:function(){this._list&&this._list._dirty&&this._list._update();return this._idx},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"visibleIndex",{get:function(){this._list&&this._list._dirty&&this._list._update();return this.isVisible?this._vidx:-1},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"size",{get:function(){return this._sz},set:function(t){if(t!=this._sz){this._sz=e.asNumber(t,!0);this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"renderSize",{get:function(){var e=0,t=this._list;if(this.isVisible){(null==(e=this._sz)||e<0)&&(e=t?t.defaultSize:0);t&&null!=t.minSize&&e<t.minSize&&(e=t.minSize);t&&null!=t.maxSize&&e>t.maxSize&&(e=t.maxSize);null!=this._szMin&&e<this._szMin&&(e=this._szMin);null!=this._szMax&&e>this._szMax&&(e=this._szMax)}return e},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"allowResizing",{get:function(){return this._getFlag(i.AllowResizing)},set:function(e){this._setFlag(i.AllowResizing,e)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"allowDragging",{get:function(){return this._getFlag(i.AllowDragging)},set:function(e){this._setFlag(i.AllowDragging,e)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"allowMerging",{get:function(){return this._getFlag(i.AllowMerging)},set:function(e){this._setFlag(i.AllowMerging,e)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"isSelected",{get:function(){return this._getFlag(i.Selected)},set:function(e){if(this._setFlag(i.Selected,e,!0)){var t=this.grid;t&&t.refreshCells(!1,!0,!0)}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"isReadOnly",{get:function(){return this._getFlag(i.ReadOnly)},set:function(e){this._setFlag(i.ReadOnly,e)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"isRequired",{get:function(){return this._required},set:function(t){this._required=e.asBoolean(t,!0)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"isContentHtml",{get:function(){return this._getFlag(i.HtmlContent)},set:function(e){if(this.isContentHtml!=e){this._setFlag(i.HtmlContent,e);this.grid&&this.grid.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"wordWrap",{get:function(){return this._getFlag(i.WordWrap)},set:function(e){this._setFlag(i.WordWrap,e)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"multiLine",{get:function(){return this._getFlag(i.MultiLine)},set:function(e){this._setFlag(i.MultiLine,e)},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"cssClass",{get:function(){return this._cssClass},set:function(t){if(t!=this._cssClass){this._cssClass=e.asString(t);this.grid&&this.grid.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"cssClassAll",{get:function(){return this._cssClassAll},set:function(t){if(t!=this._cssClassAll){this._cssClassAll=e.asString(t);this.grid&&this.grid.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"grid",{get:function(){return this._list?this._list._g:null},enumerable:!0,configurable:!0});Object.defineProperty(RowCol.prototype,"collectionView",{get:function(){return this.grid?this.grid.collectionView:null},enumerable:!0,configurable:!0});RowCol.prototype.onPropertyChanged=function(){if(this._list){this._list._dirty=!0;this.grid.invalidate()}};RowCol.prototype.onGridChanged=function(e){this.gridChanged.raise(this,e)};RowCol.prototype._setList=function(e){if(e!=this._list){this._list=e;this.onGridChanged()}};RowCol.prototype._getFlag=function(e){return 0!=(this._f&e)};RowCol.prototype._setFlag=function(e,t,i){if(t!=this._getFlag(e)){this._f=t?this._f|e:this._f&~e;i||this.onPropertyChanged();return!0}return!1};return RowCol}();t.RowCol=o;var n=function(t){__extends(Column,t);function Column(o){var n=t.call(this)||this;n._f=i.ColumnDefault;n._hash=Column._ctr.toString(36);Column._ctr++;o&&e.copy(n,o);return n}Object.defineProperty(Column.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"width",{get:function(){return null!=this._szStar?this._szStar:this.size},set:function(t){if(null!=Column._parseStarSize(t)){this._szStar=t;this.onPropertyChanged()}else{this._szStar=null;this.size=e.asNumber(t,!0)}},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"minWidth",{get:function(){return this._szMin},set:function(t){if(t!=this._szMin){this._szMin=e.asNumber(t,!0,!0);this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"maxWidth",{get:function(){return this._szMax},set:function(t){if(t!=this._szMax){this._szMax=e.asNumber(t,!0,!0);this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"quickAutoSize",{get:function(){return this._quickSize},set:function(t){this._quickSize=e.asBoolean(t,!0)},enumerable:!0,configurable:!0});Column.prototype._getQuickAutoSize=function(){return!!this.grid._getQuickAutoSize()&&(e.isBoolean(this._quickSize)?this._quickSize:!(this.isContentHtml||this.wordWrap||this.multiLine||this._getFlag(i.HasTemplate)))};Object.defineProperty(Column.prototype,"renderWidth",{get:function(){return this.renderSize},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"header",{get:function(){return this._hdr?this._hdr:this.binding},set:function(e){if(this._hdr!=e){this._hdr=e;this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"cellTemplate",{get:function(){return this._tpl},set:function(t){if(t!=this._tpl){e.assert(null==t||e.isString(t)||e.isFunction(t),"cellTemplate should be a string or an ICellTemplate/");this._tpl=t;this._setFlag(i.HasTemplate,null!=t&&""!=t);this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"allowSorting",{get:function(){return this._getFlag(i.AllowSorting)},set:function(e){this._setFlag(i.AllowSorting,e)},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"currentSort",{get:function(){var e=this.currentSortIndex;if(e>-1){return this.grid.collectionView.sortDescriptions[e].ascending?"+":"-"}return null},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"currentSortIndex",{get:function(){var e=this.grid?this.grid.collectionView:null,t=e?e.sortDescriptions:null,i=t&&t.length?this._getBindingSort():null;if(i)for(var o=0;o<t.length;o++)if(t[o].property==i)return o;return-1},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"aggregate",{get:function(){return null!=this._agg?this._agg:e.Aggregate.None},set:function(t){if((t=e.asEnum(t,e.Aggregate))!=this._agg){this._agg=t;this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(Column.prototype,"describedById",{get:function(){return this._descById},set:function(t){if(t!=this._descById){this._descById=e.asString(t);this.grid&&this.grid.invalidate()}},enumerable:!0,configurable:!0});Column.prototype.getIsRequired=function(t){return null!=this._required?this._required:t&&null!=t.isRequired?t.isRequired:this.dataType==e.DataType.String?null!=this.dataMap||null!=this._mask&&this._mask.length>0:!t||t.dataType!=e.DataType.String||(null!=t.dataMap||null!=t.mask&&t.mask.length>0)};Column.prototype.getAlignment=function(t){if(null!=this._align)return this._align;if(t&&null!=t.align)return t.align;if(!this._map)switch(this.dataType){case e.DataType.Boolean:return"center";case e.DataType.Number:return"right"}if(t&&!t.dataMap)switch(t.dataType){case e.DataType.Boolean:return"center";case e.DataType.Number:return"right"}return""};Column.prototype._getBindingSort=function(){return this.sortMemberPath?this.sortMemberPath:this.binding?this.binding:null};Column._parseStarSize=function(t){if(e.isString(t)&&t.length>0&&"*"==t[t.length-1]){var i=1==t.length?1:1*t.substr(0,t.length-1);if(i>0&&!isNaN(i))return i}return null};Column._ctr=0;return Column}(o);t.Column=n;var r=function(e){__extends(Row,e);function Row(t){var o=e.call(this)||this;o._f=i.ColumnDefault;o._data=t;return o}Object.defineProperty(Row.prototype,"dataItem",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0});Object.defineProperty(Row.prototype,"height",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0});Object.defineProperty(Row.prototype,"renderHeight",{get:function(){return this.renderSize},enumerable:!0,configurable:!0});return Row}(o);t.Row=r;var l=function(o){__extends(GroupRow,o);function GroupRow(t){var i=o.call(this,t)||this;i._level=-1;i.level=t instanceof e.collections.CollectionViewGroup?t.level:-1;i.isReadOnly=!0;return i}Object.defineProperty(GroupRow.prototype,"level",{get:function(){return this._level},set:function(t){e.asInt(t);if(t!=this._level){this._level=t;this.onPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(GroupRow.prototype,"hasChildren",{get:function(){if(null!=this.grid&&null!=this._list){this._list._update();var i=this.index<this._list.length-1?this._list[this.index+1]:null,o=e.tryCast(i,GroupRow),n=e.tryCast(i,t._NewRowTemplate);return null!=i&&null==n&&(null==o||o.level>this.level)}return!0},enumerable:!0,configurable:!0});Object.defineProperty(GroupRow.prototype,"isCollapsed",{get:function(){return this._getFlag(i.Collapsed)},set:function(t){t!=this.isCollapsed&&null!=this._list&&this._setCollapsed(e.asBoolean(t))},enumerable:!0,configurable:!0});GroupRow.prototype.getGroupHeader=function(){var t=this.grid,i=t.groupHeaderFormat||e.culture.FlexGrid.groupHeaderFormat,o=this.dataItem;if(o instanceof e.collections.CollectionViewGroup&&i&&t.showGroups&&!t.childItemsPath){var n=o.groupDescription.propertyName,r=o.name,l=t.getColumn(n),s=this.isContentHtml;if(l){s=s||l.isContentHtml;l.header&&(n=l.header);var a=l.dataMap;a&&(r=a.getDisplayValue(r));l.dataType==e.getType(r)&&(r=e.Globalize.format(r,l.format))}else n=e.toHeaderCase(n);var c=o.getAggregate(e.Aggregate.CntAll,null,t.collectionView);return e.format(i,{name:e.escapeHtml(n),value:s?r:e.escapeHtml(r),level:o.level,count:c})}return""};GroupRow.prototype._setCollapsed=function(e){var o=this,n=this.grid,r=n.rows,l=this.getCellRange(),s=new t.CellRangeEventArgs(n.cells,new t.CellRange(this.index,-1));if(n.onGroupCollapsedChanging(s)){n.deferUpdate((function(){r.deferUpdate((function(){o._setFlag(i.Collapsed,e,!0);for(var t=l.topRow+1;t<=l.bottomRow&&t>-1&&t<r.length;t++){r[t]._setFlag(i.ParentCollapsed,e,!0);var n=r[t];n instanceof GroupRow&&n.isCollapsed&&(t=n.getCellRange().bottomRow)}}))}));n.onGroupCollapsedChanged(s)}};GroupRow.prototype.getCellRange=function(){for(var e=this._list,i=this.index,o=e.length-1,n=i+1;n<=o;n++){var r=e[n];if(r instanceof GroupRow&&r.level<=this.level){o=n-1;break}}return new t.CellRange(i,0,o,this.grid.columns.length-1)};return GroupRow}(r);t.GroupRow=l;var s=function(i){__extends(RowColCollection,i);function RowColCollection(o,n){var r=i.call(this)||this;r._frozen=0;r._lastFrozen=-1;r._firstVisible=-1;r._vlen=0;r._szDef=28;r._szTot=0;r._szCustom=!1;r._dirty=!1;r._g=e.asType(o,t.FlexGrid);r._szDef=e.asNumber(n,!1,!0);return r}Object.defineProperty(RowColCollection.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0});Object.defineProperty(RowColCollection.prototype,"defaultSize",{get:function(){return this._szDef},set:function(t){this._szCustom=!0;if(this._szDef!=t){this._szDef=e.asNumber(t,!1,!0);this._dirty=!0;this._g.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(RowColCollection.prototype,"frozen",{get:function(){return this._frozen},set:function(t){if(t!=this._frozen){this._frozen=e.asNumber(t,!1,!0);this._dirty=!0;this._g.invalidate()}},enumerable:!0,configurable:!0});RowColCollection.prototype.isFrozen=function(e){return e<this.frozen};Object.defineProperty(RowColCollection.prototype,"minSize",{get:function(){return this._szMin},set:function(t){if(t!=this._szMin){this._szMin=e.asNumber(t,!0,!0);this._dirty=!0;this._g.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(RowColCollection.prototype,"maxSize",{get:function(){return this._szMax},set:function(t){if(t!=this._szMax){this._szMax=e.asNumber(t,!0,!0);this._dirty=!0;this._g.invalidate()}},enumerable:!0,configurable:!0});RowColCollection.prototype.getTotalSize=function(){this._dirty&&this._update();return this._szTot};Object.defineProperty(RowColCollection.prototype,"visibleLength",{get:function(){this._dirty&&this._update();return this._vlen},enumerable:!0,configurable:!0});RowColCollection.prototype.getItemAt=function(e){this._dirty&&this._update();if(e<=0&&this.length>0&&this[0].renderSize)return 0;for(var t,i,o=this.length,n=0,r=o-1;n<=r;)if((i=this[t=n+r>>>1])._pos>e&&t>0)r=t-1;else{if(!(i._pos+i.renderSize<=e&&t<o-1)){for(;t>0&&!this[t].renderSize;)t--;for(;t<o-1&&!this[t].renderSize;)t++;return t}n=t+1}return r};RowColCollection.prototype.getNextCell=function(e,i,o){var n,r=t.SelMove;switch(i){case r.Next:for(n=e+1;n<this.length;n++)if(this[n].renderSize>0)return n;break;case r.Prev:for(n=e-1;n>=0;n--)if(this[n].renderSize>0)return n;break;case r.End:for(n=this.length-1;n>=0;n--)if(this[n].renderSize>0)return n;break;case r.Home:for(n=0;n<this.length;n++)if(this[n].renderSize>0)return n;break;case r.NextPage:return(n=this.getItemAt(this[e].pos+this[e].renderSize+o))<0?this.getNextCell(e,t.SelMove.End,o):n==e&&n<this.length-1&&this[n+1].renderSize?n+1:n;case r.PrevPage:return(n=this.getItemAt(this[e].pos-o))<0?this.getNextCell(e,t.SelMove.Home,o):n==e&&n>0&&this[n-1].renderSize?n-1:n}return e};RowColCollection.prototype.canMoveElement=function(e,i){if(i==e)return!1;if(e<0||e>=this.length||i>=this.length)return!1;i<0&&(i=this.length-1);for(var o=Math.min(e,i),n=Math.max(e,i),r=o;r<=n;r++)if(!this[r].allowDragging)return!1;return!(this[i]instanceof t._NewRowTemplate)};RowColCollection.prototype.moveElement=function(e,t,i){void 0===i&&(i=!1);if(this.canMoveElement(e,t)){var o=this[e];this.removeAt(e);t<0&&(t=this.length);this.insert(t,o);if(!i){var n=this.frozen;e<n&&t>=n?this.frozen--:e>=n&&t<n&&this.frozen++}}};RowColCollection.prototype.onCollectionChanged=function(t){void 0===t&&(t=e.collections.NotifyCollectionChangedEventArgs.reset);this._dirty=!0;this._g.invalidate();i.prototype.onCollectionChanged.call(this,t)};RowColCollection.prototype.push=function(e){e._setList(this);return i.prototype.push.call(this,e)};RowColCollection.prototype.splice=function(e,t,o){for(var n=0;n<t;n++){var r=this[e+n];r&&r._setList(null)}o&&o._setList(this);return i.prototype.splice.call(this,e,t,o)};RowColCollection.prototype.beginUpdate=function(){this._update();i.prototype.beginUpdate.call(this)};RowColCollection.prototype._setDefaultSize=function(e){if(!this._szCustom){this.defaultSize=e;this._szCustom=!1}};RowColCollection.prototype._update=function(){if(this._dirty&&!this.isUpdating){this._dirty=!1;this._lastFrozen=-1;this._firstVisible=-1;for(var e=0,t=0,i=void 0,o=void 0,n=0;n<this.length;n++){(o=this[n])._idx=n;o._vidx=e;o._pos=t;o._setList(this);if((i=o.renderSize)>0){t+=i;e++;n<this._frozen&&(this._lastFrozen=n)}this._firstVisible<0&&o.visible&&(this._firstVisible=n)}this._vlen=e;this._szTot=t;return!0}return!1};return RowColCollection}(e.collections.ObservableArray);t.RowColCollection=s;var a=function(t){__extends(ColumnCollection,t);function ColumnCollection(){return null!==t&&t.apply(this,arguments)||this}ColumnCollection.prototype.getColumn=function(t){var i=e.isNumber(t)?t:this.indexOf(t);return i>-1?this[i]:null};ColumnCollection.prototype.indexOf=function(e){if(e instanceof n)return t.prototype.indexOf.call(this,e);for(var i=0;i<this.length;i++)if(this[i].name==e)return i;for(i=0;i<this.length;i++)if(this[i].binding==e)return i;return-1};Object.defineProperty(ColumnCollection.prototype,"describedById",{get:function(){return this._descById},set:function(t){if(t!=this._descById){this._descById=e.asString(t);this._g&&this._g.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(ColumnCollection.prototype,"firstVisibleIndex",{get:function(){this._dirty&&this._update();return this._firstVisible},enumerable:!0,configurable:!0});ColumnCollection.prototype._updateStarSizes=function(e){for(var t,i=!1,o=0,r=0;r<this.length;r++){if((s=this[r]).isVisible)if(s._szStar){o+=n._parseStarSize(s._szStar);t=s}else e-=s.renderWidth}if(t){var l=e;for(r=0;r<this.length;r++){var s;if((s=this[r]).isVisible&&s._szStar){var a=s._sz;s==t&&l>0?a=l:l-=a=Math.max(0,Math.round(n._parseStarSize(s._szStar)/o*e));if(a!=s._sz){s._sz=a;i=!0}}}if(i){this._dirty=!0;this._update()}return i}return!1};return ColumnCollection}(s);t.ColumnCollection=a;var c=function(t){__extends(RowCollection,t);function RowCollection(){var e=null!==t&&t.apply(this,arguments)||this;e._maxLevel=-1;return e}Object.defineProperty(RowCollection.prototype,"ariaLabel",{get:function(){return this._ariaLabel},set:function(t){if(t!=this.ariaLabel){this._ariaLabel=e.asString(t);this._g&&this._g.refresh()}},enumerable:!0,configurable:!0});Object.defineProperty(RowCollection.prototype,"maxGroupLevel",{get:function(){this._dirty&&this._update();return this._maxLevel},enumerable:!0,configurable:!0});RowCollection.prototype._update=function(){if(t.prototype._update.call(this)){this._maxLevel=-1;for(var e=0;e<this.length;e++){var i=this[e];i instanceof l&&i.level>this._maxLevel&&(this._maxLevel=i.level)}return!0}return!1};return RowCollection}(s);t.RowCollection=c}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i=function(){function _AddNewHandler(e){this._nrt=new o;this._g=e;this._keydownBnd=this._keydown.bind(this);this._attach()}Object.defineProperty(_AddNewHandler.prototype,"newRowAtTop",{get:function(){return this._top},set:function(i){if(i!=this.newRowAtTop){this._top=e.asBoolean(i);this.updateNewRowTemplate();var o=this._g;if(this._top&&o.selectionMode==t.SelectionMode.ListBox){o.rows.forEach((function(e,i){e._setFlag(t.RowColFlags.Selected,0==i,!0)}));o.select(0,o.selection.col)}}},enumerable:!0,configurable:!0});_AddNewHandler.prototype.updateNewRowTemplate=function(){var e=this._g,i=e.editableCollectionView,o=e.rows,n=this._nrt,r=i&&i.canAddNew&&e.allowAddNew&&!e.isReadOnly,l=o.indexOf(n),s=this._top?0:o.length-1,a=!1;if(!r&&l>-1){var c=e.selection;c.row==l&&e.select(c.row-1,c.col);o.removeAt(l)}else if(r){if(l<0)a=!0;else if(l!=s){o.removeAt(l);a=!0}a&&(this._top?o.insert(0,n):o.push(n));if(n){n._setFlag(t.RowColFlags.ParentCollapsed,!1);this._top&&e.selectionMode==t.SelectionMode.ListBox||n._setFlag(t.RowColFlags.Selected,!1)}}};_AddNewHandler.prototype._attach=function(){var e=this._g;if(e){e.beginningEdit.addHandler(this._beginningEdit,this);e.pastingCell.addHandler(this._beginningEdit,this);e.rowEditEnded.addHandler(this._rowEditEnded,this);e.loadedRows.addHandler(this.updateNewRowTemplate,this);e.hostElement.addEventListener("keydown",this._keydownBnd,!0)}};_AddNewHandler.prototype._detach=function(){var e=this._g;if(e){e.beginningEdit.removeHandler(this._beginningEdit);e.pastingCell.removeHandler(this._beginningEdit);e.rowEditEnded.removeHandler(this._rowEditEnded);e.loadedRows.removeHandler(this.updateNewRowTemplate);e.hostElement.removeEventListener("keydown",this._keydownBnd,!0)}};_AddNewHandler.prototype._keydown=function(t){if(!t.defaultPrevented&&t.keyCode==e.Key.Escape&&null==this._g.activeEditor&&this._top&&this._nrt.dataItem){this._nrt.dataItem=null;this._g.invalidate()}};_AddNewHandler.prototype._beginningEdit=function(t,i){if(!i.cancel){var n=t.rows[i.row];if(e.tryCast(n,o)){var r=t.editableCollectionView;if(r&&r.canAddNew)if(this._top){if(null==this._nrt.dataItem){var l=null,s=r.sourceCollection,a=r.newItemCreator;l=e.isFunction(a)?a():s&&s.length?new s[0].constructor:{};this._nrt.dataItem=l}}else{l=r.currentAddItem&&r.currentAddItem==n.dataItem?r.currentAddItem:r.addNew();r.moveCurrentTo(l);var c=this._nrt.isSelected;this.updateNewRowTemplate();c&&i.row>-1&&(t.rows[i.row].isSelected=!0);t.refresh(!0);t.onRowAdded(i);i.cancel&&r.cancelNew()}}}};_AddNewHandler.prototype._rowEditEnded=function(e,t){var i=this,o=e.editableCollectionView,n=this._nrt.dataItem;if(o&&!this._committing)if(o.isAddingNew)o.commitNew();else if(n&&!t.cancel){this._committing=!0;this._nrt.dataItem=null;var r=o.addNew();for(var l in n)r[l]=n[l];e.onRowAdded(t);t.cancel?o.cancelNew():o.commitNew();setTimeout((function(){e.select(0,e.columns.firstVisibleIndex);i.updateNewRowTemplate()}),20);this._committing=!1}};return _AddNewHandler}();t._AddNewHandler=i;var o=function(e){__extends(_NewRowTemplate,e);function _NewRowTemplate(){return null!==e&&e.apply(this,arguments)||this}return _NewRowTemplate}(t.Row);t._NewRowTemplate=o}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i,o,n,r;e._addCultureInfo("FlexGrid",{groupHeaderFormat:"{name}: <b>{value}</b> ({count:n0} items)",ariaLabels:{toggleDropDown:"Toggle Dropdown",toggleGroup:"Toggle Group"}});!function(e){e[e.None=0]="None";e[e.SingleColumn=1]="SingleColumn";e[e.MultiColumn=2]="MultiColumn"}(o=t.AllowSorting||(t.AllowSorting={}));!function(e){e[e.None=0]="None";e[e.Column=1]="Column";e[e.Row=2]="Row";e[e.All=3]="All"}(n=t.HeadersVisibility||(t.HeadersVisibility={}));!function(e){e[e.Default=0]="Default";e[e.CSV=1]="CSV";e[e.QuoteAll=2]="QuoteAll";e[e.SkipMerged=4]="SkipMerged";e[e.Unformatted=8]="Unformatted";e[e.InvisibleRows=16]="InvisibleRows";e[e.InvisibleColumns=32]="InvisibleColumns";e[e.InvisibleCells=48]="InvisibleCells"}(r=t.ClipStringOptions||(t.ClipStringOptions={}));var l=function(l){__extends(FlexGrid,l);function FlexGrid(i,r){var s=l.call(this,i,null,!0)||this;s._szClient=new e.Size(0,0);s._ptScrl=new e.Point(0,0);s._cellPadLeft=3;s._cellPadHorz=3;s._cellPadVert=0;s._clipToScreen=!1;s._autoGenCols=!0;s._autoClipboard=!0;s._autoScroll=!0;s._autoSearch=!1;s._readOnly=!1;s._indent=14;s._autoSizeMode=t.AutoSizeMode.Both;s._autoHeights=!1;s._hdrVis=n.All;s._alSorting=o.SingleColumn;s._alPinning=!1;s._alAddNew=!1;s._alDelete=!1;s._alResizing=t.AllowResizing.Columns;s._alDragging=t.AllowDragging.Columns;s._alMerging=t.AllowMerging.None;s._ssHdr=n.None;s._shSort=!0;s._shGroups=!0;s._altStep=1;s._shErr=!0;s._shDropDown=!0;s._valEdt=!0;s._deferResizing=!1;s._pSel=!0;s._pOutline=!0;s._stickyHdr=!1;s._anchorCursor=!1;s._copyHeaders=n.None;s._vt=0;s._vtRows=0;s._vtCols=0;s._lazyRender=!0;s._refreshOnEdit=!0;s._reorderCells=!0;s.itemsSourceChanging=new e.Event;s.itemsSourceChanged=new e.Event;s.scrollPositionChanged=new e.Event;s.selectionChanging=new e.Event;s.selectionChanged=new e.Event;s.loadingRows=new e.Event;s.loadedRows=new e.Event;s.updatingLayout=new e.Event;s.updatedLayout=new e.Event;s.resizingColumn=new e.Event;s.resizedColumn=new e.Event;s.autoSizingColumn=new e.Event;s.autoSizedColumn=new e.Event;s.starSizedColumns=new e.Event;s.draggingColumn=new e.Event;s.draggingColumnOver=new e.Event;s.draggedColumn=new e.Event;s.resizingRow=new e.Event;s.resizedRow=new e.Event;s.autoSizingRow=new e.Event;s.autoSizedRow=new e.Event;s.draggingRow=new e.Event;s.draggingRowOver=new e.Event;s.draggedRow=new e.Event;s.groupCollapsedChanging=new e.Event;s.groupCollapsedChanged=new e.Event;s.columnGroupCollapsedChanging=new e.Event;s.columnGroupCollapsedChanged=new e.Event;s.sortingColumn=new e.Event;s.sortedColumn=new e.Event;s.beginningEdit=new e.Event;s.prepareCellForEdit=new e.Event;s.cellEditEnding=new e.Event;s.cellEditEnded=new e.Event;s.rowEditStarting=new e.Event;s.rowEditStarted=new e.Event;s.rowEditEnding=new e.Event;s.rowEditEnded=new e.Event;s.rowAdded=new e.Event;s.deletingRow=new e.Event;s.deletedRow=new e.Event;s.copying=new e.Event;s.copied=new e.Event;s.pasting=new e.Event;s.pasted=new e.Event;s.pastingCell=new e.Event;s.pastedCell=new e.Event;s.formatItem=new e.Event((function(){s.invalidate()}));s.updatingView=new e.Event;s.updatedView=new e.Event;s._mappedColumns=null;var a=s.hostElement;e.isIE()&&(a.style.borderRadius="0");var c=s.getTemplate();s.applyTemplate("wj-control wj-content wj-flexgrid",c,{_root:"root",_eSz:"sz",_eCt:"cells",_fCt:"fcells",_eTL:"tl",_eBL:"bl",_eCHdr:"ch",_eRHdr:"rh",_eCFtr:"cf",_eTLCt:"tlcells",_eBLCt:"blcells",_eCHdrCt:"chcells",_eCFtrCt:"cfcells",_eRHdrCt:"rhcells",_eMarquee:"marquee",_eFocus:"focus"});[s._eRHdr,s._eCFtr,s._eCHdr,s._eBL,s._eTL].forEach((function(t){e.setAttribute(t,"aria-hidden",!0);e.setCss(t,{position:"absolute",overflow:"hidden",outline:"none"});e.setCss(t.firstElementChild,{position:"relative"})}));[s._eFocus,s._eMarquee,s._fCt,s._eSz].forEach((function(t){e.setAttribute(t,"aria-hidden",!0)}));a.tabIndex=-1;s.deferUpdate((function(){var i=s._getDefaultRowHeight();s._rows=new t.RowCollection(s,i);s._cols=new t.ColumnCollection(s,4*i);s._hdrRows=new t.RowCollection(s,i);s._hdrCols=new t.ColumnCollection(s,Math.round(1.25*i));s._ftrRows=new t.RowCollection(s,i);var o=t.CellType;s._gpTL=new t.GridPanel(s,o.TopLeft,s._hdrRows,s._hdrCols,s._eTLCt);s._gpCHdr=new t.GridPanel(s,o.ColumnHeader,s._hdrRows,s._cols,s._eCHdrCt);s._gpRHdr=new t.GridPanel(s,o.RowHeader,s._rows,s._hdrCols,s._eRHdrCt);s._gpCells=new t.GridPanel(s,o.Cell,s._rows,s._cols,s._eCt);s._gpBL=new t.GridPanel(s,o.BottomLeft,s._ftrRows,s._hdrCols,s._eBLCt);s._gpCFtr=new t.GridPanel(s,o.ColumnFooter,s._ftrRows,s._cols,s._eCFtrCt);s._hdrRows.push(new t.Row);s._hdrCols.push(new t.Column({align:"center"}));s._cf=new t.CellFactory;s._keyHdl=new t._KeyboardHandler(s);s._mouseHdl=new t._MouseHandler(s);s._edtHdl=new t._EditHandler(s);s._selHdl=new t._SelectionHandler(s);s._addHdl=new t._AddNewHandler(s);s._grpHdl=new t._ColumnGroupHandler(s);s._mrgMgr=new t.MergeManager(s);s._bndSortConverter=s._sortConverter.bind(s);s._errorTip=new e.Tooltip({isContentHtml:!1,showDelay:0,cssClass:"wj-error-tip"});e.setAttribute(s.cells.hostElement,"role","grid");s.selectionMode=t.SelectionMode.CellRange;s._root.tabIndex=-1;s.initialize(r)}));s.addEventListener(s._root,"scroll",(function(e){if(s._updateScrollPosition()){s.finishEditing();s._updateContent(!0);s.frozenColumns&&setTimeout((function(){var e=s.columnHeaders.hostElement.style,t=parseInt(e.left),i=s._ptScrl.x;Math.abs(t-i)>1&&s.invalidate()}))}}));s.addEventListener(a,"focus",(function(e){if(a.tabIndex>-1){var t=e.target;if(t instanceof HTMLElement&&t.tabIndex<0){s._setFocus(!0);return}}}),!0);return s}FlexGrid.prototype._handleResize=function(){this._rcBounds=null;l.prototype._handleResize.call(this)};Object.defineProperty(FlexGrid.prototype,"headersVisibility",{get:function(){return this._hdrVis},set:function(t){if((t=e.asEnum(t,n))!=this._hdrVis){this._hdrVis=t;this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"stickyHeaders",{get:function(){return this._stickyHdr},set:function(t){if(t!=this._stickyHdr){this._stickyHdr=e.asBoolean(t);this._updateStickyHeaders();this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"preserveSelectedState",{get:function(){return this._pSel},set:function(t){this._pSel=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"preserveOutlineState",{get:function(){return this._pOutline},set:function(t){this._pOutline=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"anchorCursor",{get:function(){return this._anchorCursor},set:function(t){this._anchorCursor=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"copyHeaders",{get:function(){return this._copyHeaders},set:function(t){this._copyHeaders=e.asEnum(t,n)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"lazyRender",{get:function(){return this._lazyRender},set:function(t){this._lazyRender=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"refreshOnEdit",{get:function(){return this._refreshOnEdit},set:function(t){this._refreshOnEdit=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"virtualizationThreshold",{get:function(){return this._vt},set:function(t){this._vt=t;if(e.isNumber(t))this._vtRows=this._vtCols=e.asNumber(t);else if(t)if(e.isArray(t)&&2==t.length){this._vtRows=e.asNumber(t[0]);this._vtCols=e.asNumber(t[1])}else e.assert(!1,"virtualizationThreshold should be a number or an array with two numbers.");else this._vtRows=this._vtCols=0},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"autoGenerateColumns",{get:function(){return this._autoGenCols},set:function(t){this._autoGenCols=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"autoClipboard",{get:function(){return this._autoClipboard},set:function(t){this._autoClipboard=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"autoScroll",{get:function(){return this._autoScroll},set:function(t){this._autoScroll=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"autoSearch",{get:function(){return this._autoSearch},set:function(t){this._autoSearch=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"columnLayout",{get:function(){var i=FlexGrid._getSerializableProperties(t.Column),o=new t.Column,n=[];this.columns.forEach((function(t){var r={};i.forEach((function(i){var n=t[i];n!=o[i]&&e.isPrimitive(n)&&"size"!=i&&(r[i]=n)}));n.push(r)}));return JSON.stringify({columns:n})},set:function(t){var i=JSON.parse(e.asString(t));if(!i||null==i.columns)throw"Invalid columnLayout data.";this.columns.clear();this.initialize(i)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"columnGroups",{get:function(){return this._grpHdl.getGroupDefinitions()},set:function(t){this.columns.clear();this._grpHdl.createColumnGroups(e.asArray(t))},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(t){if(t!=this._readOnly){this._readOnly=e.asBoolean(t);this.finishEditing();this.invalidate(!0);this._addHdl.updateNewRowTemplate();e.toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly);this._setAria("readonly",this.isReadOnly?"true":null)}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"isDisabled",{get:function(){return this._e&&null!=this._e.getAttribute("disabled")},set:function(t){if((t=e.asBoolean(t,!0))!=this.isDisabled){var i=this._e;if(i){e.enable(i,!t);this.invalidate()}}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"imeEnabled",{get:function(){return null!=this._imeHdl},set:function(i){if(e.asBoolean(i)!=this.imeEnabled&&this.finishEditing()){var o=this.containsFocus();if(this._imeHdl){this._imeHdl.dispose();this._imeHdl=null}i&&(this._imeHdl=new t._ImeHandler(this));o&&this.focus()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"allowResizing",{get:function(){return this._alResizing},set:function(i){this._alResizing=e.asEnum(i,t.AllowResizing)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"deferResizing",{get:function(){return this._deferResizing},set:function(t){this._deferResizing=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"autoSizeMode",{get:function(){return this._autoSizeMode},set:function(i){this._autoSizeMode=e.asEnum(i,t.AutoSizeMode)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"autoRowHeights",{get:function(){return this._autoHeights},set:function(t){this._autoHeights=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"quickAutoSize",{get:function(){return this._quickSize},set:function(t){this._quickSize=e.asBoolean(t,!0)},enumerable:!0,configurable:!0});FlexGrid.prototype._getQuickAutoSize=function(){return e.isBoolean(this._quickSize)?this._quickSize:!this.formatItem.hasHandlers&&null==this.itemFormatter};Object.defineProperty(FlexGrid.prototype,"allowSorting",{get:function(){return this._alSorting},set:function(t){e.isBoolean(t)&&(t=t?o.SingleColumn:o.None);this._alSorting=e.asEnum(t,o)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"allowPinning",{get:function(){return this._alPinning},set:function(t){if(t!=this._alPinning){this._alPinning=e.asBoolean(t);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"allowAddNew",{get:function(){return this._alAddNew},set:function(t){if(t!=this._alAddNew){this._alAddNew=e.asBoolean(t);this._addHdl.updateNewRowTemplate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"newRowAtTop",{get:function(){return this._addHdl.newRowAtTop},set:function(t){this._addHdl.newRowAtTop=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"allowDelete",{get:function(){return this._alDelete},set:function(t){t!=this._alDelete&&(this._alDelete=e.asBoolean(t))},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"allowMerging",{get:function(){return this._alMerging},set:function(i){if((i=e.asEnum(i,t.AllowMerging))!=this._alMerging){this._alMerging=i;this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showSelectedHeaders",{get:function(){return this._ssHdr},set:function(t){if((t=e.asEnum(t,n))!=this._ssHdr){this._ssHdr=t;this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showMarquee",{get:function(){return!this._eMarquee.style.display},set:function(t){if(t!=this.showMarquee){var i=this._eMarquee.style;i.visibility="collapse";i.display=e.asBoolean(t)?"":"none";this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showSort",{get:function(){return this._shSort},set:function(t){if(t!=this._shSort){this._shSort=e.asBoolean(t);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showGroups",{get:function(){return this._shGroups},set:function(t){if(t!=this._shGroups){this._shGroups=e.asBoolean(t);this._bindGrid(!1)}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"alternatingRowStep",{get:function(){return this._altStep},set:function(t){if(t!=this._altStep){this._altStep=e.asInt(t,!1,!0);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showAlternatingRows",{get:function(){return this._altStep>0},set:function(t){e._deprecated("showAlternatingRows","alternatingRowStep");this.alternatingRowStep=t?1:0},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showErrors",{get:function(){return this._shErr},set:function(t){if(t!=this._shErr){this._clearCells();this._shErr=e.asBoolean(t)}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"errorTip",{get:function(){return this._errorTip},set:function(t){if(t!=this._errorTip){this._clearCells();this._errorTip=e.asType(t,e.Tooltip,!0)}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"itemValidator",{get:function(){return this._itemValidator},set:function(t){if(t!=this.itemValidator){this._itemValidator=e.asFunction(t);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"validateEdits",{get:function(){return this._valEdt},set:function(t){this._valEdt=e.asBoolean(t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"groupHeaderFormat",{get:function(){return this._gHdrFmt},set:function(t){if(t!=this._gHdrFmt){this._gHdrFmt=e.asString(t);this._bindGrid(!1)}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"allowDragging",{get:function(){return this._alDragging},set:function(i){if((i=e.asEnum(i,t.AllowDragging))!=this._alDragging){this._alDragging=i;this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"itemsSource",{get:function(){return this._items},set:function(i){if(i!=this._items){var o=new e.CancelEventArgs;if(this.onItemsSourceChanging(o)){if(this._cv){(n=e.tryCast(this._cv,e.collections.CollectionView))&&n.sortConverter==this._bndSortConverter&&(n.sortConverter=null);this._cv.currentChanged.removeHandler(this._cvCurrentChanged,this);this._cv.collectionChanged.removeHandler(this._cvCollectionChanged,this);this._cv=null}this._items=i;this._cv=this._getCollectionView(i);this._lastCount=0;if(this._cv){this._cv.currentChanged.addHandler(this._cvCurrentChanged,this);this._cv.collectionChanged.addHandler(this._cvCollectionChanged,this);var n;(n=e.tryCast(this._cv,e.collections.CollectionView))&&!n.sortConverter&&(n.sortConverter=this._bndSortConverter)}this._bindGrid(!0);var r=t.SelectionMode;if(this.selectionMode==r.ListBox){this.selectionMode=r.CellRange;this.selectionMode=r.ListBox}this.onItemsSourceChanged(o)}}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"editableCollectionView",{get:function(){return e.tryCast(this._cv,"IEditableCollectionView")},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"childItemsPath",{get:function(){return this._childItemsPath},set:function(t){if(t!=this._childItemsPath){e.assert(null==t||e.isArray(t)||e.isString(t),"childItemsPath should be an array or a string.");this._childItemsPath=t;this._bindGrid(!0)}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"rowHeaderPath",{get:function(){return this._rowHdrPath?this._rowHdrPath.path:null},set:function(t){if(t!=this.rowHeaderPath){t=e.asString(t);this._rowHdrPath=t?new e.Binding(t):null;this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"cells",{get:function(){return this._gpCells},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"columnHeaders",{get:function(){return this._gpCHdr},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"columnFooters",{get:function(){return this._gpCFtr},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"rowHeaders",{get:function(){return this._gpRHdr},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"topLeftCells",{get:function(){return this._gpTL},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"bottomLeftCells",{get:function(){return this._gpBL},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0});FlexGrid.prototype.getColumn=function(e){return this.columns.getColumn(e)};Object.defineProperty(FlexGrid.prototype,"frozenRows",{get:function(){return this.rows.frozen},set:function(e){this.rows.frozen=e},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"frozenColumns",{get:function(){return this.columns.frozen},set:function(e){this.columns.frozen=e},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"cloneFrozenCells",{get:function(){return this._fzClone},set:function(t){if(t!=this.cloneFrozenCells){e.setText(this._fCt,null);this._fzClone=e.asBoolean(t,!0);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"sortRowIndex",{get:function(){return this._sortRowIndex},set:function(t){if(t!=this._sortRowIndex){this._sortRowIndex=e.asNumber(t,!0);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"editColumnIndex",{get:function(){return this._editColIndex},set:function(t){if(t!=this._editColIndex){this._editColIndex=e.asNumber(t,!0);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"scrollPosition",{get:function(){return this._ptScrl.clone()},set:function(e){var t=this._root,i=-e.x;if(this.rightToLeft)switch(FlexGrid._getRtlMode()){case"rev":i=t.scrollWidth-t.clientWidth+e.x;break;case"neg":i=e.x;break;default:i=-e.x}t.scrollLeft=i;t.scrollTop=-e.y},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"clientSize",{get:function(){return this._szClient},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"controlRect",{get:function(){this._rcBounds||(this._rcBounds=e.getElementRect(this._root));return this._rcBounds},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"scrollSize",{get:function(){return new e.Size(this._gpCells.width,this._heightBrowser)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"viewRange",{get:function(){return this._gpCells.viewRange},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"cellFactory",{get:function(){return this._cf},set:function(i){if(i!=this._cf){this._clearCells();this._cf=e.asType(i,t.CellFactory,!1)}},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(t){if(t!=this._itemFormatter){this._clearCells();this._itemFormatter=e.asFunction(t)}},enumerable:!0,configurable:!0});FlexGrid.prototype.canEditCell=function(e,t){return this._edtHdl._allowEditing(e,t)};FlexGrid.prototype.getCellData=function(e,t,i){return this.cells.getCellData(e,t,i)};FlexGrid.prototype.getCellBoundingRect=function(e,t,i){return this.cells.getCellBoundingRect(e,t,i)};FlexGrid.prototype.setCellData=function(e,t,i,o,n){void 0===o&&(o=!0);void 0===n&&(n=!0);return this.cells.setCellData(e,t,i,o,n)};FlexGrid.prototype.hitTest=function(i,o){e.isNumber(i)&&e.isNumber(o)&&(i=new e.Point(i,o));e.isBoolean(o)&&o&&(this._rcBounds=null);return new t.HitTestInfo(this,i)};FlexGrid.prototype.getClipString=function(t,i,o,n){var l;l=null==i||e.isBoolean(i)?i?r.CSV:r.Default:i;e.assert(e.isNumber(l),"Unexpected value for ClipStringOptions parameter.");return this._edtHdl.getClipString(t,l,o,n)};FlexGrid.prototype.setClipString=function(e,t){this._edtHdl.setClipString(e,t)};FlexGrid.prototype.focus=function(){this._setFocus(!1)};FlexGrid.prototype.dispose=function(){this.finishEditing(!0);this.itemsSource=null;l.prototype.dispose.call(this)};FlexGrid.prototype.refresh=function(t){void 0===t&&(t=!0);l.prototype.refresh.call(this,t);this.finishEditing();if(t){this._updateColumnTypes();this.scrollPosition=this._ptScrl;var i=this._getDefaultRowHeight();this._rows._setDefaultSize(i);this._cols._setDefaultSize(4*i);this._hdrRows._setDefaultSize(i);this._hdrCols._setDefaultSize(Math.round(1.25*i));this._ftrRows._setDefaultSize(i);if(this._toInv){clearTimeout(this._toInv);this._toInv=null}}this.refreshCells(t);var o=this._e;o&&(this._szCtl=new e.Size(o.offsetWidth,o.offsetHeight))};FlexGrid.prototype.refreshCells=function(e,t,i){this.isUpdating||(e?this._updateLayout():this._updateContent(t,i))};FlexGrid.prototype.refreshRange=function(e){for(var i=e.topRow;i<=e.bottomRow;i++)for(var o=e.leftCol;o<=e.rightCol;o++){var n=this.cells.getCellElement(i,o);if(n){var r=n[t.GridPanel._INDEX_KEY];this.cellFactory.updateCell(this.cells,i,o,n,r.rng)}}};FlexGrid.prototype.autoSizeColumn=function(e,t,i){void 0===t&&(t=!1);void 0===i&&(i=4);this.autoSizeColumns(e,e,t,i)};FlexGrid.prototype.autoSizeColumns=function(i,o,n,r){var l=this;void 0===n&&(n=!1);void 0===r&&(r=4);var s=0,a=n?this.topLeftCells:this.columnHeaders,c=n?this.bottomLeftCells:this.columnFooters,u=n?this.rowHeaders:this.cells,d=this.viewRange;i=null==i?0:e.asInt(i);o=null==o?u.columns.length-1:e.asInt(o);d.row=Math.max(0,d.row-1e3);d.row2=Math.min(d.row2+1e3,this.rows.length-1);this.finishEditing()&&this.columns.deferUpdate((function(){e.setCss(l._eCt,{width:l._gpCells.width});for(var n=e.createElement('<div style="visibility: hidden" '+FlexGrid._WJS_MEASURE+'="true"/>',u.hostElement),h=l._getCanvasContext(),g=i;g<=o&&g>-1&&g<u.columns.length;g++){var f=u.columns[g];if(f.isVisible){s=0;if(l.autoSizeMode&t.AutoSizeMode.Headers){for(var p=0;p<a.rows.length;p++)a.rows[p].isVisible&&(s=Math.max(l._getDesiredWidth(a,p,g,n),s));for(p=0;p<c.rows.length;p++)c.rows[p].isVisible&&(s=Math.max(l._getDesiredWidth(c,p,g,n),s))}if(l.autoSizeMode&t.AutoSizeMode.Cells&&d.isValid)if(f._getQuickAutoSize()){p=l._getWidestRow(u,d,g,h);s=Math.max(l._getDesiredWidth(u,p,g,n),s)}else for(p=d.row;p<=d.row2&&p<u.rows.length;p++)u.rows[p].isVisible&&(s=Math.max(l._getDesiredWidth(u,p,g,n),s));s>0&&(f.width=s+r+2)}}l.cellFactory.disposeCell(n);e.removeChild(n)}))};FlexGrid.prototype.autoSizeRow=function(e,t,i){void 0===t&&(t=!1);void 0===i&&(i=0);this.autoSizeRows(e,e,t,i)};FlexGrid.prototype.autoSizeRows=function(i,o,n,r){var l=this;void 0===n&&(n=!1);void 0===r&&(r=0);var s=0,a=n?this.topLeftCells:this.rowHeaders,c=n?this.columnHeaders:this.cells;n=e.asBoolean(n);r=e.asNumber(r);i=null==i?0:e.asInt(i);o=null==o?c.rows.length-1:e.asInt(o);if(this.finishEditing()){e.setCss(this._eCt,{width:this._gpCells.width});var u=e.createElement('<div style="visibility: hidden" '+FlexGrid._WJS_MEASURE+'="true"/>',c.hostElement);this.rows.deferUpdate((function(){for(var e={},n=i;n<=o&&n>-1&&n<c.rows.length;n++){if(c.rows[n].isVisible){s=0;l.autoSizeMode&t.AutoSizeMode.Headers&&(s=l._getDesiredRowHeight(a,n,u,e));l.autoSizeMode&t.AutoSizeMode.Cells&&(s=Math.max(l._getDesiredRowHeight(c,n,u,e),s));s>0&&(c.rows[n].height=s+r)}}}));this.cellFactory.disposeCell(u);e.removeChild(u)}};Object.defineProperty(FlexGrid.prototype,"treeIndent",{get:function(){return this._indent},set:function(t){if(t!=this._indent){this._indent=e.asNumber(t,!1,!0);this.columns.onCollectionChanged()}},enumerable:!0,configurable:!0});FlexGrid.prototype.collapseGroupsToLevel=function(e){var i=this;this.finishEditing()&&this.deferUpdate((function(){var o=i.rows;o.deferUpdate((function(){for(var i=0;i<o.length;i++){var n=o[i];n instanceof t.GroupRow&&(n.isCollapsed=n.level>=e)}}))}))};Object.defineProperty(FlexGrid.prototype,"selectionMode",{get:function(){return this._selHdl.selectionMode},set:function(i){(i=e.asEnum(i,t.SelectionMode))!=this.selectionMode&&(this._selHdl.selectionMode=i)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"selection",{get:function(){return this._selHdl.selection.clone()},set:function(e){this._selHdl.selection=e},enumerable:!0,configurable:!0});FlexGrid.prototype.select=function(e,t){void 0===t&&(t=!0);return this._selHdl.select(e,t)};FlexGrid.prototype.selectAll=function(){var e=this.rows.length,i=this.columns.length;return!(!e||!i)&&this.select(new t.CellRange(0,0,e-1,i-1),!1)};FlexGrid.prototype.getSelectedState=function(e,t){return this.cells.getSelectedState(e,t,null)};Object.defineProperty(FlexGrid.prototype,"selectedRows",{get:function(){var e=[];if(this.selectionMode==t.SelectionMode.ListBox)for(var i=0;i<this.rows.length;i++)this.rows[i].isSelected&&e.push(this.rows[i]);else if(this.rows.length){var o=this.selection;for(i=o.topRow;i>-1&&i<=o.bottomRow;i++)e.push(this.rows[i])}return e},set:function(i){var o=this;e.assert(this.selectionMode==t.SelectionMode.ListBox,"This property can be set only in ListBox mode.");i=e.asArray(i);this.deferUpdate((function(){for(var e=0,t=!0;e<o.rows.length;e++){var n=o.rows[e],r=i&&i.indexOf(n)>-1;if(r&&t){t=!1;o.select(e,o.selection.col)}n.isSelected=r}}))},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"selectedItems",{get:function(){for(var e=this.selectedRows,t=0;t<e.length;t++)e[t]=e[t].dataItem;return e},set:function(i){var o=this;e.assert(this.selectionMode==t.SelectionMode.ListBox,"This property can be set only in ListBox mode.");i=e.asArray(i);this.deferUpdate((function(){for(var e=0,t=!0;e<o.rows.length;e++){var n=o.rows[e],r=i&&i.indexOf(n.dataItem)>-1;if(r&&t){t=!1;o.select(e,o.selection.col)}n.isSelected=r}}))},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"selectedRanges",{get:function(){var e=[this.selection];this._selHdl.extendedSelection.forEach((function(t){e.push(t)}));return e},enumerable:!0,configurable:!0});FlexGrid.prototype.scrollIntoView=function(t,i,o){(null==this._maxOffsetY||this._rows._dirty||this._cols._dirty)&&this._updateLayout();var n=this.scrollPosition,r=this._szClient.width,l=this._szClient.height-this._gpCFtr.rows.getTotalSize(),s=this.cells._getFrozenPos();if((t=e.asInt(t))>-1&&t<this._rows.length&&t>=this._rows.frozen){var a=this._rows[t],c=this.cells.height-l>l?Math.round(a.pos/(this.cells.height-l)*10)/10:0,u=Math.round(this._maxOffsetY*c),d=a.pos-u,h=d+a.renderSize;h>l-n.y&&(n.y=Math.max(-d,l-h));d-s.y<-n.y&&(n.y=-(d-s.y))}if((i=e.asInt(i))>-1&&i<this._cols.length&&i>=this._cols.frozen){var g=this._cols[i],f=g.pos+g.renderSize;f>-n.x+r&&(n.x=Math.max(-g.pos,r-f));g.pos-s.x<-n.x&&(n.x=-(g.pos-s.x))}if(!n.equals(this._ptScrl)){this.scrollPosition=n;if(o){this._updateScrollPosition();this.refresh()}return!0}return!1};FlexGrid.prototype.isRangeValid=function(e){return e.isValid&&e.bottomRow<this.rows.length&&e.rightCol<this.columns.length};FlexGrid.prototype.startEditing=function(e,t,i,o){void 0===e&&(e=!0);return this._edtHdl.startEditing(e,t,i,o)};FlexGrid.prototype.finishEditing=function(e){return this._edtHdl.finishEditing(e)};Object.defineProperty(FlexGrid.prototype,"activeEditor",{get:function(){return this._edtHdl.activeEditor},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"editRange",{get:function(){return this._edtHdl.editRange},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"mergeManager",{get:function(){return this._mrgMgr},set:function(i){if(i!=this._mrgMgr){this._mrgMgr=e.asType(i,t.MergeManager,!0);this.invalidate()}},enumerable:!0,configurable:!0});FlexGrid.prototype.getMergedRange=function(e,t,i,o){void 0===o&&(o=!0);return this._mrgMgr?this._mrgMgr.getMergedRange(e,t,i,o):null};Object.defineProperty(FlexGrid.prototype,"keyActionTab",{get:function(){return this._keyHdl._kaTab},set:function(i){this._keyHdl._kaTab=e.asEnum(i,t.KeyAction)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"keyActionEnter",{get:function(){return this._keyHdl._kaEnter},set:function(i){this._keyHdl._kaEnter=e.asEnum(i,t.KeyAction)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGrid.prototype,"showDropDown",{get:function(){return this._shDropDown},set:function(t){if(t!=this._shDropDown){this._shDropDown=e.asBoolean(t,!0);this.invalidate()}},enumerable:!0,configurable:!0});FlexGrid.prototype.toggleDropDownList=function(){if(!this._tglDropDown){this._tglDropDown=!0;this._edtHdl._toggleListBox(null);this._tglDropDown=!1}return null!=this._edtHdl._lbx};Object.defineProperty(FlexGrid,"defaultTypeWidth",{get:function(){return FlexGrid._defTypeWidth},enumerable:!0,configurable:!0});FlexGrid.prototype.onItemsSourceChanging=function(e){this.itemsSourceChanging.raise(this,e);return!e.cancel};FlexGrid.prototype.onItemsSourceChanged=function(e){this.itemsSourceChanged.raise(this,e)};FlexGrid.prototype.onScrollPositionChanged=function(e){this.scrollPositionChanged.raise(this,e)};FlexGrid.prototype.onSelectionChanging=function(e){this.selectionChanging.raise(this,e);return!e.cancel};FlexGrid.prototype.onSelectionChanged=function(e){this.selectionChanged.raise(this,e)};FlexGrid.prototype.onLoadingRows=function(e){this.loadingRows.raise(this,e);return!e.cancel};FlexGrid.prototype.onLoadedRows=function(e){this.loadedRows.raise(this,e);this._autoRowHeights()};FlexGrid.prototype.onUpdatingLayout=function(e){this.updatingLayout.raise(this,e);return!e.cancel};FlexGrid.prototype.onUpdatedLayout=function(e){this.updatedLayout.raise(this,e)};FlexGrid.prototype.onResizingColumn=function(e){this.resizingColumn.raise(this,e);return!e.cancel};FlexGrid.prototype.onResizedColumn=function(e){this.resizedColumn.raise(this,e);this._autoRowHeights()};FlexGrid.prototype.onAutoSizingColumn=function(e){this.autoSizingColumn.raise(this,e);return!e.cancel};FlexGrid.prototype.onAutoSizedColumn=function(e){this.autoSizedColumn.raise(this,e)};FlexGrid.prototype.onStarSizedColumns=function(e){this.starSizedColumns.raise(this,e);this._autoRowHeights()};FlexGrid.prototype.onDraggingColumn=function(e){this.draggingColumn.raise(this,e);return!e.cancel};FlexGrid.prototype.onDraggingColumnOver=function(e){this.draggingColumnOver.raise(this,e);return!e.cancel};FlexGrid.prototype.onDraggedColumn=function(e){this.draggedColumn.raise(this,e)};FlexGrid.prototype.onResizingRow=function(e){this.resizingRow.raise(this,e);return!e.cancel};FlexGrid.prototype.onResizedRow=function(e){this.resizedRow.raise(this,e)};FlexGrid.prototype.onAutoSizingRow=function(e){this.autoSizingRow.raise(this,e);return!e.cancel};FlexGrid.prototype.onAutoSizedRow=function(e){this.autoSizedRow.raise(this,e)};FlexGrid.prototype.onDraggingRow=function(e){this.draggingRow.raise(this,e);return!e.cancel};FlexGrid.prototype.onDraggingRowOver=function(e){this.draggingRowOver.raise(this,e);return!e.cancel};FlexGrid.prototype.onDraggedRow=function(e){this.draggedRow.raise(this,e)};FlexGrid.prototype.onGroupCollapsedChanging=function(e){this.groupCollapsedChanging.raise(this,e);return!e.cancel};FlexGrid.prototype.onGroupCollapsedChanged=function(e){this.groupCollapsedChanged.raise(this,e)};FlexGrid.prototype.onColumnGroupCollapsedChanging=function(e){this.columnGroupCollapsedChanging.raise(this,e);return!e.cancel};FlexGrid.prototype.onColumnGroupCollapsedChanged=function(e){this.columnGroupCollapsedChanged.raise(this,e)};FlexGrid.prototype.onSortingColumn=function(e){this.sortingColumn.raise(this,e);return!e.cancel};FlexGrid.prototype.onSortedColumn=function(e){this.sortedColumn.raise(this,e)};FlexGrid.prototype.onBeginningEdit=function(e){this.beginningEdit.raise(this,e);return!e.cancel};FlexGrid.prototype.onPrepareCellForEdit=function(e){this.prepareCellForEdit.raise(this,e)};FlexGrid.prototype.onCellEditEnding=function(e){this.cellEditEnding.raise(this,e);return!e.cancel&&!e.stayInEditMode};FlexGrid.prototype.onCellEditEnded=function(e){this.cellEditEnded.raise(this,e);this._autoRowHeights()};FlexGrid.prototype.onRowEditStarting=function(e){this.rowEditStarting.raise(this,e)};FlexGrid.prototype.onRowEditStarted=function(e){this.rowEditStarted.raise(this,e)};FlexGrid.prototype.onRowEditEnding=function(e){this.rowEditEnding.raise(this,e)};FlexGrid.prototype.onRowEditEnded=function(e){this.rowEditEnded.raise(this,e);this._autoRowHeights()};FlexGrid.prototype.onRowAdded=function(e){this.rowAdded.raise(this,e);return!e.cancel};FlexGrid.prototype.onDeletingRow=function(e){this.deletingRow.raise(this,e);return!e.cancel};FlexGrid.prototype.onDeletedRow=function(e){this.deletedRow.raise(this,e)};FlexGrid.prototype.onCopying=function(e){this.copying.raise(this,e);return!e.cancel};FlexGrid.prototype.onCopied=function(e){this.copied.raise(this,e)};FlexGrid.prototype.onPasting=function(e){this.pasting.raise(this,e);return!e.cancel};FlexGrid.prototype.onPasted=function(e){this.pasted.raise(this,e)};FlexGrid.prototype.onPastingCell=function(e){this.pastingCell.raise(this,e);return!e.cancel};FlexGrid.prototype.onPastedCell=function(e){this.pastedCell.raise(this,e)};FlexGrid.prototype.onFormatItem=function(e){this.formatItem.raise(this,e)};FlexGrid.prototype.onUpdatingView=function(e){this.updatingView.raise(this,e);return!e.cancel};FlexGrid.prototype.onUpdatedView=function(e){this.updatedView.raise(this,e)};FlexGrid.prototype._autoRowHeights=function(){var t=this;if(this._autoHeights){this._toAutoHeights&&clearTimeout(this._toAutoHeights);this._toAutoHeights=setTimeout((function(){t._toAutoHeights=null;t.editRange||t.autoSizeRows()}),e.Control._REFRESH_INTERVAL)}};FlexGrid.prototype._getShowErrors=function(){return this.showErrors&&this._hasValidation};FlexGrid.prototype._getHasValidation=function(){return this._hasValidation};FlexGrid.prototype._getError=function(t,i,o){if(e.isFunction(this.itemValidator)){if(t==this.cells)return this.itemValidator(i,o);if(t==this.rowHeaders)for(o=0;o<this.columns.length;o++){if(c=this.itemValidator(i,o))return c}}var n=this._cv,r=n?n.getError:null;if(e.isFunction(r)){var l=t.rows,s=this.columns,a=l[i].dataItem;if(a&&!(a instanceof e.collections.CollectionViewGroup))for(;i<l.length&&l[i].dataItem==a;i++){if(t==this.cells){return r(a,this._getBindingColumn(this.cells,i,s[o]).binding)}if(t==this.rowHeaders)for(o=0;o<s.length;o++){var c;if(c=r(a,this._getBindingColumn(this.cells,i,s[o]).binding))return c}}}return null};FlexGrid.prototype._setAria=function(t,i){e.setAttribute(this.cells.hostElement,"aria-"+t,i)};FlexGrid.prototype._setFocus=function(t){if(this.hostElement&&(t||!this.containsFocus())){var i=e.getActiveElement(),o=this.activeEditor,n=this._activeCell,r=this._eFocus;if(o){if(!e.contains(o,i)){o.focus();r.tabIndex=-1}}else if(n){if(!e.contains(n,i)&&i!=this._root){e.isIE()&&e.hasClass(n,"wj-group")&&(n=n.querySelector(".wj-elem-collapse")||n);n.tabIndex=this._orgTabIndex;this._setFocusNoScroll(n);r.tabIndex=-1}}else if(!e.contains(r,i)&&i!=this._root){r.tabIndex=this._orgTabIndex;this._setFocusNoScroll(r)}if(!this.containsFocus()){r.tabIndex=this._orgTabIndex;this._setFocusNoScroll(r)}}};FlexGrid.prototype._setFocusNoScroll=function(t){if(e.getActiveElement()!=t)if(e.supportsFocusOptions())t.focus({preventScroll:!0});else{var i=this.scrollPosition,o=t.style,n=o.position;o.position="fixed";t.focus();o.position=n;this.scrollPosition=i}};FlexGrid.prototype._getDefaultRowHeight=function(){var t=this.hostElement,i=this._eFocus,o=null;if(!i.offsetHeight){o=e.createElement('<div><div class="wj-cell">0</div></div>',document.body);t&&o.setAttribute("class",t.getAttribute("class"));i=o.children[0]}var n=i.offsetHeight;(isNaN(n)||n<=6)&&(n=28);e.removeChild(o);return n};FlexGrid.prototype._getCollectionView=function(t){return e.asCollectionView(t)};FlexGrid.prototype._getCanvasContext=function(){var e=document.createElement("canvas").getContext("2d"),t=getComputedStyle(this.hostElement);e.font=t.fontSize+" "+t.fontFamily.split(",")[0];return e};FlexGrid.prototype._getWidestRow=function(t,i,o,n){for(var r=0,l=0,s=t.columns[o].dataType==e.DataType.Boolean,a=i.row;a<=i.row2;a++)if(t.rows[a].isVisible){var c=t.getCellData(a,o,!0),u=n.measureText(c).width,d=this.getMergedRange(t,a,o,!1);d&&d.columnSpan>1&&(u/=d.columnSpan);if(u>l){l=u;r=a}if(s)break}return r};FlexGrid.prototype._getDesiredWidth=function(e,t,i,o){var n=this.getMergedRange(e,t,i,!1),r=o.style;this.cellFactory.updateCell(e,t,i,o,n);r.width=r.top=r.left="";return o.offsetWidth/(n&&n.columnSpan>1?n.columnSpan:1)};FlexGrid.prototype._getDesiredHeight=function(e,t,i,o){var n=o.style,r=this.getMergedRange(e,t,i,!1),l=r?r.rowSpan:1;this.cellFactory.updateCell(e,t,i,o,r);o.innerHTML.trim()||(o.innerHTML="&nbsp;");n.height=n.top=n.left="";return o.offsetHeight/l};FlexGrid.prototype._getDesiredRowHeight=function(t,i,o,n){for(var r=0,l=0;l<t.columns.length;l++){var s=t.columns[l];if(s.isVisible){var a=this.getMergedRange(t,i,l,!1),c=void 0;if(this._getQuickAutoSize()){var u={ct:t.cellType,col:l,rng:a&&a.rowSpan>1?a.rowSpan:1,content:s.dataType==e.DataType.Number?"1":t.getCellData(i,l,!0)},d=JSON.stringify(u);if(null==(c=n[d])){c=this._getDesiredHeight(t,i,l,o);n[d]=c}}else c=this._getDesiredHeight(t,i,l,o);r=Math.max(c,r)}}return r};FlexGrid.prototype._getSortRowIndex=function(){return null!=this._sortRowIndex?this._sortRowIndex:this.columnHeaders.rows.length-1};FlexGrid.prototype._getEditColumnIndex=function(){return null!=this._editColIndex?this._editColIndex:this.rowHeaders.columns.length-1};FlexGrid.prototype._sortConverter=function(e,t,i,o){var n,r=this;if(o){this._mappedColumns=null;this._cv&&this._cv.sortDescriptions.forEach((function(e){if((n=r.getColumn(e.property))&&n.dataMap){r._mappedColumns||(r._mappedColumns={});r._mappedColumns[n.binding]=n.dataMap}}));if(this._mouseHdl._htDown&&this._mouseHdl._htDown.col>-1){n=this.columns[this._mouseHdl._htDown.col];this._mappedColumns&&n.dataMap&&(this._mappedColumns[n.binding]=n.dataMap)}}if(this._mappedColumns){var l=this._mappedColumns[e.property];l&&l.sortByDisplayValues&&(i=l.getDisplayValue(i))}return i};FlexGrid.prototype._bindGrid=function(i){var o=this;this.finishEditing();this.deferUpdate((function(){o.autoGenerateColumns&&0==o._lastCount&&e.hasItems(o._cv)&&(i=!0);var n,r,l=o.selectionMode==t.SelectionMode.ListBox;o.preserveSelectedState&&l&&(n=o.selectedItems);if(o.preserveOutlineState&&e.isFunction(window.Map)&&o.rows.maxGroupLevel>-1){r=new Map;for(var s=0;s<o.rows.length;s++){var a=o.rows[s];if(a instanceof t.GroupRow&&a.isCollapsed&&a.dataItem){var c=a.dataItem;c instanceof e.collections.CollectionViewGroup&&(c=c._path);r.set(c,!0)}}}i&&o.columns.deferUpdate((function(){o._bindColumns()}));var u=new e.CancelEventArgs;if(o.onLoadingRows(u)){o.rows.deferUpdate((function(){o._bindRows()}));o.onLoadedRows(u)}o._selHdl.extendedSelection.clear();var d=0;if(n&&n.length)for(s=0;s<o.rows.length&&d<n.length;s++)if(n.indexOf(o.rows[s].dataItem)>-1){o.rows[s].isSelected=!0;d++}if(l&&0==d&&o._lastCount>0){var h=o.selection;for(s=h.topRow;s<=h.bottomRow&&s>-1&&s<o.rows.length;s++)o.rows[s].isSelected=!0}r&&o.rows.deferUpdate((function(){for(var i=0;i<o.rows.length;i++){var n=o.rows[i];if(n instanceof t.GroupRow){var l=n.dataItem;l instanceof e.collections.CollectionViewGroup&&(l=l._path);r.get(l)&&(n.isCollapsed=!0)}}}));!o._lastCount&&o._cv&&o._cv.items&&(o._lastCount=o._cv.items.length)}));if(!this.rows.length){var n=this._selHdl.selection;n.row=n.row2=-1}if(this._cv){var r=i&&!this._toInv;this._syncSelection(r)}};FlexGrid.prototype._cvCollectionChanged=function(i,o){if(this.autoGenerateColumns&&0==this.columns.length)this._bindGrid(!0);else{var n=e.collections.NotifyCollectionChangedAction;if(this.childItemsPath&&o.action!=n.Change)this._bindGrid(!1);else{switch(o.action){case n.Change:this.invalidate();return;case n.Add:if(o.index==this._cv.items.length-1){var r=this.rows.length;this.rows[r-1]instanceof t._NewRowTemplate&&r--;this.rows.insert(r,new t.Row(o.item));return}e.assert(!1,"added item should be the last one.");break;case n.Remove:var l=this._findRow(o.item);if(l>-1){this.rows.removeAt(l);this._syncSelection();return}e.assert(!1,"removed item not found on grid.")}this._bindGrid(!1)}}};FlexGrid.prototype._cvCurrentChanged=function(e,t){this._syncSelection()};FlexGrid.prototype._syncSelection=function(i){if(this._cv&&this.selectionMode!=t.SelectionMode.None){var o=this._selHdl.selection,n=o.row>-1&&o.row<this.rows.length?this.rows[o.row]:null,r=n?n.dataItem:null,l=this._cv;if(l instanceof e.collections.CollectionView&&l.isUpdating)return;if(this.newRowAtTop&&n instanceof t._NewRowTemplate)return;r instanceof e.collections.CollectionViewGroup&&(r=null);if(r!=l.currentItem||i){var s=this.editableCollectionView;if(!this.childItemsPath||!s||!s.currentAddItem){var a=this._getRowIndex(l.currentPosition);if(a!=o.row||!this.childItemsPath){o=new t.CellRange(a,o.col,a,o.col2);this.select(o,!1);this.selectionMode&&this.scrollIntoView(o.row,-1)}}}}};FlexGrid.prototype._getRowIndex=function(e){if(this._cv){if(e>-1){for(var i=this._cv.items[e];e<this.rows.length;e++)if(this.rows[e].dataItem===i)return e;return-1}if(1==this.rows.length&&this.rows[0]instanceof t._NewRowTemplate)return 0;var o=this.selection.row,n=o>-1?this.rows[o]:null;return n&&(n instanceof t.GroupRow||null==n.dataItem)?o:-1}return this.selection.row};FlexGrid.prototype._getCvIndex=function(e){if(this._cv&&e>-1&&e<this.rows.length){var t=this._cv.items,i=this.rows[e].dataItem;e=Math.min(e,t.length-1);for(;e>-1;e--)if(t[e]===i)return e}return-1};FlexGrid.prototype._findRow=function(e){for(var t=0;t<this.rows.length;t++)if(this.rows[t].dataItem==e)return t;return-1};FlexGrid.prototype._updateLayout=function(){var t=new e.CancelEventArgs;if(this.onUpdatingLayout(t)){var i=this._hdrVis&n.Row?this._hdrCols.getTotalSize():0,o=this._hdrVis&n.Column?this._hdrRows.getTotalSize():0,r=this._ftrRows.getTotalSize(),l=this._rows.getTotalSize()+r;l<1&&(l=1);this._heightBrowser=Math.min(l,FlexGrid._getMaxSupportedCssHeight());this._maxOffsetY=Math.max(0,l-this._heightBrowser);var s=getComputedStyle(this._eFocus);this._cellPadVert=parseInt(s.paddingTop)+parseInt(s.paddingBottom);this._cellPadHorz=parseInt(s.paddingLeft)+parseInt(s.paddingRight);this._cellPadLeft=parseInt(this.rightToLeft?s.paddingRight:s.paddingLeft);var a=this._heightBrowser+o-r,c=this._gpCells.width,u=this._heightBrowser;!c&&this.rows.length&&(c=.1);!u&&this.columns.length&&(u=.1);if(this.rightToLeft){e.setCss(this._eTL,{right:0,top:0,width:i,height:o});e.setCss(this._eCHdr,{right:i,top:0,height:o});e.setCss(this._eRHdr,{right:0,top:o,width:i});e.setCss(this._eCt,{right:i,top:o,width:c,height:u});e.setCss(this._fCt,{right:i,top:o});e.setCss(this._eBL,{right:0,top:a,width:i,height:r});e.setCss(this._eCFtr,{right:i,top:a,height:r})}else{e.setCss(this._eTL,{left:0,top:0,width:i,height:o});e.setCss(this._eCHdr,{left:i,top:0,height:o});e.setCss(this._eRHdr,{left:0,top:o,width:i});e.setCss(this._eCt,{left:i,top:o,width:c,height:u});e.setCss(this._fCt,{left:i,top:o});e.setCss(this._eBL,{left:0,top:a,width:i,height:r});e.setCss(this._eCFtr,{left:i,top:a,height:r})}this._stickyHdr&&this._updateStickyHeaders();var d=this.frozenRows||this.frozenColumns?"3":"";e.setCss([this._eTL,this._eBL,this._eCHdr,this._eCFtr,this._eRHdr,this._eMarquee],{zIndex:d});var h=this._root,g=h.offsetWidth-h.clientWidth,f=h.offsetHeight-h.clientHeight;e.setCss(this._eSz,{width:i+g+this._gpCells.width,height:o+f+this._heightBrowser});var p=null;if(this.columns._updateStarSizes(h.clientWidth-i)){p=h.clientWidth;e.setCss(this._eCt,{width:this._gpCells.width});this.onStarSizedColumns()}this._szClient=new e.Size(h.clientWidth-i,h.clientHeight-o);this._rcBounds=null;this._updateScrollHandler();this._updateContent(!1);g=h.offsetWidth-h.clientWidth;f=h.offsetHeight-h.clientHeight;e.setCss(this._eSz,{width:i+g+this._gpCells.width,height:o+f+this._heightBrowser});this._szClient=new e.Size(h.clientWidth-i,h.clientHeight-o);if(p&&p!=h.clientWidth&&this.columns._updateStarSizes(h.clientWidth-i)){e.setCss(this._eCt,{width:this._gpCells.width});this._updateContent(!1)}e.setCss([this._eCHdr,this._eCFtr,this._fCt],{width:this._szClient.width});e.setCss([this._eRHdr,this._fCt],{height:this._szClient.height});if(r){a=Math.min(a,this._szClient.height+o-r);e.setCss([this._eBL,this._eCFtr],{top:a})}this.onUpdatedLayout(t)}};FlexGrid.prototype._updateStickyHeaders=function(){var t=!1,i=0;if(this._stickyHdr){for(var o=0,n=null,r=this.hostElement;r;r=r.parentElement)if("inline"!=getComputedStyle(r).display){var l=r.getBoundingClientRect();null==n&&(n=l.top);o=Math.max(o,l.top)}i=-(n=Math.max(0,o-n-1));t=n>0;this._rcBounds=null}this._eTL.style.top=this._eCHdr.style.top=t?-i+"px":"";e.toggleClass(this._eTL,FlexGrid._WJS_STICKY,t);e.toggleClass(this._eCHdr,FlexGrid._WJS_STICKY,t)};FlexGrid.prototype._updateScrollHandler=function(){this._clipToScreen=this._getClipToScreen();var e=this._stickyHdr||this._clipToScreen;if(e!=this._scrollHandlerAttached){this._scrollHandlerAttached=e;e?this.addEventListener(window,"scroll",this._scroll.bind(this),!0):this.removeEventListener(window,"scroll")}};FlexGrid.prototype._getClipToScreen=function(){if(this.rows.length<=FlexGrid._MIN_VIRT_ROWS)return!1;if(this._root.clientHeight!=this._root.scrollHeight)return!1;for(var e=this.hostElement;e&&e!=document.documentElement;e=e.parentElement){if("auto"==getComputedStyle(e).overflow)return!1}return!0};FlexGrid.prototype._scroll=function(t){var i=this;if(e.contains(t.target,this.hostElement)){if(this._clipToScreen){this._afClip&&cancelAnimationFrame(this._afClip);this._afClip=requestAnimationFrame((function(){i._afClip=null;i.finishEditing();i._updateContent(!0)}))}if(this._stickyHdr){this._afSticky&&cancelAnimationFrame(this._afSticky);this._afSticky=requestAnimationFrame((function(){i._afSticky=null;var t=new e.CancelEventArgs;if(i.onUpdatingLayout(t)){i._updateStickyHeaders();i.onUpdatedLayout(t)}}))}}};FlexGrid.prototype._updateScrollPosition=function(){var t=this._root,i=t.scrollTop,o=t.scrollLeft;this.rightToLeft&&"rev"==FlexGrid._getRtlMode()&&(o=t.scrollWidth-t.clientWidth-o);var n=new e.Point(-Math.abs(o),-i);if(!this._ptScrl.equals(n)){this._ptScrl=n;this.onScrollPositionChanged();return!0}return!1};FlexGrid.prototype._updateContent=function(t,i){var o=this,r=this._root,l=this.hostElement,s=this.cells.hostElement,a=this._activeCell,c=e.getActiveElement(),u=e.contains(l,c),d=e.closest(c,".wj-flexgrid")==l?c:null,h=new e.CancelEventArgs;if(this.onUpdatingView(h)){e.setAttribute(s,"role",this.rows.maxGroupLevel<0?"grid":"treegrid");this._hasValidation=e.isFunction(this._itemValidator)||this._cv&&e.isFunction(this._cv.getError);var g=!i&&this._errorTip&&this._errorTip._tips.length,f=this._heightBrowser,p=this._szClient.height,_=p>f?Math.round(-this._ptScrl.y/(f-p)*10)/10:0;this._offsetY=Math.round(this._maxOffsetY*_);this._updateScrollPosition();var w=this._gpCells._updateContent(t,i,this._offsetY),m=this._hdrVis;if(m&n.Column&&(!i||this._ssHdr&m)){this._gpCHdr._updateContent(t,i,0);this._eCHdr.scrollLeft=0}if(m&n.Row&&(!i||this._ssHdr&m)){this._gpRHdr._updateContent(t,i,this._offsetY);this._eRHdr.scrollTop=0}m&&!i&&this._gpTL._updateContent(t,i,0);if(this._gpCFtr.rows.length){this._gpBL._updateContent(t,i,0);this._gpCFtr._updateContent(t,i,0)}if(this.showMarquee){var C=this._selHdl.selection,y=this._eMarquee;if(this.isRangeValid(C)){var v=this._getMarqueeRect(C),b=y.firstChild,R=y.offsetWidth-b.offsetWidth,x=y.offsetHeight-b.offsetHeight;e.setCss(y,{left:v.left+s.offsetLeft-R/2,top:v.top+s.offsetTop-x/2,width:v.width+R,height:v.height+x,visibility:v.width>0&&v.height>0?"":"collapse"})}else e.setCss(y,{visibility:"collapse",left:0,top:0,width:0,height:0})}if(g&&this._errorTip&&this._errorTip._tips.length){this._toErrorTips&&clearTimeout(this._toErrorTips);this._toErrorTips=setTimeout((function(){o._errorTip.hide();for(var t=o._errorTip._tips,i=0;i<t.length;i++){var n=t[i].element;if(!n.offsetHeight||!e.hasClass(n,"wj-state-invalid")){o._errorTip.setTooltip(n,null);i--}}}),250)}if(this._useFrozenDiv()){this._updateFrozenCells(i);w&&e.hasClass(w,"wj-frozen")&&(w=null)}this._fCt.style.display=this._fCt.childElementCount?"":"none";this._activeCell=w;if(d)if(d!=r&&d!=this._eFocus&&e.contains(l,d)&&!e.contains(s,d)){e.getActiveElement()!==d&&d.focus();if(e.isIE()&&d instanceof HTMLInputElement&&!d.type.match(/checkbox|radio|range/i)){var S=d.selectionStart,E=d.selectionEnd;d.setSelectionRange(S,E)}}else{var H=w!==a;this._setFocus(H)}!d&&w&&(w.tabIndex=this.isDisabled?-1:this._orgTabIndex);a&&a!=w&&(a.tabIndex=-1);u&&this.focus();this._rcBounds=null;this.onUpdatedView(h)}};FlexGrid.prototype._clearCells=function(){for(var e in this)if("_"==e[0]){var i=this[e];i instanceof t.GridPanel&&i._clearCells()}this.invalidate()};FlexGrid.prototype._useFrozenDiv=function(){return e.isBoolean(this._fzClone)?this._fzClone:e.isIE()||e.isFirefox()||e.isSafari()||e.isMobile()};FlexGrid.prototype._updateFrozenCells=function(t){var i=this._fCt;if(this.frozenRows||this.frozenColumns){var o=this._eCt.querySelectorAll(".wj-frozen");if(t&&i.children.length==o.length){for(var n=0;n<o.length;n++)i.children[n].className=o[n].className;return}e.setText(i,null);if(!this.activeEditor){var r=this._errorTip,l=navigator.userAgent.indexOf("MSIE")>=0;for(n=0;n<o.length;n++){var s=o[n];if(e.closest(s,".wj-flexgrid")==this.hostElement){if(l){var a="input[type=checkbox]",c=s.querySelector(a);s=s.cloneNode(!0);if(c){s.querySelector(a).checked=c.checked}}else s=s.cloneNode(!0);i.appendChild(s);if(r){var u=r.getTooltip(o[n]);u&&r.setTooltip(s,u)}}}}}else e.setText(i,null)};FlexGrid.prototype._getMarqueeRect=function(i){var o=this.getMergedRange(this.cells,i.topRow,i.leftCol)||new t.CellRange(i.topRow,i.leftCol),n=this.getMergedRange(this.cells,i.bottomRow,i.rightCol)||new t.CellRange(i.bottomRow,i.rightCol),r=this.cells.getCellBoundingRect(o.topRow,o.leftCol,!0),l=this.cells.getCellBoundingRect(n.bottomRow,n.rightCol,!0);if(this.rows.frozen){var s=Math.min(this.rows.length,this.rows.frozen),a=this.cells.getCellBoundingRect(s-1,0,!0);i.topRow>=s&&r.top<a.bottom&&(r.top=a.bottom);i.bottomRow>=s&&l.bottom<a.bottom&&(l.height=a.bottom-l.top)}if(this.columns.frozen){var c=Math.min(this.columns.length,this.columns.frozen);a=this.cells.getCellBoundingRect(0,c-1,!0);if(this.rightToLeft){o.leftCol>=c&&r.right>a.left&&(r.left=a.left-r.width);o.rightCol>=c&&l.left>a.left&&(l.left=a.left)}else{o.leftCol>=c&&r.left<a.right&&(r.left=a.right);o.rightCol>=c&&l.right<a.right&&(l.width=a.right-l.left)}}return this.rightToLeft?new e.Rect(l.left,r.top,r.right-l.left,l.bottom-r.top):new e.Rect(r.left,r.top,l.right-r.left,l.bottom-r.top)};FlexGrid.prototype._bindColumns=function(){for(var i=this,o=this.columns,n=0;n<o.length;n++){if(o[n]._getFlag(t.RowColFlags.AutoGenerated)){o.removeAt(n);n--}}var r=this._cv,l=r?r.sourceCollection:null;l&&l.length&&this.autoGenerateColumns&&this._getColumnTypes(l).forEach((function(n){var r=new t.Column(n);r._setFlag(t.RowColFlags.AutoGenerated,!0);r.name=n.binding;r.header=e.toHeaderCase(n.binding);var l=FlexGrid._defTypeWidth[r.dataType];if(null!=l){if(e.isString(l)){var s=Math.round(parseFloat(l));l=l.indexOf("*")<0?s:s*i.columns.defaultSize}e.isNumber(l)&&l>0&&(r.width=l)}o.push(r)}));this._updateColumnTypes()};FlexGrid.prototype._getColumnTypes=function(t){return e.getTypes(t)};FlexGrid.prototype._updateColumnTypes=function(){var t=this._cv;if(e.hasItems(t)){var i=t.items[0];this.columns.forEach((function(t){null==t.dataType&&t._binding&&(t.dataType=e.getType(t._binding.getValue(i)))}))}};FlexGrid.prototype._getBindingColumn=function(e,t,i){return i};FlexGrid.prototype._getBindingColumns=function(){return this.columns};FlexGrid.prototype._getRowHeaderPath=function(){return this._rowHdrPath};FlexGrid.prototype._bindRows=function(){this.rows.clear();var e=this._cv;if(e&&e.items){var t=e.items,i=e.groups;if(this.childItemsPath)for(var o=0;o<t.length;o++)this._addNode(t,o,0);else if(null!=i&&i.length>0&&this.showGroups)for(o=0;o<i.length;o++)this._addGroup(i[o]);else for(o=0;o<t.length;o++)this._addBoundRow(t,o)}};FlexGrid.prototype._addBoundRow=function(e,i){var o=new t.Row(e[i]),n=this.rows;o._list=n;n[n.length++]=o};FlexGrid.prototype._addGroupRow=function(e){this.rows.push(new t.GroupRow(e))};FlexGrid.prototype._addNode=function(i,o,n){var r=i[o],l=this.childItemsPath,s=r[e.isArray(l)?l[n]:l],a=new t.GroupRow(r);a.level=n;this.rows.push(a);if(e.isArray(s))for(var c=0;c<s.length;c++)this._addNode(s,c,n+1)};FlexGrid.prototype._addGroup=function(e){this._addGroupRow(e);if(e.isBottomLevel)for(var t=e.items,i=0;i<t.length;i++)this._addBoundRow(t,i);else for(i=0;i<e.groups.length;i++)this._addGroup(e.groups[i])};FlexGrid._getSerializableProperties=function(e){var t=[];for(e=e.prototype;e!=Object.prototype;e=Object.getPrototypeOf(e))for(var i=Object.getOwnPropertyNames(e),o=0;o<i.length;o++){var n=i[o],r=Object.getOwnPropertyDescriptor(e,n);r&&r.set&&r.get&&"_"!=n[0]&&!n.match(/disabled|required/)&&t.push(n)}return t};FlexGrid.prototype._hasColumnGroups=function(){return this._grpHdl.hasColumnGroups()};FlexGrid.prototype._getColumnGroup=function(e,t){return this._grpHdl.getColumnGroup(e,t)};FlexGrid.prototype._copy=function(i,o){var n=this;if("columns"==i){var r=e.asArray(o);if(r.some((function(e){return null!=e.columns})))this.columnGroups=r;else{this.columns.clear();r.forEach((function(e){var i=new t.Column(e);n.columns.push(i)}))}return!0}return!1};FlexGrid.prototype._isInputElement=function(t){if(t instanceof HTMLElement&&!e.hasClass(t,"wj-btn-glyph")){if("true"==t.contentEditable)return!0;var i=t.tagName.match(/^(BUTTON|A|INPUT|TEXTAREA|SELECT|OPTION)$/i);return i&&i.length>0}return!1};FlexGrid.prototype._wantsInput=function(t){return this._isInputElement(t)&&!this.activeEditor&&!this._edtHdl._isNativeCheckbox(t)&&!e.hasClass(t,"wj-grid-ime")&&e.contains(document.body,t)};FlexGrid._getMaxSupportedCssHeight=function(){if(!FlexGrid._maxCssHeight){var t=265e5;e.isIE()?t=15e5:e.isFirefox()&&(t=175e5);FlexGrid._maxCssHeight=t}return FlexGrid._maxCssHeight};FlexGrid._getRtlMode=function(){if(!FlexGrid._rtlMode){var t=e.createElement('<div dir="rtl" style="visibility:hidden;width:100px;height:100px;overflow:auto"><div style="width:2000px;height:2000px"></div></div>');document.body.appendChild(t);var i=t.scrollLeft;t.scrollLeft=-1e3;var o=t.scrollLeft;e.removeChild(t);FlexGrid._rtlMode=o<0?"neg":i>0?"rev":"std"}return FlexGrid._rtlMode};FlexGrid._WJS_STICKY="wj-state-sticky";FlexGrid._WJS_MEASURE="wj-state-measuring";FlexGrid._WJS_UPDATING="wj-state-updating";FlexGrid._MIN_VIRT_ROWS=200;FlexGrid._defTypeWidth=((i={})[e.DataType.Number]="0.714285714*",i);FlexGrid.controlTemplate='<div style="position:relative;width:100%;height:100%;overflow:hidden;max-width:inherit;max-height:inherit"><div wj-part="root" style="position:absolute;left:0;top:0;width:100%;height:100%;overflow:auto;max-width:inherit;max-height:inherit;-webkit-overflow-scrolling:touch;"><div wj-part="cells" class="wj-cells" style="position:absolute"></div><div wj-part="marquee" class="wj-marquee" style="display:none"><div style="width:100%;height:100%"></div></div></div><div wj-part="fcells" aria-hidden="true" class="wj-cells wj-frozen-clone" style="position:absolute;left:0;top:0;overflow:hidden;pointer-events:none"></div><div wj-part="rh"><div wj-part="rhcells" class="wj-rowheaders"></div></div><div wj-part="cf"><div wj-part="cfcells" class="wj-colfooters"></div></div><div wj-part="ch"><div wj-part="chcells" class="wj-colheaders"></div></div><div wj-part="bl"><div wj-part="blcells" class="wj-bottomleft"></div></div><div wj-part="tl"><div wj-part="tlcells" class="wj-topleft"></div></div><div wj-part="focus" class="wj-cell" style="position:fixed;left:-32000px">0</div><div wj-part="sz" style="position:relative;visibility:hidden"></div></div>';return FlexGrid}(e.Control);t.FlexGrid=l}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i;!function(e){e[e.None=0]="None";e[e.MoveDown=1]="MoveDown";e[e.MoveAcross=2]="MoveAcross";e[e.Cycle=3]="Cycle";e[e.CycleOut=4]="CycleOut"}(i=t.KeyAction||(t.KeyAction={}));var o=function(){function _KeyboardHandler(e){this._kaTab=i.None;this._kaEnter=i.MoveDown;this._g=e;var t=e.hostElement;e.addEventListener(t,"keypress",this._keypress.bind(this));e.addEventListener(t,"keydown",this._keydown.bind(this))}_KeyboardHandler.prototype._keydown=function(i){var o=this._g,n=o._edtHdl,r=o.selection,l=i.ctrlKey||i.metaKey,s=i.shiftKey,a=i.target,c=!0;this._altDown=!1;if(!o._wantsInput(a)){var u=i.defaultPrevented&&!(a instanceof HTMLInputElement);if(o.isRangeValid(r)&&!u&&(!o.activeEditor||!n._keydown(i))){var d=e.tryCast(o.rows[r.row],t.GroupRow),h=o.editableCollectionView,g=o._getKeyCode(i);if(o.autoClipboard){if(l&&(67==g||45==g)){var f=new t.CellRangeEventArgs(o.cells,r);if(o.onCopying(f)){var p=t.HeadersVisibility,_=0!=(o.copyHeaders&p.Column),w=0!=(o.copyHeaders&p.Row),m=o.getClipString(null,!1,_,w)+"\r\n";e.Clipboard.copy(m);o.onCopied(f)}i.stopPropagation();return}if(l&&86==g||s&&45==g){o.isReadOnly||e.Clipboard.paste((function(e){o.setClipString(e)}));i.stopPropagation();return}}(s||l)&&"Space"==i.code&&(g=e.Key.Space);var C=t.SelMove,y=t.SelectionMode;switch(g){case e.Key.Space:if(s&&r.isValid)switch(o.selectionMode){case y.CellRange:case y.MultiRange:case y.Row:case y.RowRange:case y.ListBox:o.select(new t.CellRange(r.row,0,r.row,o.columns.length-1),!1)}else if(l&&r.isValid)switch(o.selectionMode){case y.CellRange:case y.MultiRange:o.select(new t.CellRange(0,r.col,o.rows.length-1,r.col),!1)}else(c=this._startEditing(!0,i))&&setTimeout((function(){var e=o.activeEditor;if(e)if(e.disabled||e.readOnly)o.finishEditing();else if("checkbox"==e.type){e.checked=!e.checked;o.finishEditing()}}));break;case 65:if(l)switch(o.selectionMode){case y.None:case y.Cell:break;default:o.selectAll()}else c=!1;break;case e.Key.Left:l||i.altKey?c=!1:r.isValid&&0==r.leftCol&&null!=d&&!d.isCollapsed&&d.hasChildren?d.isCollapsed=!0:this._moveSel(C.None,l?C.Home:C.Prev,s);break;case e.Key.Right:l||i.altKey?c=!1:r.isValid&&0==r.leftCol&&null!=d&&d.isCollapsed?d.isCollapsed=!1:this._moveSel(C.None,l?C.End:C.Next,s);break;case e.Key.Up:if(l)c=!1;else{this._altDown=i.altKey;i.altKey?c=n._toggleListBox(i):this._moveSel(C.Prev,C.None,s)}break;case e.Key.Down:if(l)c=!1;else{this._altDown=i.altKey;i.altKey?c=n._toggleListBox(i):this._moveSel(C.Next,C.None,s)}break;case e.Key.PageUp:this._altDown=i.altKey;this._moveSel(i.altKey?C.Home:C.PrevPage,C.None,s);if(o.rows.frozen&&o.selection.row<o.rows.frozen){var v=o.scrollPosition;v.y&&(o.scrollPosition=new e.Point(v.x,0))}break;case e.Key.PageDown:this._altDown=i.altKey;this._moveSel(i.altKey?C.End:C.NextPage,C.None,s);break;case e.Key.Home:this._moveSel(l?C.Home:C.None,C.Home,s);break;case e.Key.End:this._moveSel(l?C.End:C.None,C.End,s);break;case e.Key.Tab:c=this._performKeyAction(o.keyActionTab,s);break;case e.Key.Enter:c=this._performKeyAction(o.keyActionEnter,s);!s&&h&&null!=h.currentEditItem&&n._commitRowEdits();break;case e.Key.Escape:c=!1;if(h&&(h.currentAddItem||h.currentEditItem)){var b=new t.CellRangeEventArgs(o.cells,o.selection);b.cancel=!0;o.onRowEditEnding(b);h.currentAddItem&&h.cancelNew();h.currentEditItem&&h.cancelEdit();o.onRowEditEnded(b);c=!0}o._mouseHdl.resetMouseState();break;case e.Key.Delete:case e.Key.Back:c=this._deleteSel(i);break;case e.Key.F2:c=this._startEditing(!0,i);break;case e.Key.F4:c=n._toggleListBox(i);break;default:c=!1}if(c){o.containsFocus()||o.focus();i.preventDefault();i.stopPropagation()}}}};_KeyboardHandler.prototype._performKeyAction=function(e,o){var n=i,r=t.SelMove;switch(e){case n.MoveDown:this._moveSel(o?r.Prev:r.Next,r.None,!1);return!0;case n.MoveAcross:this._moveSel(r.None,o?r.Prev:r.Next,!1);return!0;case n.Cycle:this._moveSel(r.None,o?r.PrevCell:r.NextCell,!1);return!0;case n.CycleOut:var l=this._g.selection;this._moveSel(r.None,o?r.PrevCell:r.NextCell,!1);return!l.equals(this._g.selection)}return!1};_KeyboardHandler.prototype._keypress=function(t){var i=this,o=this._g;if(!o._wantsInput(t.target)&&!t.defaultPrevented)if(this._altDown)t.preventDefault();else{var n=o._edtHdl;if(o.activeEditor)n._keypress(t);else if(t.charCode>e.Key.Space)if(this._startEditing(!1,t)&&o.activeEditor){var r=e.getActiveElement();if(r instanceof HTMLInputElement&&"checkbox"!=r.type||r instanceof HTMLTextAreaElement){var l=o._selHdl.selection,s=o.getCellData(l.row,l.col,!0),a=o.getCellData(l.row,l.col,!1),c=e.culture.Globalize.numberFormat["%"]||"%",u=String.fromCharCode(t.charCode),d=e.isNumber(a)&&s.indexOf(c)>-1||""==s&&r.value==c;r.value=u+(d?c:"");e.setSelectionRange(r,1);r.dispatchEvent(n._evtInput);n._keypress(t);n._edtValue=r.value!=s?r.value:null;t.preventDefault()}}else if(o.autoSearch){var h=!1;l=o._selHdl.selection;if(t.charCode>32||32==t.charCode&&this._search){t.preventDefault();this._search+=String.fromCharCode(t.charCode).toLowerCase();this._toSearch&&clearTimeout(this._toSearch);this._toSearch=setTimeout((function(){i._toSearch=null;i._search=""}),e.Control._SEARCH_DELAY);var g=this._findNext(l.row,l.col);if(g<0&&this._search.length>1){this._search=this._search[this._search.length-1];g=this._findNext(l.row,l.col)}if(g>-1){h=!0;o.select(g,l.col)}}h||(this._search="")}}};_KeyboardHandler.prototype._findNext=function(e,t){var i=this._g,o=i.rows.length;(e<0||1==this._search.length)&&e++;for(var n=0;n<o;n++){var r=(e+n)%o;if(0==i.getCellData(r,t,!0).trim().toLowerCase().indexOf(this._search))return r}return-1};_KeyboardHandler.prototype._moveSel=function(e,i,o){this._g.selectionMode!=t.SelectionMode.None&&this._g._selHdl.moveSelection(e,i,o)};_KeyboardHandler.prototype._deleteSel=function(e){var i=this,o=this._g,n=o.editableCollectionView,r=o.selection,l=o.rows,s=[],a=new t.CellRange,c=new t.CellEditEndingEventArgs(o.cells,a,e),u=t.SelectionMode;if(o.allowDelete&&!o.isReadOnly&&(null==n||n.canRemove&&!n.isAddingNew&&!n.isEditingItem))switch(o.selectionMode){case u.CellRange:case u.MultiRange:o.selectedRanges.forEach((function(e){if(0==e.leftCol&&e.rightCol==o.columns.length-1)for(var t=e.topRow;t>-1&&t<=e.bottomRow;t++){var i=l[t];s.indexOf(i)<0&&s.push(i)}}));break;case u.ListBox:for(var d=0;d<l.length;d++)l[d].isSelected&&s.push(l[d]);break;case u.Row:r.topRow>-1&&s.push(l[r.topRow]);break;case u.RowRange:for(d=r.topRow;d>-1&&d<=r.bottomRow;d++)s.push(l[d])}if(s.length>0){o.deferUpdate((function(){n&&n.beginUpdate();for(var e=s.length-1;e>=0;e--){var i=s[e];if(!(i instanceof t._NewRowTemplate)){a.setRange(i.index,-1);if(o.onDeletingRow(c)){n&&i.dataItem?n.remove(i.dataItem):o.rows.removeAt(i.index);o.onDeletedRow(c)}}}n&&n.endUpdate(!1)}));var h=r.topRow;(h=Math.min(h,o.rows.length-1))>0&&o.rows[h]instanceof t._NewRowTemplate&&h--;r.row=r.row2=h;o.selection=r;o.selectionMode==u.ListBox&&h>-1&&h<o.rows.length&&(o.rows[h].isSelected=!0);o.childItemsPath&&o.collectionView&&o.collectionView.refresh();return!0}if(!o.isReadOnly&&0==s.length){o.deferUpdate((function(){i._deleteRange(e,r);o.selectionMode==u.MultiRange&&o._selHdl.extendedSelection.forEach((function(t){i._deleteRange(e,t)}));o.select(r,!1)}));return!0}return!1};_KeyboardHandler.prototype._deleteRange=function(e,i){for(var o=this._g,n=o.editableCollectionView,r=new t.CellRange,l=new t.CellEditEndingEventArgs(o.cells,r,e),s=i.row>i.row2?1:-1,a=i.row2;i.containsRow(a);a+=s){var c=o.rows[a];if(!c.isReadOnly)for(var u=i.leftCol;u<=i.rightCol;u++){var d=o._getBindingColumn(o.cells,a,o.columns[u]);if(!d.getIsRequired(c)&&!d.isReadOnly&&!c.isReadOnly&&o.getCellData(a,u,!0)){r.setRange(a,u);l.cancel=!1;if(o.onBeginningEdit(l)){if(n){var h=c.dataItem;n.editItem(h);o._edtHdl._edItem=h}o.setCellData(a,u,"",!0,!1);o.onCellEditEnding(l);o.onCellEditEnded(l)}}}}};_KeyboardHandler.prototype._startEditing=function(e,t,i,o){return this._g._edtHdl.startEditing(e,i,o,!0,t)};return _KeyboardHandler}();t._KeyboardHandler=o}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i=function(){function _ImeHandler(t){this._updateImeFocusBnd=this._updateImeFocus.bind(this);this._cmpstartBnd=this._compositionstart.bind(this);this._mousedownBnd=this._mousedown.bind(this);this._mouseupBnd=this._mouseup.bind(this);this._keypressBnd=this._keypress.bind(this);this._g=t;var i=e.createElement('<textarea class="wj-grid-editor wj-form-control wj-grid-ime" aria-hidden="true"/>');e.setCss(i,_ImeHandler._cssHidden);e.disableAutoComplete(i);i.tabIndex=-1;this._tbx=i;t._root.appendChild(i);this._updateImeFocus();var o=t.hostElement,n=t.addEventListener.bind(t);n(i,"compositionstart",this._cmpstartBnd);n(o,"blur",this._updateImeFocusBnd,!0);n(o,"focus",this._updateImeFocusBnd);n(o,"mousedown",this._mousedownBnd,!0);n(o,"mouseup",this._mouseupBnd,!0);n(o,"keypress",this._keypressBnd,!0);t.cellEditEnded.addHandler(this._cellEditEnded,this);t.selectionChanged.addHandler(this._updateImeFocus,this)}_ImeHandler.prototype.dispose=function(){var t=this._g,i=t.hostElement,o=this._tbx,n=t.removeEventListener.bind(t);n(o,"compositionstart",this._cmpstartBnd);n(i,"blur",this._updateImeFocusBnd);n(i,"focus",this._updateImeFocusBnd);n(i,"mousedown",this._mousedownBnd);n(i,"mouseup",this._mouseupBnd);n(i,"keypress",this._keypressBnd);t.cellEditEnded.removeHandler(this._cellEditEnded);t.selectionChanged.removeHandler(this._updateImeFocus);e.removeChild(o)};_ImeHandler.prototype._compositionstart=function(){var t=this._g;if(!t.activeEditor){var i=t._selHdl.selection;if(t.startEditing(!1,i.row,i.col,!1)&&t.activeEditor&&"checkbox"!=t.activeEditor.type){i=t.editRange;var o=t.activeEditor,n=this._tbx,r=t.cells.hostElement,l=t.columns[i.col].pos+r.offsetLeft,s=t.rows[i.row].pos+r.offsetTop,a=t.getCellBoundingRect(i.row,i.col),c=e.closest(o,".wj-cell");a.width=c.offsetWidth;a.height=c.offsetHeight;i.row<t.frozenRows&&(s+=t._root.scrollTop);i.col<t.frozenColumns&&(l+=t._root.scrollLeft);var u=c.querySelector(".wj-btn.wj-right");u&&(a.width-=u.offsetWidth);"minLength,maxLength,pattern".split(",").forEach((function(t){e.setAttribute(n,t,o.getAttribute(t))}));var d=o instanceof HTMLTextAreaElement;e.setAttribute(n,"wrap",d?"soft":"off");var h=getComputedStyle(c),g=h.paddingTop;if(i.rowSpan>1&&!d){var f=parseFloat(h.lineHeight);isNaN(f)&&(f=1.2*parseFloat(h.fontSize));g=Math.max(0,(a.height-f)/2)+"px"}e.setCss(n,{position:"absolute",left:l,top:s,width:a.width-1,height:a.height-1,paddingTop:g,paddingLeft:h.paddingLeft,paddingRight:h.paddingRight,textAlign:h.textAlign,zIndex:c.style.zIndex});t._edtHdl._edt=n;n.select();var p=o.value;setTimeout((function(){if("　"==n.value||" "==n.value){n.value=p;e.setSelectionRange(n,p.length)}}),20);o.value=""}}};_ImeHandler.prototype._cellEditEnded=function(){var t=this;e.setCss(this._tbx,_ImeHandler._cssHidden);setTimeout((function(){t._tbx.value=""}))};_ImeHandler.prototype._mousedown=function(e){this._isMouseDown=!0;this._updateImeFocus()};_ImeHandler.prototype._mouseup=function(e){this._isMouseDown=!1;this._updateImeFocus()};_ImeHandler.prototype._keypress=function(e){if(!e.defaultPrevented&&e.target==this._tbx&&!(e.ctrlKey||e.altKey||e.metaKey||this._g.activeEditor)){this._tbx.value="";this._compositionstart();e.stopPropagation()}};_ImeHandler.prototype._updateImeFocus=function(){var t=this._g,i=this._tbx,o=e.getActiveElement();if(!t.activeEditor&&e.closest(o,".wj-flexgrid")==t.hostElement)if(this._enableIme()){if(o!=i){i.disabled=!1;i.select();i.focus()}}else{i.disabled=!0;i.value="";t.focus()}};_ImeHandler.prototype._enableIme=function(){var t=this._g,i=t._selHdl.selection;if(!t.canEditCell(i.row,i.col))return!1;var o=i.isValid?t._getBindingColumn(t.cells,i.row,t.columns[i.col]):null;return!(!o||o.dataType==e.DataType.Boolean)};_ImeHandler._cssHidden={position:"fixed",width:"1px",left:-32e3,top:-32e3,overflow:"hidden"};return _ImeHandler}();t._ImeHandler=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){var i=function(){function _ColumnGroupHandler(e){this._grid=e}_ColumnGroupHandler.prototype.createColumnGroups=function(i){var n=this,r=this._grid;this._groupDefs=e.asArray(i);r.autoGenerateColumns=!1;r.columns.clear();this._colGroups=[];i.forEach((function(e){n._colGroups.push(new o(e,null))}));var l=1;this._colGroups.forEach((function(e){n._addColumnGroup(e);l=Math.max(l,e._getMaxLevel())}));this._colGroups.forEach((function(e){e._expandRange(l)}));var s=r.columnHeaders.rows;s.clear();for(var a=0;a<=l;a++){var c=new t.Row;s.splice(a,0,c);a<l&&(c.cssClassAll="wj-colgroup")}for(a=0;a<s.length;a++)for(var u=0;u<r.columns.length;u++){var d=this.getColumnGroup(a,u);if(d){var h=d.header||e.toHeaderCase(d.binding);r.columnHeaders.setCellData(a,u,h)}}};_ColumnGroupHandler.prototype._addColumnGroup=function(e){var t=this,i=this._grid;e._grid=i;e._rng.col=i.columns.length;0==e.columns.length?i.columns.push(e):e.columns.forEach((function(e){t._addColumnGroup(e)}));e._rng.col2=i.columns.length-1};_ColumnGroupHandler.prototype.hasColumnGroups=function(){return null!=this._colGroups&&this._colGroups.length>0};_ColumnGroupHandler.prototype.getGroupDefinitions=function(){return this._groupDefs};_ColumnGroupHandler.prototype.getColumnGroup=function(e,t){var i=this._grid;if(e<i.columnHeaders.rows.length&&t<i.columns.length)for(var o=this._colGroups;o;)for(var n=0;n<o.length;n++){var r=o[n],l=r._rng;if(l.containsColumn(t)){if(l.containsRow(e)||0==r.columns.length)return r;o=r.columns;break}}return null};return _ColumnGroupHandler}();t._ColumnGroupHandler=i;var o=function(i){__extends(_ColumnGroup,i);function _ColumnGroup(o,n){var r=i.call(this)||this;r._rng=new t.CellRange(0,-1);r._cols=[];r._lvl=0;r._collapsed=!1;r._pGrp=n;for(var l=n;l;l=l._pGrp)r._lvl++;r._rng.row=r._rng.row2=r._lvl;r.allowDragging=!1;o&&e.copy(r,o);return r}Object.defineProperty(_ColumnGroup.prototype,"columns",{get:function(){return this._cols},set:function(e){var t=this;this._cols=[];e.forEach((function(e){var i=new _ColumnGroup(e,t);t._cols.push(i)}))},enumerable:!0,configurable:!0});Object.defineProperty(_ColumnGroup.prototype,"collapseTo",{get:function(){return this._collTo},set:function(t){this._collTo=e.asString(t)},enumerable:!0,configurable:!0});Object.defineProperty(_ColumnGroup.prototype,"isCollapsed",{get:function(){return this._collapsed},set:function(i){var o=this;if(i!=this._collapsed){var n=this._grid;if(n){var r=new t.CellRangeEventArgs(n.rowHeaders,this._rng,this);if(n.onColumnGroupCollapsedChanging(r)){this._collapsed=e.asBoolean(i);n.onColumnGroupCollapsedChanged(r)}}else this._collapsed=e.asBoolean(i)}setTimeout((function(){o._updateCollapsedState()}))},enumerable:!0,configurable:!0});Object.defineProperty(_ColumnGroup.prototype,"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0});_ColumnGroup.prototype._updateCollapsedState=function(){var e=this._grid.columns,t=this._rng,i=this._collapsed;this._cols.forEach((function(e){if(e instanceof _ColumnGroup){e._collapsed=i;e._updateCollapsedState()}}));for(var o=this.collapseTo?e.getColumn(this.collapseTo):null,n=o?o.index:t.rightCol,r=t.leftCol;r<=t.rightCol;r++)e[r].visible=!i||r==n};_ColumnGroup.prototype._getMaxLevel=function(){var e=this._lvl;this.columns.forEach((function(t){e=Math.max(e,t._getMaxLevel())}));return e};_ColumnGroup.prototype._expandRange=function(e){var t=e-this._getMaxLevel();if(t>0){this._rng.row2+=t;this._cols.forEach((function(e){e._shiftRange(t)}))}for(var i=this._grid.columns,o=this._rng,n=o.col;n<=o.col2;n++){i[n]._rng.row2=e}};_ColumnGroup.prototype._shiftRange=function(e){this._rng.row+=e;this._rng.row2+=e;this._cols.forEach((function(t){t._shiftRange(e)}))};return _ColumnGroup}(t.Column);t._ColumnGroup=o}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i;!function(e){e[e.None=0]="None";e[e.Cell=1]="Cell";e[e.ColumnHeader=2]="ColumnHeader";e[e.RowHeader=3]="RowHeader";e[e.TopLeft=4]="TopLeft";e[e.ColumnFooter=5]="ColumnFooter";e[e.BottomLeft=6]="BottomLeft"}(i=t.CellType||(t.CellType={}));var o=function(){function GridPanel(i,o,n,r,l){this._offsetY=0;this._rng=new t.CellRange;this._g=e.asType(i,t.FlexGrid);this._ct=e.asInt(o);this._rows=e.asType(n,t.RowCollection);this._cols=e.asType(r,t.ColumnCollection);this._e=e.asType(l,HTMLElement);this._vrb=new t.CellRange}Object.defineProperty(GridPanel.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0});Object.defineProperty(GridPanel.prototype,"cellType",{get:function(){return this._ct},enumerable:!0,configurable:!0});Object.defineProperty(GridPanel.prototype,"viewRange",{get:function(){return this._getViewRange()},enumerable:!0,configurable:!0});Object.defineProperty(GridPanel.prototype,"width",{get:function(){return this._cols.getTotalSize()},enumerable:!0,configurable:!0});Object.defineProperty(GridPanel.prototype,"height",{get:function(){return this._rows.getTotalSize()},enumerable:!0,configurable:!0});Object.defineProperty(GridPanel.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0});Object.defineProperty(GridPanel.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0});GridPanel.prototype.getCellData=function(o,n,r){var l,s=this._g,a=this._rows[e.asNumber(o,!1,!0)],c=null;if(e.isString(n)&&(n=this._cols.indexOf(n))<0)throw"Invalid column name or binding.";l=this._cols[e.asNumber(n,!1,!0)];var u=s?s._getBindingColumn(this,o,l):l,d=null;a instanceof t.GroupRow&&a.dataItem instanceof e.collections.CollectionViewGroup&&!s.childItemsPath&&(d=a.dataItem);u.binding&&a.dataItem&&!d?c=u._binding.getValue(a.dataItem):a._ubv&&(c=a._ubv[l._hash]);if(null==c)switch(this._ct){case i.ColumnHeader:o!=this._rows.length-1&&u==l||(c=u.header);break;case i.ColumnFooter:if(u.aggregate!=e.Aggregate.None&&a instanceof t.GroupRow){var h=this._g.collectionView;if(h){var g=e.tryCast(h,e.collections.CollectionView);c=g?g.getAggregate(u.aggregate,u.binding):e.getAggregate(u.aggregate,h.items,u.binding)}}break;case i.Cell:u.aggregate!=e.Aggregate.None&&a instanceof t.GroupRow&&d&&(c=d.getAggregate(u.aggregate,u.binding,this._g.collectionView))}if(r){this.cellType==i.Cell&&u.dataMap&&(c=u.dataMap.getDisplayValue(c));c=null!=c?e.Globalize.format(c,u.format||a.format):""}return c};GridPanel.prototype.setCellData=function(t,o,n,r,l){void 0===r&&(r=!0);void 0===l&&(l=!0);var s,a=this._rows[e.asNumber(t,!1,!0)];if(e.isString(o)&&(o=this._cols.indexOf(o))<0)throw"Invalid column name or binding.";s=this._cols[e.asNumber(o,!1,!0)];var c=this._g?this._g._getBindingColumn(this,t,s):s;if(this._ct==i.Cell){if(c.dataMap&&null!=n&&(c.isRequired||""!=n)){var u=c.dataMap,d=u.getKeyValue(n,c.isContentHtml);if(null==d&&null==u.getDisplayValue(null)){if(u.getDisplayValue(n)!=n);else if(!u.isEditable||u.displayMemberPath!=u.selectedValuePath)return!1}else n=d}var h=e.DataType.Object,g=c.dataType||a.dataType;if(g)h=g;else{var f=this.getCellData(t,o,!1);h=e.getType(f)}var p=c.getIsRequired(a),_=""===n||null==n;if(!p&&_){h!=e.DataType.String&&(n=null);r=!1}else if(p&&_&&r)return!1;if(r){n=e.changeType(n,h,c.format||a.format);if(h!=e.DataType.Object&&e.getType(n)!=h)return!1}}if(a.dataItem&&c.binding){var w=c._binding,m=a.dataItem,C=w.getValue(m);if(n!==C&&!e.DateTime.equals(n,C)){w.setValue(m,n);var y=this._g.collectionView;if(y instanceof e.collections.CollectionView&&m!=y.currentEditItem){var v=new e.collections.NotifyCollectionChangedEventArgs(e.collections.NotifyCollectionChangedAction.Change,m,y.items.indexOf(m));y.onCollectionChanged(v)}}}else{a._ubv||(a._ubv={});a._ubv[s._hash]=n}l&&this._g&&this._g.invalidate();return!0};GridPanel.prototype.getCellBoundingRect=function(t,i,o){var n=this._g,r=this.rows[t],l=this.columns[i],s=new e.Rect(l.pos,r.pos,l.renderSize,r.renderSize);if(n.rightToLeft){s.left=this.hostElement.clientWidth-s.right;e.isIE()||e.isFirefox()||(s.left-=n._root.offsetWidth-n._root.clientWidth)}if(!o){var a=this.hostElement.getBoundingClientRect();s.left+=a.left;s.top+=a.top-this._offsetY}t<this.rows.frozen&&(s.top-=n.scrollPosition.y);i<this.columns.frozen&&(s.left-=n.scrollPosition.x*(n.rightToLeft?-1:1));return s};GridPanel.prototype.getCellElement=function(e,t){for(var i=this.hostElement.children,o=Math.min(e+2,i.length),n=0;n<o;n++)for(var r=i[n].children,l=Math.min(t+2,r.length),s=0;s<l;s++){var a=r[s],c=a[GridPanel._INDEX_KEY];if(c&&(c.row==e&&c.col==t||c.rng&&c.rng.contains(e,t)))return a}return null};GridPanel.prototype.getSelectedState=function(e,o,n){var r=this._g,l=r.selectionMode,s=r._selHdl.selection,a=t.SelectionMode,c=t.SelectedState;if(l==a.None)return c.None;switch(this._ct){case i.Cell:n||(n=r.getMergedRange(this,e,o));if(n){if(n.contains(s.row,s.col))return r.showMarquee?c.Active:c.Cursor;for(var u=r.selectedRanges,d=0;d<u.length;d++)if(n.intersects(u[d]))return c.Selected}if(s.row==e&&s.col==o)return r.showMarquee?c.Active:c.Cursor;if(r.rows[e].isSelected||r.columns[o].isSelected)return c.Selected;if(l==a.MultiRange){var h=r._selHdl.extendedSelection;for(d=0;d<h.length;d++)if(h[d].contains(e,o))return c.Selected}if(n)switch(l){case a.Row:case a.RowRange:case a.ListBox:if(n.containsRow(s.row))return c.Selected}return l==t.SelectionMode.ListBox?c.None:(s=this._getAdjustedSelection(s)).containsRow(e)&&s.containsColumn(o)?c.Selected:c.None;case i.ColumnHeader:if(r.showSelectedHeaders&t.HeadersVisibility.Column&&(r.columns[o].isSelected||s.containsColumn(o)||s.intersectsColumn(n))){n&&(e=n.bottomRow);if(e==this.rows.length-1)return c.Selected}break;case i.RowHeader:if(r.showSelectedHeaders&t.HeadersVisibility.Row&&(r.rows[e].isSelected||s.containsRow(e)||s.intersectsRow(n))){n&&(o=n.rightCol);if(o==this.columns.length-1)return c.Selected}}return c.None};Object.defineProperty(GridPanel.prototype,"hostElement",{get:function(){return this._e},enumerable:!0,configurable:!0});GridPanel.prototype._getAdjustedSelection=function(e){var i=this._g,o=this._rng,n=t.SelectionMode;switch(i.selectionMode){case n.Cell:o.setRange(e.row,e.col,e.row,e.col);break;case n.Row:o.setRange(e.row,0,e.row,i.columns.length-1);break;case n.RowRange:case n.ListBox:o.setRange(e.row,0,e.row2,i.columns.length-1);break;default:o.copy(e)}return o};GridPanel.prototype._getOffsetY=function(){return this._offsetY};GridPanel.prototype._updateContent=function(e,o,n){var r=this._g,l=this._e,s=this._rows,a=this._cols,c=this._ct;if(c==i.ColumnHeader||c==i.ColumnFooter||c==i.RowHeader){var u=r._ptScrl,d=l.style;c==i.RowHeader?d.top=u.y+"px":r.rightToLeft?d.right=u.x+"px":d.left=u.x+"px"}if(this._offsetY!=n){e=!1;this._offsetY=n}var h=this._getViewRange(),g=h;if(g.isValid){var f=s.length<=r._vtRows?s.length:0,p=a.length<=r._vtCols?a.length:0;g=new t.CellRange(Math.max(h.row-f,s.frozen),Math.max(h.col-p,a.frozen),Math.min(h.row2+f,s.length-1),Math.min(h.col2+p,a.length-1))}if(e&&!o&&this._vrb.contains(h)&&!s.frozen&&!a.frozen)return this._activeCell;e&&g.equals(this._vrb)||(o=!1);e&&!o&&this._ct!=i.TopLeft&&this._reorderCells(g,this._vrb);this._activeCell=null;this._vru=h;this._vrb=g;this._recycle=e;var _=0;this._ct==i.Cell&&(_=this._renderColHdrRow(g,o));for(var w=0;w<s.frozen&&w<s.length;w++)_=this._renderRow(w,g,o,_);for(w=g.topRow;w<=g.bottomRow&&w>-1;w++)_=this._renderRow(w,g,o,_);for(;l.childElementCount>_;){var m=l.lastElementChild;l.removeChild(m);this._removeExtraCells(m,0)}return this._activeCell};GridPanel.prototype._clearCells=function(){for(var e=this.hostElement,t=this._g.cellFactory,i=e.childElementCount-1;i>=0;i--){var o=e.children[i];e.removeChild(o);for(var n=o.childElementCount-1;n>=0;n--)t.disposeCell(o.children[n])}};GridPanel.prototype._reorderCells=function(t,o){if(this._g._reorderCells&&o.isValid&&t.isValid&&t.intersects(o)){if(t.row!=o.row){var n=this._e,r=t.row-o.row,l=Math.max(1,t.rowSpan-1);if(0!=r&&Math.abs(r)<l){var s=this._ct==i.Cell?1:0,a=n.childElementCount;s+=this.rows.frozen;if(r>0){var c=s,u=Math.min(s+r,a);(f=this._createRange(n,c,u))&&n.appendChild(f.extractContents())}if(r<0){u=a,c=Math.max(s,u+r);if((f=this._createRange(n,c,u))&&c>s){var d=n.children[s];n.insertBefore(f.extractContents(),d)}}}}if(t.col!=o.col){n=this._e,r=t.col-o.col,l=Math.max(1,t.columnSpan-1);if(0!=r&&Math.abs(r)<l){s=this._ct==i.Cell&&this._g.rowHeaderPath?1:0;s+=this.columns.frozen;for(var h=0;h<n.children.length;h++){var g=n.children[h];a=g.children.length;if(e.hasClass(g,"wj-row")){if(r>0){c=s,u=Math.min(s+r,a);(f=this._createRange(g,c,u))&&g.appendChild(f.extractContents())}if(r<0){var f;u=a,c=Math.max(s,u+r);if((f=this._createRange(g,c,u))&&c>s){d=g.children[s];g.insertBefore(f.extractContents(),d)}}}}}}}};GridPanel.prototype._createRange=function(e,t,i){if(i>t&&i<=e.children.length&&t>-1){this._docRange||(this._docRange=document.createRange());var o=this._docRange;o.setStart(e,t);o.setEnd(e,i);return o}return null};GridPanel.prototype._renderColHdrRow=function(t,i){if(i)return 1;var o=this._e.children[0];o||(o=e.createElement('<div class="wj-row" role="row"></div>',this._e));var n=this._g,r=n?n.columnHeaders.rows.ariaLabel:null;e.setAttribute(o,"aria-label",r);e.setAttribute(o,"aria-selected",null);var l=0,s=this._g._getRowHeaderPath();s&&(l=this._renderRowHdrCell(o,-1,s.path));for(var a=0;a<this.columns.frozen&&a<this.columns.length;a++)l=this._renderColHdrCell(o,a,t,i,l);for(a=t.leftCol;a<=t.rightCol&&a>-1;a++)l=this._renderColHdrCell(o,a,t,i,l);this._removeExtraCells(o,l);return 1};GridPanel.prototype._renderColHdrCell=function(t,i,o,n,r){var l=this.grid,s=this.columns[i];if(s.renderSize<=0)return r;if(n)return r+1;var a=t.children[r];a||(a=e.createElement(GridPanel._HTML_CELL,t));e.setAttribute(a,"role","columnheader");if(a&&this._recycle&&l._lazyRender){var c=a[GridPanel._INDEX_KEY];if(c&&-1==c.row&&c.col==i&&i>=this.columns.frozen)return r+1}a.textContent=this.columns[i].header;e.setCss(a,{position:"fixed",left:s.pos,top:-32e3,width:s.renderSize,height:.1,overflow:"hidden",opacity:"0",pointerEvents:"none"});if(s.describedById||this.columns.describedById){var u=[s.describedById,this.columns.describedById].join(" ").trim();e.setAttribute(a,"aria-describedby",u||null)}if(l.allowSorting){var d="none";switch(l._getBindingColumn(this,0,s).currentSort){case"+":d="ascending";break;case"-":d="descending"}e.setAttribute(a,"aria-sort",d)}if(!l.isReadOnly){e.setAttribute(a,"aria-readonly",s.isReadOnly);e.setAttribute(a,"aria-required",s.getIsRequired())}a[GridPanel._INDEX_KEY]={row:-1,col:i,panel:this};return r+1};GridPanel.prototype._renderRowHdrCell=function(t,i,o){var n=t.children[0];n||(n=e.createElement(GridPanel._HTML_CELL,t));n.setAttribute("role",i<0?"columnheader":"rowheader");n.textContent=o?o.toString():"";e.setCss(n,{position:"fixed",left:-32e3,top:-32e3,width:.1,height:.1,overflow:"hidden",opacity:"0"});n[GridPanel._INDEX_KEY]={row:i,col:-1,panel:this};return 1};GridPanel.prototype._renderRow=function(o,n,r,l){var s=this._g,a=this.rows[o];if(a.renderSize<=0)return l;var c=this._e.children[l];c||(c=e.createElement('<div class="wj-row"></div>',this._e));if(this._ct==i.Cell){c.setAttribute("role","row");var u=t.SelectionMode;switch(s.selectionMode){case u.Row:case u.RowRange:case u.ListBox:var d=a.isSelected||this._g._selHdl.selection.containsRow(o);e.setAttribute(c,"aria-selected",!!d)}e.setAttribute(c,"aria-level",a instanceof t.GroupRow?a.level+1:null);e.setAttribute(c,"aria-expanded",a instanceof t.GroupRow?!a.isCollapsed:null);this.rows.ariaLabel&&e.setAttribute(c,"aria-label",this.rows.ariaLabel)}var h=0;if(this._ct==i.Cell){var g=this._g._getRowHeaderPath();g&&(h=this._renderRowHdrCell(c,o,g.getValue(a.dataItem)))}for(var f=0;f<this.columns.frozen&&f<this.columns.length;f++)h=this._renderCell(c,o,f,n,r,h);for(f=n.leftCol;f<=n.rightCol&&f>-1;f++)h=this._renderCell(c,o,f,n,r,h);this._removeExtraCells(c,h);return l+1};GridPanel.prototype._renderCell=function(o,n,r,l,s,a){var c=this._g,u=c.getMergedRange(this,n,r,!0);if(u){for(var d=Math.max(l.row,u.row);d<n;d++)if(this.rows[d].renderSize)return a;for(d=Math.max(l.col,u.col);d<r;d++)if(this.columns[d].renderSize)return a;var h=this.columns.frozen;if(h&&u.col<h&&u.col2>=h&&r>u.col)return a}var g=this.columns[r];if(g.renderSize<=0&&(!u||u.getRenderSize(this).width<=0))return a;var f=o.children[a];if(f&&!s&&this._recycle&&c._lazyRender&&!c.activeEditor){var p=f[GridPanel._INDEX_KEY];p&&p.row==n&&p.col==r&&p.rng==u&&n>=this.rows.frozen&&r>=this.columns.frozen&&(s=!0)}var _=t.SelectedState,w=this.getSelectedState(n,r,u),m=w==_.Cursor||w==_.Active;if(f&&s){e.toggleClass(f,"wj-state-active",m);e.toggleClass(f,"wj-state-selected",w==_.Cursor);e.toggleClass(f,"wj-state-multi-selected",w==_.Selected);e.setAttribute(f,"aria-selected",m||w!=_.None);m&&(this._activeCell=f);return a+1}f||(f=e.createElement(GridPanel._HTML_CELL,o));m&&(this._activeCell=f);if(this._ct==i.Cell){e.setAttribute(f,"role","gridcell");e.setAttribute(f,"aria-selected",w!=_.None||m);e.setAttribute(f,"aria-readonly",!c.canEditCell(n,r)||null);e.setAttribute(f,"aria-required",g.getIsRequired())}c.cellFactory.updateCell(this,n,r,f,u);f[GridPanel._INDEX_KEY]={row:n,col:r,rng:u,panel:this};return a+1};GridPanel.prototype._removeExtraCells=function(e,t){for(var i=this._g.cellFactory;e.childElementCount>t;){var o=e.lastElementChild;e.removeChild(o);i.disposeCell(o)}};GridPanel.prototype._getViewRange=function(){var e=this._g,o=e._ptScrl,n=this._rows,r=this._cols,l=new t.CellRange(0,0,n.length-1,r.length-1);if(this._ct==i.Cell||this._ct==i.RowHeader){var s=-o.y+this._offsetY,a=e._szClient.height;if((h=Math.min(n.frozen,n.length-1))>0){s+=p=n[h-1].pos;a-=p}l.row=Math.min(n.length-1,Math.max(n.frozen,n.getItemAt(s+1)));l.row2=n.getItemAt(s+a);var c=e.hostElement;if(e._clipToScreen&&c){var u=c.getBoundingClientRect(),d=-u.top-e.cells._e.offsetTop;u.top<0&&(l.row=Math.max(l.row,n.getItemAt(d)-1));u.bottom>innerHeight&&(l.row2=Math.min(l.row2,n.getItemAt(d+innerHeight)+1))}}if(this._ct==i.Cell||this._ct==i.ColumnHeader){var h,g=-o.x,f=e._szClient.width;if((h=Math.min(r.frozen,r.length-1))>0){var p;g+=p=r[h-1].pos;f-=p}l.col=Math.min(r.length-1,Math.max(r.frozen,r.getItemAt(g+1)));l.col2=r.getItemAt(g+f)}n.length<=n.frozen&&(l.row=l.row2=-1);r.length<=r.frozen&&(l.col=l.col2=-1);return l};GridPanel.prototype._getFrozenPos=function(){var t=this._rows.frozen,i=this._cols.frozen,o=t>0?this._rows[t-1]:null,n=i>0?this._cols[i-1]:null,r=o?o.pos+o.renderSize:0,l=n?n.pos+n.renderSize:0;return new e.Point(l,r)};GridPanel._INDEX_KEY="wj-cell-index";GridPanel._HTML_CELL='<div class="wj-cell" tabindex="-1"></div>';return GridPanel}();t.GridPanel=o}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i;!function(e){e[e.None=0]="None";e[e.Cells=1]="Cells";e[e.ColumnHeaders=2]="ColumnHeaders";e[e.RowHeaders=4]="RowHeaders";e[e.AllHeaders=6]="AllHeaders";e[e.All=7]="All"}(i=t.AllowMerging||(t.AllowMerging={}));var o=function(){function MergeManager(e){this._g=e}MergeManager.prototype.getMergedRange=function(o,n,r,l){void 0===l&&(l=!0);var s=this._g,a=o.cellType,c=o.columns,u=o.rows,d=u[n],h=c[r];if(d instanceof t._NewRowTemplate)return null;if(o==s.columnHeaders){var g=s._getColumnGroup(n,r);if(g){var f=g._rng,p=o.columns;if(p.isFrozen(f.col)!=p.isFrozen(f.col2)){f=f.clone();p.isFrozen(r)?f.col2=p.frozen-1:f.col=p.frozen}return f}}if(s.showGroups&&!s.childItemsPath&&d instanceof t.GroupRow&&d.dataItem instanceof e.collections.CollectionViewGroup&&a==t.CellType.Cell){f=new t.CellRange(n,r);if(h.aggregate==e.Aggregate.None){for(;f.col>0&&c[f.col-1].aggregate==e.Aggregate.None&&f.col!=c.frozen;)f.col--;for(;f.col2<c.length-1&&c[f.col2+1].aggregate==e.Aggregate.None&&f.col2+1!=c.frozen;)f.col2++}for(;f.col<r&&!c[f.col].visible;)f.col++;return f.isSingleCell?null:f}var _=!1,w=i,m=t.CellType;switch(s.allowMerging){case w.None:_=!0;break;case w.Cells:_=a!=m.Cell;break;case w.ColumnHeaders:_=a!=m.ColumnHeader&&a!=m.TopLeft;break;case w.RowHeaders:_=a!=m.RowHeader&&a!=m.TopLeft;break;case w.AllHeaders:_=a==m.Cell}if(_)return null;if(c[r].allowMerging){f=new t.CellRange(n,r);var C=o._vrb,y=0,v=u.length-1;if(n>=u.frozen){if(l&&(a==t.CellType.Cell||a==t.CellType.RowHeader)&&s._vtRows<u.length&&C){y=C.topRow;v=C.bottomRow}}else u.length>u.frozen&&(v=u.frozen-1);for(var b=n-1;b>=y&&this._mergeCell(o,b,r,n,r);b--)f.row=b;for(var R=n+1;R<=v&&this._mergeCell(o,n,r,R,r);R++)f.row2=R;for(;f.row<n&&!u[f.row].visible;)f.row++;if(!f.isSingleCell)return f}if(u[n].allowMerging){f=new t.CellRange(n,r),C=o._vrb;var x=0,S=c.length-1;if(r>=c.frozen){if(l&&(a==t.CellType.Cell||a==t.CellType.ColumnHeader)&&s._vtCols<c.length&&C){x=C.leftCol;S=C.rightCol}}else S=c.frozen-1;for(var E=r-1;E>=x&&this._mergeCell(o,n,E,n,r);E--)f.col=E;for(var H=r+1;H<=S&&this._mergeCell(o,n,r,n,H);H++)f.col2=H;for(;f.col<r&&!c[f.col].visible;)f.col++;if(!f.isSingleCell)return f}return null};MergeManager.prototype._mergeCell=function(e,i,o,n,r){var l=e.rows[i],s=e.rows[n];if(l instanceof t.GroupRow||l instanceof t._NewRowTemplate||s instanceof t.GroupRow||s instanceof t._NewRowTemplate)return!1;if(i!=n&&e.rows.isFrozen(i)!=e.rows.isFrozen(n))return!1;if(o!=r&&e.columns.isFrozen(o)!=e.columns.isFrozen(r))return!1;if(i!=n){if(o>0&&(l.allowMerging&&this._mergeCell(e,i,o-1,i,o)||s.allowMerging&&this._mergeCell(e,n,o-1,n,o)))return!1;if(r<e.columns.length-1&&(l.allowMerging&&this._mergeCell(e,i,r,i,r+1)||s.allowMerging&&this._mergeCell(e,n,r,n,r+1)))return!1}return e.getCellData(i,o,!0)==e.getCellData(n,r,!0)};return MergeManager}();t.MergeManager=o}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i=function(){function HitTestInfo(i,o){this._row=-1;this._col=-1;this._edge=0;var n;if(o instanceof Element){if(e.closest(o,".wj-flexgrid")!=i.hostElement)return;i=o}if(!(i instanceof Element)||i instanceof t.FlexGrid){if(i instanceof t.FlexGrid)n=this._g=i;else{if(!(i instanceof t.GridPanel))throw"First parameter should be a FlexGrid or GridPanel.";this._p=i;n=this._g=this._p.grid}o instanceof MouseEvent&&"mousedown"==o.type&&(n._rcBounds=null);o=e.mouseToPage(o);this._pt=o.clone();var r=n.controlRect,l=n._szClient,s=n.topLeftCells,a=n._eTL,c=n.headersVisibility,u=t.HeadersVisibility,d=c&u.Row?s.columns.getTotalSize():0,h=c&u.Column?s.rows.getTotalSize():0,g=c&u.Column?h+a.offsetTop:0,f=n._eBL,p=f.offsetHeight;o.x-=r.left;o.y-=r.top;n.rightToLeft&&(o.x=r.width-o.x);this._p||o.x>=0&&o.y>=a.offsetTop&&l&&o.x<=l.width+d&&o.y<=l.height+h&&(o.y<g?this._p=o.x<d?n.topLeftCells:n.columnHeaders:o.y<f.offsetTop?this._p=o.x<d?n.rowHeaders:n.cells:this._p=o.x<d?n.bottomLeftCells:n.columnFooters);if(null!=this._p){var _=this._p.rows,w=this._p.columns,m=this._p.cellType,C=t.CellType,y=this._p._getFrozenPos(),v=m==C.TopLeft||m==C.ColumnHeader?h:m==C.BottomLeft||m==C.ColumnFooter?p:_.getTotalSize(),b=m==C.TopLeft||m==C.BottomLeft||m==C.RowHeader?d:w.getTotalSize();if(m==C.RowHeader||m==C.Cell){o.y-=h;if(o.y>y.y||y.y<=0){o.y-=n._ptScrl.y;o.y+=this._p._getOffsetY()}}else m!=C.BottomLeft&&m!=C.ColumnFooter||(o.y-=f.offsetTop);if(m==C.ColumnHeader||m==C.Cell||m==C.ColumnFooter){o.x-=d;(o.x>y.x||y.x<=0)&&(o.x-=n._ptScrl.x)}m!=C.ColumnHeader&&m!=C.TopLeft||(o.y-=g-h);this._edge=0;var R=HitTestInfo._SZEDGE[this._g.isTouching?1:0];if(this._g.isTouching){R=HitTestInfo._SZEDGE[1];o.x-=R/2}this._row=o.y>v?-1:_.getItemAt(o.y);this._col=o.x>b?-1:w.getItemAt(o.x);if(this._row<0||this._col<0){this._p=null;return}if(this._col>-1){var x=w[this._col];o.x-x.pos<=R&&(this._edge|=1);x.pos+x.renderSize-o.x<=R&&(this._edge|=4)}if(this._row>-1){var S=_[this._row];o.y-S.pos<=R&&(this._edge|=2);S.pos+S.renderSize-o.y<=R&&(this._edge|=8)}}}else{var E=e.closest(i,".wj-cell"),H=E?E[t.GridPanel._INDEX_KEY]:null;if(H){this._row=H.row;this._col=H.col;this._rng=H.rng;this._p=H.panel;this._g=H.panel.grid}}}Object.defineProperty(HitTestInfo.prototype,"point",{get:function(){return this._pt},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"cellType",{get:function(){return this._p?this._p.cellType:t.CellType.None},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"panel",{get:function(){return this._p},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"grid",{get:function(){return this._p?this._p.grid:null},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"col",{get:function(){return this._col},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"range",{get:function(){this._rng||(this._rng=new t.CellRange(this._row,this._col));return this._rng},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"edgeLeft",{get:function(){return 0!=(1&this._edge)},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"edgeTop",{get:function(){return 0!=(2&this._edge)},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"edgeRight",{get:function(){return 0!=(4&this._edge)},enumerable:!0,configurable:!0});Object.defineProperty(HitTestInfo.prototype,"edgeBottom",{get:function(){return 0!=(8&this._edge)},enumerable:!0,configurable:!0});HitTestInfo._SZEDGE=[5,30];return HitTestInfo}();t.HitTestInfo=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){t.softInput=function softInput(){return e._getModule("wijmo.input")}}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i=function(){function CellFactory(){}CellFactory.prototype.updateCell=function(i,o,n,r,l,s){var a=i.grid,c=a.rightToLeft,u=t.CellType,d=i.rows,h=i.columns,g=d[o],f=h[n],p=o,_=n,w=g instanceof t.GroupRow?g:null,m=g instanceof t._NewRowTemplate?g:null,C=f.renderWidth,y=g.renderHeight,v=i.cellType,b="wj-cell",R="",x={display:""};0!=s&&r.firstElementChild&&(1==r.childNodes.length&&"checkbox"==r.firstElementChild.type||(r.textContent=""));if(l&&!l.isSingleCell){o=l.row;n=l.col;p=l.row2;_=l.col2;g=d[o];f=h[n];w=g instanceof t.GroupRow?g:null;var S=l.getRenderSize(i);y=S.height;C=S.width}var E=a._getBindingColumn(i,o,f),H=E.dataType||g.dataType,z=E.dataMap||g.dataMap,M=H==e.DataType.Boolean&&!z,F=f.pos,T=g.pos;if(a._useFrozenDiv()&&v==u.Cell&&!a.editRange){n<h.frozen&&p>=d.frozen&&(T+=a._ptScrl.y);o<d.frozen&&_>=h.frozen&&(F+=a._ptScrl.x)}else{p<d.frozen&&(T-=a._ptScrl.y);_<h.frozen&&(F-=a._ptScrl.x)}c?x.right=F+"px":x.left=F+"px";p>=d.frozen&&(T-=i._getOffsetY());x.top=T+"px";x.width=C+"px";x.height=y+"px";x.zIndex="";(o<d.frozen||n<h.frozen)&&(x.zIndex=o<d.frozen&&n<h.frozen?2:1);var P=!1,G=a.alternatingRowStep;if(G&&(!l||l.row==l.row2)){P=g.visibleIndex%(G+1)==0;1==G&&(P=!P)}if(v==u.Cell){w&&(b+=" wj-group");P&&(b+=" wj-alt");(o<d.frozen||n<h.frozen)&&(b+=" wj-frozen");m&&(b+=" wj-new");g.cssClass&&(b+=" "+g.cssClass);E.cssClass&&(b+=" "+E.cssClass)}else{b+=" wj-header";P&&(b+=" wj-header-alt")}g.cssClassAll&&(b+=" "+g.cssClassAll);E.cssClassAll&&(b+=" "+E.cssClassAll);var I=t.SelectedState,A=i.getSelectedState(o,n,l);A!=I.None&&v==u.Cell&&!M&&a.editRange&&a.editRange.contains(o,n)&&(A=I.None);switch(A){case I.Active:b+=" wj-state-active";break;case I.Cursor:b+=" wj-state-selected wj-state-active";break;case I.Selected:b+=" wj-state-multi-selected"}p==d._lastFrozen&&(b+=" wj-frozen-row");_==h._lastFrozen&&(b+=" wj-frozen-col");(E.wordWrap||g.wordWrap)&&(b+=" wj-wrap");(E.multiLine||g.multiLine)&&(b+=" wj-multiline");var j=E.getAlignment(g);j&&(R=" wj-align-"+j);var D=v==u.ColumnHeader&&a._hasColumnGroups()?a._getColumnGroup(o,n):null;D&&D.align&&(R=" wj-align-"+D.align);x.paddingLeft=x.paddingRight=x.paddingTop=x.paddingBottom="";if(v==u.Cell&&a.rows.maxGroupLevel>-1&&n==h.firstVisibleIndex&&a.treeIndent){var L=w?Math.max(0,w.level):d.maxGroupLevel+1,O=Math.min(a.treeIndent*L+a._cellPadLeft,C-a._cellPadHorz)+"px";c?x.paddingRight=O:x.paddingLeft=O}if(0!=s){var N=i.getCellData(o,n,!1),B=i.getCellData(o,n,!0);if(v==u.Cell&&n==h.firstVisibleIndex&&w&&w.hasChildren&&!this._isEditingCell(a,o,n)){var k=this._getTreeBtn(w);B=e.escapeHtml(B)||w.getGroupHeader();r.innerHTML=k.outerHTML+" "+B;R=""}else if(v!=u.ColumnHeader||p!=a._getSortRowIndex()&&E==f)if(v!=u.RowHeader||n!=a._getEditColumnIndex()||B)if(v!=u.Cell||H!=e.DataType.Boolean||z||w&&!e.isBoolean(N))if(v==u.Cell&&this._isEditingCell(a,o,n)){var V=E.inputType||g.inputType;V||(V=H!=e.DataType.Number||z?"text":"tel");if(!z&&!E.mask&&!g.mask){var K=i.getCellData(o,n,!1);if(e.isNumber(K)){var W=E.format||g.format,q=K.toString();if(W&&K!=Math.round(K)){var U=q.indexOf("e")<0?q.match(/\.(\d+)/)[1].length:20;W=W.replace(/([a-z])(\d*)(.*)/gi,"$01"+U+"$3")}B=e.Globalize.formatNumber(K,W,!0)}}r.innerHTML=(E.multiLine||g.multiLine)&&"checkbox"!=V?'<textarea wrap="soft"></textarea>':'<input type="'+V+'"/>';var Y=r.children[0];e.addClass(Y,"wj-grid-editor wj-form-control");e.disableAutoComplete(Y);Y.value=E.isContentHtml||g.isContentHtml?e.toPlainText(B):B;Y.tabIndex=-1;Y.required=E.getIsRequired(g);e.setAttribute(Y,"aria-required",Y.required);var J=E.maxLength||g.maxLength;J&&(Y.maxLength=J);Y.style.textAlign=E.getAlignment(g);var X=E.mask||g.mask;X&&new e._MaskProvider(Y,X);a._edtHdl._edt=Y}else{var Q=v!=u.Cell||w?null:E._tpl;if(Q){var Z=CellFactory._tplCtx;Z.value=N;Z.text=B;Z.item=g.dataItem;Z.row=g;Z.col=E;r.innerHTML=e.isString(Q)?e.evalTemplate(Q,Z):Q(Z)}else v==u.Cell&&(g.isContentHtml||E.isContentHtml)?r.innerHTML=B:r.textContent=B||"";if(D&&D.collapseTo){var $=D._rng;if($&&$.columnSpan>1){var ee=D.isCollapsed;r.innerHTML='<div role="button" class="'+CellFactory._WJC_COLLAPSE+'"><span class="wj-glyph-'+(ee?"plus":"minus")+'"></span></div>&nbsp;'+r.innerHTML;ee&&e.addClass(r,"wj-state-collapsed")}}}else{var te=r.firstChild;if(!(te instanceof HTMLInputElement)||"checkbox"!=te.type){r.innerHTML='<input type="checkbox" class="wj-cell-check" tabindex="-1"/>';te=r.firstChild}te.checked=1==N;te.indeterminate=null==N;te.disabled=!a.canEditCell(o,n);te.disabled&&(te.style.cursor="default");a.editRange&&a.editRange.contains(o,n)&&(a._edtHdl._edt=te)}else{var ie=a.editableCollectionView,oe=ie?ie.currentEditItem:null;oe&&g.dataItem==oe?r.innerHTML='<span class="wj-glyph-pencil"></span>':g instanceof t._NewRowTemplate&&(r.innerHTML='<span class="wj-glyph-asterisk"></span>')}else{r.innerHTML=e.escapeHtml(B);var ne=E.currentSort;if(ne&&a.showSort){b+=" wj-sort-"+("+"==ne?"asc":"desc");r.innerHTML+="&nbsp;"+this._getSortIcon(E)}a.allowPinning&&e.contains(a.hostElement,r)&&this._addPinButton(r,n<a.frozenColumns)}if(v==u.Cell&&z&&t.softInput()&&a.showDropDown&&a.canEditCell(o,n)&&(E.dataMap&&0!=E.showDropDown||g.dataMap&&0!=g.showDropDown)){if(!CellFactory._ddBtn){var re=CellFactory._WJC_DROPDOWN;k=e.createElement('<button class="wj-btn wj-btn-glyph wj-right '+re+'" type="button" tabindex="-1"><span class="wj-glyph-down"></span></button>');e.setAriaLabel(k,e.culture.FlexGrid.ariaLabels.toggleDropDown);e.setAttribute(k,"aria-expanded",!1);CellFactory._ddBtn=k}var le=CellFactory._ddBtn.cloneNode(!0);r.insertBefore(le,r.firstChild);this._isEditingCell(a,o,n)&&(b+=" wj-hasdropdown")}}if(v==u.RowHeader||v==u.ColumnHeader){var se=v==u.RowHeader?!w&&!m&&g.allowDragging&&0!=(a.allowDragging&t.AllowDragging.Rows):f.allowDragging&&0!=(a.allowDragging&t.AllowDragging.Columns);e.setAttribute(r,"draggable",se?"true":null)}b+=R;r.className!=b&&(r.className=b);var ae=r.style;for(var ce in x)ae[ce]!==x[ce]&&(ae[ce]=x[ce]);if(a._edtHdl._edt&&a._edtHdl._edt.parentElement==r){var ue=a._root,de=ue.getBoundingClientRect(),he=r.getBoundingClientRect(),ge=de.top+ue.clientHeight-he.top,fe=de.left+ue.clientWidth-he.left;he.height>ge&&(r.style.height=ge+"px");he.width>fe&&(r.style.width=fe+"px")}if((v==u.Cell||v==u.RowHeader)&&a._getShowErrors()){var pe=a._getError(i,o,n);a._edtHdl._setCellError(r,pe)}a.itemFormatter&&a.itemFormatter(i,o,n,r);if(a.formatItem.hasHandlers){var _e=CellFactory._fmtRng;_e?_e.setRange(o,n,p,_):_e=CellFactory._fmtRng=new t.CellRange(o,n,p,_);var we=new t.FormatItemEventArgs(i,_e,r);a.onFormatItem(we)}};CellFactory.prototype.disposeCell=function(e){};CellFactory.prototype.getEditorValue=function(t){var i=t._edtHdl._edt;if(i instanceof HTMLInputElement&&"checkbox"==i.type)return i.checked;if(i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement){var o=i.value,n=i.maxLength;e.isNumber(n)&&n>-1&&o.length>n&&(o=o.substr(0,n));return o}return null};CellFactory.prototype._isEditingCell=function(e,t,i){return e.editRange&&e.editRange.contains(t,i)};CellFactory.prototype._getTreeBtn=function(t){var i=CellFactory._WJC_COLLAPSE,o=(t.isCollapsed?"":"down-")+(t.grid.rightToLeft?"left":"right"),n=e.createElement('<button class="wj-btn wj-btn-glyph '+i+'" type="button" tabindex="-1"><span class="wj-glyph-'+o+'"></span></button>');e.setAriaLabel(n,e.culture.FlexGrid.ariaLabels.toggleGroup);e.setAttribute(n,"aria-expanded",!t.isCollapsed);return n};CellFactory.prototype._getSortIcon=function(e){var t='<span class="wj-glyph-'+("+"==e.currentSort?"up":"down")+'"></span>',i=e.grid.collectionView;if(i&&i.sortDescriptions.length>1){var o=e.currentSortIndex;o>-1&&(t+='<span class="wj-sort-index">'+(o+1)+"</span>")}return t};CellFactory.prototype._addPinButton=function(t,i){var o=CellFactory._WJC_PIN,n=e.createElement('<button class="wj-btn wj-btn-glyph wj-right '+o+'" type="button" tabindex="-1"><span class="wj-glyph-pin"></span></button>');e.toggleClass(n,"wj-state-pinned",i);e.setAttribute(n,"aria-pressed",i);t.insertBefore(n,t.firstChild)};CellFactory._WJC_COLLAPSE="wj-elem-collapse";CellFactory._WJC_DROPDOWN="wj-elem-dropdown";CellFactory._WJC_PIN="wj-elem-pin";CellFactory._tplCtx={row:null,col:null,value:null,text:null,item:null};return CellFactory}();t.CellFactory=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i=function(){function _EditHandler(i){var o=this;this._fullEdit=!1;this._list=null;this._g=i;this._evtInput=document.createEvent("HTMLEvents");this._evtInput.initEvent("input",!0,!1);this._evtChange=document.createEvent("HTMLEvents");this._evtChange.initEvent("change",!0,!1);i.selectionChanging.addHandler((function(e,t){if(o.finishEditing()){var n=i._selHdl.selection.row;if(n!=t.row){var r=i.rows.length;(n>-1&&n<r?i.rows[n].dataItem:null)!=(t.row>-1&&t.row<r?i.rows[t.row].dataItem:null)&&o._commitRowEdits()}}else t.cancel=!0}));i.lostFocus.addHandler((function(){var t=e.getActiveElement();t&&"fixed"==getComputedStyle(t).position?o.finishEditing():o._commitRowEdits()}));var n=i.hostElement;i.addEventListener(n,"mousedown",(function(n){if(!n.defaultPrevented&&0==n.button&&!i._mouseHdl._szRowCol){i.selection;var r=i.hitTest(n);if(r.cellType!=t.CellType.Cell&&r.cellType!=t.CellType.None)o.finishEditing();else if(r.cellType!=t.CellType.None){var l=e.tryCast(n.target,HTMLInputElement);if(o._isNativeCheckbox(l)){if(l!=o.activeEditor){n.preventDefault();l=o.startEditing(!1,r.row,r.col,!0,n)?o.activeEditor:null}if(l&&"checkbox"==l.type&&!l.disabled&&!l.readOnly){l.checked=!l.checked;var s=i._eFocus;s.tabIndex=0;s.focus();o.finishEditing()}}}}}),!0);i.addEventListener(n,"click",(function(e){if(o._isNativeCheckbox(e.target)){e.preventDefault();e.stopImmediatePropagation()}}),!0);i.addEventListener(n,"compositionend",this._keypress.bind(this))}_EditHandler.prototype.startEditing=function(i,o,n,r,l){void 0===i&&(i=!0);var s=this._g,a=s._selHdl.selection;o=e.asNumber(o,!0,!0);n=e.asNumber(n,!0,!0);null==o&&(o=a.row);null==n&&(n=a.col);null==r&&(r=!0);if(!this._allowEditing(o,n))return!1;var c=s.getMergedRange(s.cells,o,n,!1);c||(c=new t.CellRange(o,n));var u=s.rows[o].dataItem;s.scrollIntoView(c.row,c.col,!0);if(!s.select(c,!0))return!1;if(!s.rows[o]||u!=s.rows[o].dataItem)return!1;if(c.equals(this._rng))return!0;if(this.activeEditor&&!this.finishEditing())return!1;var d=new t.CellRangeEventArgs(s.cells,c,l);if(!s.onBeginningEdit(d))return!1;var h=s.editableCollectionView,g=!1;if(h){(g=(u=s.rows[o].dataItem)!=h.currentEditItem)&&s.onRowEditStarting(d);h.editItem(u);if(g){s.onRowEditStarted(d);this._edItem=u}}this._fullEdit=e.asBoolean(i);this._rng=c;this._list=null;var f=s.rows[o],p=s._getBindingColumn(s.cells,o,s.columns[n]),_=p.dataMap||f.dataMap;if(_){var w=_.getDisplayValues(u);(p.isContentHtml||f.isContentHtml)&&(w=w.map((function(t){return e.toPlainText(t)})));this._list=w}c.isSingleCell?this._updateEditorCell(o,n,g):s.refresh(!1);var m=this._edt;if(m){if("checkbox"==m.type)this._fullEdit=!1;else if(r){var C=0,y=m.value.length,v=!1,b=e.culture.Globalize.numberFormat["%"]||"%",R=s.getCellData(o,n,!1);e.isNumber(R)?v=m.value.indexOf(b)>-1:null==R&&(v=/^p/i.test(p.format))&&m.value.indexOf(b)<0&&(m.value+=b);if(v){var x=m.value;C=0;y=x.length;for(;y>0&&(x[y-1]==b||" "==x[y-1]);)y--;for(;C<y&&x[C]==b;)C++}l&&"keydown"==l.type&&l.keyCode==e.Key.Space&&(C=y);e.setSelectionRange(m,C,y);e.isIE()&&"right"==m.style.textAlign&&(m.style.paddingRight="1px")}s.onPrepareCellForEdit(d)}return null!=m&&!m.disabled&&!m.readOnly};_EditHandler.prototype.finishEditing=function(i){var o=this._edt;if(!o){this._removeListBox();return!0}var n=this._g,r=this._rng,l=new t.CellEditEndingEventArgs(n.cells,r),s=n.containsFocus(),a=n.hostElement.querySelector(".wj-control.wj-state-focused");if(a){var c=e.Control.getControl(a);c&&c.onLostFocus(l)}l.cancel=i;if(!i&&n.validateEdits){var u=this._getValidationError();if(u){l.cancel=!0;var d=e.closest(o,".wj-cell");if(d){this._setCellError(d,u);l.stayInEditMode=!0}}}if(!n.onCellEditEnding(l)&&l.stayInEditMode){s?setTimeout((function(){o.select()})):o.select();this._fullEdit=!0;return!1}if(!l.cancel){l.data=n.cells.getCellData(r.topRow,r.leftCol,!1);for(var h=n.cellFactory.getEditorValue(n),g=r.topRow;g<=r.bottomRow&&g<n.rows.length;g++)for(var f=r.leftCol;f<=r.rightCol&&f<n.columns.length;f++)n.cells.setCellData(g,f,h,!0,!1);o.value==this._edtValue&&o.dispatchEvent(this._evtChange)}this._edt=null;this._rng=null;this._list=null;this._edtValue=null;this._removeListBox();var p=e.closest(o,".wj-cell");e.contains(p,e.getActiveElement())&&p.focus();!l.cancel&&l.refresh&&n._refreshOnEdit?n.refresh(!1):this._updateEditorCell(r.row,r.col,!1);s&&n.focus();n.onCellEditEnded(l);return!0};_EditHandler.prototype._setCellError=function(t,i){""==i&&(i=null);e.toggleClass(t,"wj-state-invalid",null!=i);var o=this._g.errorTip;o?o.setTooltip(t,i):e.setAttribute(t,"title",i)};Object.defineProperty(_EditHandler.prototype,"activeEditor",{get:function(){return this._edt},enumerable:!0,configurable:!0});Object.defineProperty(_EditHandler.prototype,"editRange",{get:function(){return this._rng},enumerable:!0,configurable:!0});_EditHandler.prototype.getClipString=function(e,i,o,n){var r,l=this,s=this._g,a=[],c=t.SelectionMode,u=0!=(i&t.ClipStringOptions.CSV),d=u?"\r\n":"\n",h=u?",":"\t",g=0!=(i&t.ClipStringOptions.InvisibleRows);if(!e){e=s.selection;switch(s.selectionMode){case c.Row:case c.RowRange:case c.ListBox:e.col=0;e.col2=s.columns.length-1;break;case c.MultiRange:var f=s.selectedRanges;if(f.length>1){var p=this._sameCols(f),_=this._sameRows(f);if(p||_){(f=f.slice()).sort((function(e,t){var i=e.topRow-t.topRow;return i||e.leftCol-t.leftCol}));if(p){var w=[];f.forEach((function(e){w.push(l.getClipString(e,i,o,n));o=!1}));return w.join(d)}if(_){var m;f.forEach((function(e){var t=l.getClipString(e,i,o,n).split(d);if(null==m){m=t;n=!1}else t.forEach((function(e,t){m[t]+=h+e}))}));return m.join(d)}}}}}o&&(r=s.columnHeaders).rows.forEach((function(t,o){if(g||t.isVisible){var s=l._getRowClipString(r,o,e,i,n);a.push(s)}}));r=s.cells;if(s.selectionMode==c.ListBox)r.rows.forEach((function(t,o){if(t.isSelected&&(g||t.isVisible)){var s=l._getRowClipString(r,o,e,i,n);a.push(s)}}));else for(var C=e.topRow;C<=e.bottomRow;C++)if(g||r.rows[C].isVisible){var y=this._getRowClipString(r,C,e,i,n);a.push(y)}return a.join(d)};_EditHandler.prototype._getRowClipString=function(i,o,n,r,l){var s=[],a=i.rows[o],c=t.ClipStringOptions,u=0!=(r&c.CSV),d=0!=(r&c.InvisibleColumns),h=0==(r&c.Unformatted),g=0!=(r&c.SkipMerged);if(a.isVisible){if(l)for(var f=i.cellType==t.CellType.ColumnHeader?i.grid.topLeftCells:i.grid.rowHeaders,p=0;p<f.columns.length;p++)if(d||f.columns[p].isVisible){var _=f.getCellData(o,p,!0);g&&this._skipMergedCell(i,n,o,p)&&(_="");s.push(this._getCellClipString(_,r))}for(p=n.leftCol;p<=n.rightCol;p++)if(d||i.columns[p].isVisible){!(_=i.getCellData(o,p,h))&&a instanceof t.GroupRow&&p==i.columns.firstVisibleIndex&&(_=e.toPlainText(a.getGroupHeader()));g&&this._skipMergedCell(i,n,o,p)&&(_="");s.push(this._getCellClipString(_,r))}}return s.join(u?",":"\t")};_EditHandler.prototype._skipMergedCell=function(e,t,i,o){var n=e.grid.getMergedRange(e,i,o,!1);if(n){if(t){n.row=Math.max(t.topRow,n.row);n.col=Math.max(t.leftCol,n.col)}if(n.row!=i||n.col!=o)return!0}return!1};_EditHandler.prototype._getCellClipString=function(i,o){e.isString(i)||(i=e.isDate(i)?i.toJSON():null!=i?i.toString():"");i=i.replace(/\t/g," ");var n=0!=(o&t.ClipStringOptions.QuoteAll);(n=n||/\n|^"|"$/.test(i))||0==(o&t.ClipStringOptions.CSV)||(n=i.indexOf(",")>-1);n&&(i='"'+(i=i.replace(/"/g,'""'))+'"');return i};_EditHandler.prototype._sameRows=function(e){for(var t=e[0],i=1;i<e.length;i++)if(e[i].topRow!=t.topRow||e[i].bottomRow!=t.bottomRow)return!1;return!0};_EditHandler.prototype._sameCols=function(e){for(var t=e[0],i=1;i<e.length;i++)if(e[i].leftCol!=t.leftCol||e[i].rightCol!=t.rightCol)return!1;return!0};_EditHandler.prototype.setClipString=function(i,o){var n=this,r=this._g,l=null==o,s=t.SelectionMode;if(!o){o=r.selection;switch(r.selectionMode){case s.Row:case s.RowRange:case s.ListBox:o.col=0;o.col2=r.columns.length-1}}o=e.asType(o,t.CellRange);var a=this._parseClipString(e.asString(i));l&&!o.isSingleCell&&a.length&&this._expandClipRows(a,o);var c=new t.CellRange(o.topRow,o.leftCol,o.topRow+a.length-1,o.leftCol+a[0].length-1),u=new t.CellRangeEventArgs(r.cells,c,i);if(!r.onPasting(u))return!1;c=new t.CellRange(o.topRow,o.leftCol);var d=r.editableCollectionView,h=!1,g=o.topRow;r.deferUpdate((function(){d&&a.length>1&&d.beginUpdate();for(var i=0;i<a.length&&g<r.rows.length;i++,g++){var l=r.rows[g];if(l.isVisible){for(var s=a[i],f=o.leftCol,p=0;p<s.length&&f<r.columns.length;p++,f++){var _=r.columns[f];if(_.isVisible){if(n._allowEditing(g,f)){var w=s[p],m=_.maxLength||l.maxLength;m&&(w=w.substr(0,m));var C=new t.CellRangeEventArgs(r.cells,new t.CellRange(g,f),w);if(r.onPastingCell(C)){if(d){d.editItem(r.rows[g].dataItem);n._edItem=d.currentEditItem}if(r.cells.setCellData(g,f,C.data)){r.onPastedCell(C);h=!0}}c.row2=Math.max(c.row2,g);c.col2=Math.max(c.col2,f)}}else p--}if(n._edItem&&d instanceof e.collections.CollectionView){var y=new e.collections.NotifyCollectionChangedEventArgs(e.collections.NotifyCollectionChangedAction.Change,n._edItem,g);d.onCollectionChanged(y)}}else i--}if(d&&a.length>1){c.rowSpan>1&&d.commitEdit();d.endUpdate(!1)}r.select(c);r.onPasted(u);if(h&&e.closest(r.hostElement,"form")){var v=document.createEvent("HTMLEvents"),b=e.createElement("<input>",r.hostElement);v.initEvent("change",!0,!1);b.dispatchEvent(v);e.removeChild(b)}}))};_EditHandler.prototype._isNativeCheckbox=function(t){return t instanceof HTMLInputElement&&"checkbox"==t.type&&!t.disabled&&!t.readOnly&&e.hasClass(t,"wj-cell-check")&&e.closest(t,".wj-flexgrid")==this._g.hostElement};_EditHandler.prototype._parseClipString=function(e){var t=[];e=(e=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")).replace(/\n$/,"");var i=0,o=0;for(i=0;i<e.length;i++){var n='"'==e[i],r=!1,l=!1;for(o=i;o<e.length&&!l;o++){var s=e[o];switch(s){case'"':n&&(r=!r);break;case"\t":case"\n":if(!r){this._parseClipCell(t,e,i,o,"\n"==s);i=o;l=!0}}}if(o==e.length){this._parseClipCell(t,e,i,o,!1);break}}0==t.length&&t.push([""]);return t};_EditHandler.prototype._parseClipCell=function(e,t,i,o,n){e.length||e.push([]);var r=t.substr(i,o-i),l=r.length;l>1&&'"'==r[0]&&'"'==r[l-1]?r=(r=r.substr(1,l-2)).replace(/""/g,'"'):"\t"==r&&(r="");e[e.length-1].push(r);n&&e.push([])};_EditHandler.prototype._expandClipRows=function(e,t){for(var i=e.length,o=0,n=0;n<i;n++)o=Math.max(o,e[n].length);for(var r=this._g,l=0,s=0,a=t.topRow;a<=t.bottomRow;a++)r.rows[a].isVisible&&l++;for(var c=t.leftCol;c<=t.rightCol;c++)r.columns[c].isVisible&&s++;if(l>1||s>1){1==l&&(l=i);1==s&&(s=o);if(s%o==0&&l%i==0){for(c=o;c<s;c++)for(a=0;a<i;a++)e[a].push(e[a%i][c%o]);for(a=i;a<l;a++)e.push(e[a%i])}}};_EditHandler.prototype._updateEditorCell=function(i,o,n){var r=this._g,l=r.cells.getCellElement(i,o),s=r._useFrozenDiv()&&(i<r.frozenRows||o<r.frozenColumns);if(!l||s||r._hasPendingUpdates())r.refresh(!1);else if(r.onUpdatingView(new e.CancelEventArgs)){this._updateCell(l);if((n=n||r._getHasValidation())&&r.headersVisibility&t.HeadersVisibility.Row){var a=r.rowHeaders,c=r._getEditColumnIndex(),u=a.getCellElement(i,c);u&&this._updateCell(u)}r.onUpdatedView()}};_EditHandler.prototype._updateCell=function(i){var o=new t.HitTestInfo(i,null),n=t.FlexGrid._WJS_UPDATING;if(o.panel){e.addClass(i,n);o.grid.cellFactory.updateCell(o.panel,o.row,o.col,i,o.range);e.removeClass(i,n)}};_EditHandler.prototype._getValidationError=function(){var e=this._g;if(e._getHasValidation()){var t=this._rng.row,i=this._rng.col,o=e.cellFactory.getEditorValue(e),n=e.getCellData(t,i,!1);if(e.setCellData(t,i,o,!0,!1)){var r=e._getError(e.cells,t,i);e.setCellData(t,i,n,!1,!1);return r}}return null};_EditHandler.prototype._allowEditing=function(e,i){var o=this._g;if(o.isReadOnly||o.selectionMode==t.SelectionMode.None)return!1;if(e<0||e>=o.rows.length||i<0||i>=o.columns.length)return!1;var n=o.rows[e];if(!n||n.isReadOnly||!n.isVisible)return!1;var r=o._getBindingColumn(o.cells,e,o.columns[i]);return!(!r||r.isReadOnly||!r.isVisible)};_EditHandler.prototype._commitRowEdits=function(){var e=this._g;if(this.finishEditing()&&this._edItem){var i=e.editableCollectionView;if(i&&(i.currentEditItem||i.currentAddItem)){var o=new t.CellRangeEventArgs(e.cells,e.selection);e.onRowEditEnding(o);i.commitEdit();e.onRowEditEnded(o)}this._edItem=null}};_EditHandler.prototype._keydown=function(t){var i=this._edt;switch(t.keyCode){case e.Key.F2:this._fullEdit=!this._fullEdit;t.preventDefault();return!0;case e.Key.F4:this._toggleListBox(t);t.preventDefault();return!0;case e.Key.Space:if(i&&"checkbox"==i.type&&!i.disabled&&!i.readOnly){i.checked=!i.checked;this.finishEditing();t.preventDefault()}return!0;case e.Key.Enter:t.preventDefault();if(i&&t.altKey){var o=t.target;if(o instanceof HTMLTextAreaElement&&"soft"==o.wrap){var n=o.value,r=o.selectionStart,l=o.selectionEnd;o.value=n.substr(0,r)+"\n"+n.substr(l);e.setSelectionRange(o,r+1)}return!0}return!this.finishEditing();case e.Key.Tab:t.preventDefault();return!this.finishEditing();case e.Key.Escape:t.preventDefault();this.finishEditing(!0);return!0;case e.Key.Up:case e.Key.Down:case e.Key.Left:case e.Key.Right:case e.Key.PageUp:case e.Key.PageDown:case e.Key.Home:case e.Key.End:if(this._lbx)return this._keydownListBox(t);if(t.altKey)switch(t.keyCode){case e.Key.Up:case e.Key.Down:this._toggleListBox(t);t.preventDefault();return!0}if(!this._fullEdit&&this.finishEditing())return!1}return!0};_EditHandler.prototype._keydownListBox=function(t){var i=!0;if(this._lbx)switch(t.keyCode){case e.Key.Up:t.altKey?this._toggleListBox(t):this._lbx.selectedIndex>0&&this._lbx.selectedIndex--;break;case e.Key.Down:t.altKey?this._toggleListBox(t):this._lbx.selectedIndex++;break;case e.Key.Home:case e.Key.PageUp:this._lbx.selectedIndex=0;break;case e.Key.End:case e.Key.PageDown:this._lbx.selectedIndex=this._lbx.collectionView.items.length-1;break;default:i=!1}if(i){t.preventDefault();return!0}return!1};_EditHandler.prototype._keypress=function(t){var i=this._edt,o=t.charCode||32;if(i&&"checkbox"!=i.type&&e.getActiveElement()==i&&this._list&&this._list.length>0&&o>=32){var n=i.selectionStart,r=i.value.substr(0,n);if(t.target==i&&t.charCode){r+=String.fromCharCode(t.charCode);n++}var l=this._findString(this._list,r,!0);l<0&&(l=this._findString(this._list,r,!1));if(l>-1){i.value=this._list[l];e.setSelectionRange(i,n,i.value.length);i.dispatchEvent(this._evtInput);t.preventDefault&&t.preventDefault()}}};_EditHandler.prototype._findString=function(e,t,i){i||(t=t.toLowerCase());for(var o=0;o<e.length;o++){var n=e[o];if(null!=n){n=n.toString();i||(n=n.toLowerCase());if(0==n.indexOf(t))return o}}return-1};_EditHandler.prototype._toggleListBox=function(e,i){var o=this._g,n=o._selHdl.selection,r=o.isTouching;i||(i=n);if(this._lbx){this._removeListBox();if(n.contains(i)){o.activeEditor?o.activeEditor.focus():o.containsFocus()||o.focus();return!0}}var l=o.rows[i.row],s=o._getBindingColumn(o.cells,i.row,o.columns[i.col]),a=s.dataMap&&0!=s.showDropDown||l.dataMap&&0!=l.showDropDown;if(!t.softInput()||!a)return!1;if(!t.softInput()||!this.startEditing(!0,i.row,i.col,!r,e))return!1;this._lbx=this._createListBox();this._lbx.showSelection();r&&this._lbx.focus();return!0};_EditHandler.prototype._createListBox=function(){var i=this,o=this._g,n=o.activeEditor,r=this._rng,l=o.rows[r.row],s=o._getBindingColumn(o.cells,r.row,o.columns[r.col]),a=s.dataMap||l.dataMap,c=s.dropDownCssClass||l.dropDownCssClass,u=document.createElement("div");this._removeListBox();e.addClass(u,"wj-dropdown-panel wj-grid-listbox");e.addClass(u,c);var d=new e.input.ListBox(u,{maxHeight:4*l.renderHeight,isContentHtml:s.isContentHtml,itemsSource:a.getDisplayValues(l.dataItem),selectedValue:n?n.value:o.getCellData(r.row,r.col,!0)});d.addEventListener(d.hostElement,"click",(function(){i._removeListBox();o.focus();i.finishEditing()}));d.lostFocus.addHandler((function(){i._removeListBox()}));d.selectedIndexChanged.addHandler((function(){var t=o.activeEditor;if(t){t.value=i._list[d.selectedIndex];t.dispatchEvent(i._evtInput);e.setSelectionRange(t,0,t.value.length)}}));var h=o.cells.getCellElement(r.row,r.col);if(h){e.showPopup(u,h,!1,!1,!1);var g=h.querySelector("."+t.CellFactory._WJC_DROPDOWN);e.setAttribute(g,"aria-expanded",!0)}else{e.showPopup(u,o.getCellBoundingRect(r.row,r.col));u[e.Control._OWNR_KEY]=o.hostElement}return d};_EditHandler.prototype._removeListBox=function(){var t=this._lbx;if(t){this._lbx=null;e.hidePopup(t.hostElement,(function(){t.dispose()}))}};return _EditHandler}();t._EditHandler=i}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){"use strict";var i,o;!function(e){e[e.None=0]="None";e[e.Columns=1]="Columns";e[e.Rows=2]="Rows";e[e.Both=3]="Both";e[e.ColumnsAllCells=4|e.Columns]="ColumnsAllCells";e[e.RowsAllCells=4|e.Rows]="RowsAllCells";e[e.BothAllCells=4|e.Both]="BothAllCells"}(i=t.AllowResizing||(t.AllowResizing={}));!function(e){e[e.None=0]="None";e[e.Headers=1]="Headers";e[e.Cells=2]="Cells";e[e.Both=3]="Both"}(t.AutoSizeMode||(t.AutoSizeMode={}));!function(e){e[e.None=0]="None";e[e.Columns=1]="Columns";e[e.Rows=2]="Rows";e[e.Both=3]="Both"}(o=t.AllowDragging||(t.AllowDragging={}));var n=function(){function _MouseHandler(i){var o=this;this._tsLast=0;var n=i.hostElement,r=i.addEventListener.bind(i),l=i.removeEventListener.bind(i);this._g=i;this._dvMarker=e.createElement('<div class="wj-marker">&nbsp;</div>');r(n,"mousedown",(function(n){i._rcBounds=null;if(!n.defaultPrevented&&0==n.button){var s=n.target;if(!i.containsFocus()){var a=s instanceof HTMLElement&&s.tabIndex>-1?s:i._eFocus;i._setFocusNoScroll(a)}setTimeout((function(){n.defaultPrevented||i.focus()}));var c=e.closest(s,".wj-flexgrid");if(c&&c!=i.hostElement||!i.activeEditor&&i._isInputElement(s)){var u=i.hitTest(n),d=t.CellType;switch(u.cellType){case d.Cell:i.select(u.range,!1);s instanceof HTMLElement&&"root"!=s.getAttribute("wj-part")&&s.focus();break;case d.ColumnHeader:case d.ColumnFooter:i.scrollIntoView(-1,u.col);break;case d.RowHeader:i.scrollIntoView(u.row,-1)}return}var h=document;l(h,"mousemove");l(h,"mouseup");r(h,"mousemove",mouseMove);r(h,"mouseup",mouseUp);o._isDown=!0;o._mousedown(n)}}));var mouseMove=function(e){o._mousemove(e)},mouseUp=function(e){o._isDown=!1;l(document,"mousemove");l(document,"mouseup");o._mouseup(e)};r(n,"mouseup",(function(e){o._tsLast=Date.now()}));r(n,"mouseenter",(function(e){i._rcBounds=null}));r(n,"mousemove",this._hover.bind(this));r(n,"dblclick",this._dblclick.bind(this));r(n,"click",this._click.bind(this));r(n,"selectstart",(function(e){i._isInputElement(e.target)||e.preventDefault()}));r(n,"wheel",(function(t){if(!t.defaultPrevented&&t.deltaY&&!t.ctrlKey&&!t.metaKey){var o=i._root,n=t.deltaY,r=0;if(o.scrollHeight>o.offsetHeight&&e.closest(t.target,".wj-flexgrid")==i.hostElement){switch(t.deltaMode){case 1:r=i.rows.defaultSize*(n<0?-1:1);break;case 2:r=o.clientHeight*(n<0?-1:1);break;case 0:default:e.isSafari()&&(n=e.clamp(n,-150,150));r=n}i.focus();t.shiftKey?o.scrollLeft+=r:o.scrollTop+=r;t.preventDefault()}}}));r(n,"dragstart",this._dragstart.bind(this));r(n,"dragover",this._dragover.bind(this));r(n,"dragleave",this._dragover.bind(this));r(n,"drop",this._drop.bind(this));r(n,"dragend",this._dragend.bind(this));this._enableTouchResizing()}_MouseHandler.prototype.resetMouseState=function(){if(this._updating){this._updating=!1;this._g.endUpdate()}this._dragSrc&&e.removeClass(this._dragSrc,"wj-state-dragsrc");this._showDragMarker(null);var t=this._g.hostElement;t&&(t.style.cursor="");var i=this._g;i.removeEventListener(document,"mousemove");i.removeEventListener(document,"mouseup");this._tsLast=Date.now();this._eMouse=null;this._isDown=null;this._htDown=null;this._lbSelRows=null;this._szRowCol=null;this._szArgs=null;i._rcBounds=null};_MouseHandler.prototype._enableTouchResizing=function(){var t=this,i=this._g,o=i.hostElement,n="ontouchstart"in window?["touchstart","touchmove","touchend"]:"onpointerdown"in window?["pointerdown","pointermove","pointerup"]:null;if(n){i.addEventListener(o,n[0],(function(n){if((null==n.pointerType||"touch"==n.pointerType)&&!e.closest(n.target,".wj-elem-filter")){var r=e.closest(n.target,".wj-cell");if(r instanceof HTMLElement){i._rcBounds=null;t._htDown=null;t._hover(n);if(t._szRowCol){r.removeAttribute("draggable");o.style.touchAction="none";t._mousedown(n);n.preventDefault()}}}}));i.addEventListener(o,n[1],(function(e){if((null==e.pointerType||"touch"==e.pointerType)&&t._szRowCol){t._mousemove(e);e.preventDefault()}}));i.addEventListener(o,n[2],(function(i){if((null==i.pointerType||"touch"==i.pointerType)&&t._szRowCol){if(t._szArgs)t._finishResizing(t._eMouse);else{var n=e.closest(i.target,".wj-cell");n instanceof HTMLElement&&n.click()}t.resetMouseState();o.style.touchAction=""}}))}};_MouseHandler.prototype._mousedown=function(n){var r=this._g,l=r.hitTest(n),s=l.cellType,a=n.ctrlKey||n.metaKey,c=n.target,u=t.CellType;this._selDown=r.selection;if(l.panel==r.cells){if(e.closestClass(c,t.CellFactory._WJC_DROPDOWN)){r._edtHdl._toggleListBox(n,l.range);n.preventDefault();return}if(r.editRange&&r.editRange.contains(l.range))return}var d=e.getActiveElement();if(c!=d||!r._isInputElement(c))if(s!=u.None){this._htDown=l;this._eMouse=n;if(null==this._szRowCol){if(!(s==u.RowHeader&&l.edgeBottom&&r.allowResizing&i.Rows&&this._getResizeRow(l))){switch(s){case u.Cell:case u.RowHeader:a&&r.selectionMode==t.SelectionMode.ListBox&&this._startListBoxSelection(l.row);this._mouseSelect(n,n.shiftKey);if(s==u.RowHeader&&0==(r.allowDragging&o.Rows)){n.preventDefault();r.focus()}}if(s==u.Cell&&r.rows.maxGroupLevel>-1){var h=e.tryCast(r.rows[l.row],t.GroupRow),g=null!=e.closestClass(c,t.CellFactory._WJC_COLLAPSE);if(e.isIE9()&&r.showMarquee){var f=h?r.cells.getCellElement(l.row,l.col):null,p=f?f.querySelector("."+t.CellFactory._WJC_COLLAPSE):null,_=p?e.Rect.fromBoundingRect(p.getBoundingClientRect()):null,w=n.touches||n;g=_&&_.contains(new e.Point(w.clientX,w.clientY))}if(g){a?r.collapseGroupsToLevel(h.isCollapsed?h.level+1:h.level):h.isCollapsed=!h.isCollapsed;this.resetMouseState()}}}}else{if(d!=r._eFocus){r._eFocus.tabIndex=0;r._eFocus.focus()}this._handleResizing(n)}}else{r.finishEditing();c!=r._root&&c!=r._fCt&&r._edtHdl._commitRowEdits()}};_MouseHandler.prototype._mousemove=function(e){if(null!=this._htDown){if(0==e.buttons&&this._eMouse&&e.timeStamp-this._eMouse.timeStamp>600){this.resetMouseState();return}this._eMouse=e;if(this._szRowCol)this._handleResizing(e);else switch(this._htDown.cellType){case t.CellType.Cell:this._mouseSelect(e,!0);break;case t.CellType.RowHeader:0==(this._g.allowDragging&o.Rows)&&this._mouseSelect(e,!0)}}};_MouseHandler.prototype._mouseup=function(i){if(!this._g.isTouching||!(this._dragSrc||i.target instanceof HTMLHtmlElement)){var o=this._g,n=o.hitTest(i),r=this._htDown,l=t.SelectionMode;if(r&&!i.defaultPrevented)if(this._szArgs)this._finishResizing(i);else if(r.panel!=o.topLeftCells||this._szArgs){if(r.panel!=o.columnHeaders||i.dataTransfer)r.panel==o.cells&&(this._szRowCol||i.ctrlKey||i.metaKey||i.shiftKey||n.panel==r.panel&&n.range.equals(r.range)&&o.selection.equals(this._selDown)&&o._edtHdl.startEditing(!0,n.row,n.col,!0,i));else if(n.panel==r.panel&&n.col==r.col&&!n.edgeRight&&n.col>-1)if(o.allowPinning&&e.closestClass(i.target,t.CellFactory._WJC_PIN))this._clickPin(i,n);else if(e.closestClass(i.target,t.CellFactory._WJC_COLLAPSE)){var s=o._getColumnGroup(n.row,n.col);s&&(s.isCollapsed=!s.isCollapsed)}else this._clickSort(i,n)}else if(n.panel==r.panel&&n.row==r.row&&n.col==r.col&&o.rows.length&&o.columns.length)switch(o.selectionMode){case l.None:case l.Cell:break;default:o.selectAll()}this.resetMouseState()}};_MouseHandler.prototype._click=function(e){Date.now()-this._tsLast>50&&!e.pointerType&&this._handleClick(e)};_MouseHandler.prototype._handleClick=function(i){var o=this._g,n=i.target,r=new t.HitTestInfo(n,null),l=r.panel,s=t.SelectionMode;if(!i.defaultPrevented&&r.grid==o&&!o._isInputElement(n))if(l==o.topLeftCells)switch(o.selectionMode){case s.None:case s.Cell:break;default:o.rows.length&&o.columns.length&&o.select(new t.CellRange(0,0,o.rows.length-1,o.columns.length-1))}else if(l==o.columnHeaders)this._clickSort(i,r);else if(l==o.rowHeaders)switch(o.selectionMode){case s.None:case s.Cell:break;default:o.rows.length&&o.columns.length&&o.select(new t.CellRange(r.row,0,r.row,o.columns.length-1))}else if(l==o.cells)if(r.row<0)this._clickSort(i,r);else if(e.closestClass(n,t.CellFactory._WJC_COLLAPSE)){var a=o.rows[r.row];a instanceof t.GroupRow&&(i.ctrlKey?o.collapseGroupsToLevel(a.isCollapsed?a.level+1:a.level):a.isCollapsed=!a.isCollapsed)}else e.closestClass(n,t.CellFactory._WJC_DROPDOWN)?o._edtHdl._toggleListBox(i,r.range):o.select(r.range)};_MouseHandler.prototype._clickSort=function(i,o){var n=this._g,r=n.allowSorting,l=n.collectionView,s=l?l.sortDescriptions:null,a=i.ctrlKey||i.metaKey,c=i.shiftKey;if(l&&l.canSort&&r!=t.AllowSorting.None){o.row;var u=o.panel.columns[o.col],d=n._getBindingColumn(o.panel,o.row,u),h=d?d._getBindingSort():null;if(d.allowSorting&&h){if(u==d){var g=n.getMergedRange(o.panel,o.row,o.col,!1);if(g&&g.columnSpan>1)return}var f=new t.CellRangeEventArgs(o.panel,o.range,i);if(n.onSortingColumn(f)){n._edtHdl._commitRowEdits();for(var p=-1,_=0;_<s.length;_++)if(s[_].property==h){p=_;break}if(a&&c)s.clear();else if(p<0){r!=t.AllowSorting.MultiColumn&&s.clear();var w=new e.collections.SortDescription(h,!0);s.push(w)}else if(a)s.splice(p,1);else{w=new e.collections.SortDescription(h,!s[p].ascending);s.splice(p,1,w)}n.onSortedColumn(f)}}}};_MouseHandler.prototype._clickPin=function(e,t){var i=this._g,o=i.frozenColumns;if(t.col>=o){i.columns.moveElement(t.col,o,!0);i.frozenColumns++}else{i.columns.moveElement(t.col,o-1,!0);i.frozenColumns--}};_MouseHandler.prototype._dblclick=function(e){var o,n=this._g,r=n.hitTest(e),l=r.cellType,s=n.selection,a=r.range;if(!e.defaultPrevented)if(r.edgeRight&&n.allowResizing&i.Columns){if(l==t.CellType.ColumnHeader||l==t.CellType.Cell&&4&n.allowResizing){e.preventDefault();e.ctrlKey&&s.containsColumn(r.col)&&(a=s);for(var c=a.leftCol;c<=a.rightCol;c++)if(n.columns[c].allowResizing){o=new t.CellRangeEventArgs(n.cells,new t.CellRange(-1,c));if(n.onAutoSizingColumn(o)&&n.onResizingColumn(o)){n.autoSizeColumn(c);n.onResizedColumn(o);n.onAutoSizedColumn(o)}}}else if(l==t.CellType.TopLeft&&r.panel.columns[r.col].allowResizing){e.preventDefault();o=new t.CellRangeEventArgs(r.panel,new t.CellRange(-1,r.col));if(n.onAutoSizingColumn(o)&&n.onResizingColumn(o)){n.autoSizeColumn(r.col,!0);n.onAutoSizedColumn(o);n.onResizedColumn(o)}}this.resetMouseState()}else if(r.edgeBottom&&n.allowResizing&i.Rows){if(l==t.CellType.RowHeader||l==t.CellType.Cell&&4&n.allowResizing){e.ctrlKey&&s.containsRow(r.row)&&(a=s);for(var u=a.topRow;u<=a.bottomRow;u++)if(n.rows[u].allowResizing){o=new t.CellRangeEventArgs(n.cells,new t.CellRange(u,-1));if(n.onAutoSizingRow(o)&&n.onResizingRow(o)){n.autoSizeRow(u);n.onResizedRow(o);n.onAutoSizedRow(o)}}}else if(l==t.CellType.TopLeft&&r.panel.rows[r.row].allowResizing){o=new t.CellRangeEventArgs(r.panel,new t.CellRange(r.row,-1));if(n.onAutoSizingRow(o)&&n.onResizingRow(o)){n.autoSizeRow(r.row,!0);n.onResizedRow(o);n.onAutoSizedRow(o)}}this.resetMouseState()}else;};_MouseHandler.prototype._hover=function(e){if(!this._isDown){var o=this._g,n=o.hitTest(e),r=(n.panel,n.cellType),l="";this._szRowCol=null;(r==t.CellType.ColumnHeader||r==t.CellType.TopLeft||r==t.CellType.Cell&&4&o.allowResizing)&&n.edgeRight&&0!=(o.allowResizing&i.Columns)&&(this._szRowCol=this._getResizeCol(n));(r==t.CellType.RowHeader||r==t.CellType.TopLeft||r==t.CellType.Cell&&4&o.allowResizing)&&n.edgeBottom&&0!=(o.allowResizing&i.Rows)&&(this._szRowCol=this._getResizeRow(n));this._szRowCol instanceof t.Column?l="col-resize":this._szRowCol instanceof t.Row&&(l="row-resize");this._szStart=this._szRowCol?this._szRowCol.renderSize:0;o.hostElement.style.cursor=l;return n}return null};_MouseHandler.prototype._getResizeCol=function(e){for(var i=e.panel.columns,o=i[e.col],n=e.col+1;n<i.length;n++){if((r=i[n]).visible){r.renderSize<1&&(o=r);break}}if(e.col==i.length-1&&(e.cellType==t.CellType.TopLeft||e.cellType==t.CellType.RowHeader)){i=this._g.columns;for(n=0;n<i.length;n++){var r;if((r=i[n]).visible){r.renderSize<1&&(o=r);break}}}return o.allowResizing?o:null};_MouseHandler.prototype._getResizeRow=function(e){for(var i=e.panel.rows,o=i[e.row],n=e.row+1;n<i.length;n++){if((r=i[n]).visible){r.renderSize<1&&(o=r);break}}if(e.row==i.length-1&&(e.cellType==t.CellType.TopLeft||e.cellType==t.CellType.ColumnHeader)){i=this._g.rows;for(n=0;n<i.length;n++){var r;if((r=i[n]).visible){r.renderSize<1&&(o=r);break}}}return o.allowResizing?o:null};_MouseHandler.prototype._mouseSelect=function(i,o){var n=this,r=this._g;if(i&&this._htDown&&this._htDown.panel&&r.selectionMode!=t.SelectionMode.None){var l=new t.HitTestInfo(this._htDown.panel,i);this._handleSelection(l,o);!e.isIE9()&&i.button>=0&&i.target!=r._root&&(l=new t.HitTestInfo(r,i)).cellType!=t.CellType.Cell&&l.cellType!=t.CellType.RowHeader&&setTimeout((function(){n._isDown&&n._eMouse&&n._mouseSelect(n._eMouse,o)}),100)}};_MouseHandler.prototype._handleResizing=function(i){i.preventDefault();if(this._szRowCol instanceof t.Column){var o=this._g,n=e.mouseToPage(i).x,r=Math.round(Math.max(_MouseHandler._SZ_MIN,this._szStart+(n-this._htDown.point.x)*(o.rightToLeft?-1:1)));if(this._szRowCol.renderSize!=r){if(null==this._szArgs){var l=o.rowHeaders.columns.indexOf(this._szRowCol)>-1?o.rowHeaders:o.cells;this._szArgs=new t.CellRangeEventArgs(l,new t.CellRange(-1,this._szRowCol.index))}this._szArgs.cancel=!1;o.onResizingColumn(this._szArgs)&&(o.deferResizing?this._showResizeMarker(r):this._szRowCol.width=r)}}if(this._szRowCol instanceof t.Row){o=this._g;var s=e.mouseToPage(i).y;r=Math.round(Math.max(_MouseHandler._SZ_MIN,this._szStart+(s-this._htDown.point.y)));if(this._szRowCol.renderSize!=r){if(null==this._szArgs){l=o.columnHeaders.rows.indexOf(this._szRowCol)>-1?o.columnHeaders:o.cells;this._szArgs=new t.CellRangeEventArgs(l,new t.CellRange(this._szRowCol.index,-1))}this._szArgs.cancel=!1;o.onResizingRow(this._szArgs)&&(o.deferResizing?this._showResizeMarker(r):this._szRowCol.height=r)}}};_MouseHandler.prototype._dragstart=function(i){var n=this._g,r=this._htDown,l=o;if(r){this._dragSrc=null;this._htDrag=null;if(!this._szRowCol){var s=new t.CellRangeEventArgs(r.panel,r.range);if(r.cellType==t.CellType.ColumnHeader&&n.allowDragging&l.Columns&&r.col>-1&&n.columns[r.col].allowDragging)n.onDraggingColumn(s)?this._dragSrc=i.target:i.preventDefault();else if(r.cellType==t.CellType.RowHeader&&n.allowDragging&l.Rows&&r.row>-1&&n.rows[r.row].allowDragging){var a=n.rows[r.row];a instanceof t.GroupRow||a instanceof t._NewRowTemplate||(n.onDraggingRow(s)?this._dragSrc=i.target:i.preventDefault())}else r.cellType==t.CellType.TopLeft&&n.allowDragging&l.Columns&&r.col>-1&&n.topLeftCells.columns[r.col].allowDragging&&(n.onDraggingColumn(s)?this._dragSrc=i.target:i.preventDefault())}if(this._dragSrc&&i.dataTransfer&&!i.defaultPrevented){this._htDrag=r;e._startDrag(i.dataTransfer,"move");i.stopPropagation();e.addClass(this._dragSrc,"wj-state-dragsrc");n.beginUpdate();this._updating=!0}}};_MouseHandler.prototype._dragend=function(e){this._dragSrc=null;this._htDrag=null;this.resetMouseState()};_MouseHandler.prototype._dragover=function(i){var o=this._g,n=this._hitTest(i),r=this._dragSrc?this._htDrag:null,l=t.CellType,s=!1;if(r&&n.cellType==r.cellType){var a=new t.CellRangeEventArgs(n.panel,n.range,r);if(n.cellType==l.ColumnHeader){a.cancel=!o.columns.canMoveElement(r.col,n.col);s=o.onDraggingColumnOver(a)}else if(n.cellType==l.RowHeader){a.cancel=!o.rows.canMoveElement(r.row,n.row);s=o.onDraggingRowOver(a)}else if(n.cellType==l.TopLeft){a.cancel=!o.topLeftCells.columns.canMoveElement(r.col,n.col);s=o.onDraggingColumnOver(a)}}if(s){i.dataTransfer.dropEffect="move";this._showDragMarker(n);i.preventDefault();i.stopPropagation()}else this._showDragMarker(null);if(r&&o.autoScroll){var c=o.controlRect,u=o.scrollPosition,d=e.Control._DRAG_SCROLL_EDGE,h=e.Control._DRAG_SCROLL_STEP;if(r.panel==o.columnHeaders){i.pageX-c.left<d&&(u.x+=h);c.right-i.pageX<d&&(u.x-=h)}else if(r.panel==o.rowHeaders){i.pageY-c.top<d&&(u.y+=h);c.bottom-i.pageY<d&&(u.y-=h)}if(!u.equals(o._ptScrl)){o.scrollPosition=u;o._rcBounds=null}}};_MouseHandler.prototype._drop=function(e){var i=this._g,o=this._hitTest(e),n=this._dragSrc?this._htDrag:null,r=t.CellType;if(n&&o.cellType==n.cellType){var l=i.selection,s=new t.CellRangeEventArgs(o.panel,o.range,n);if(o.cellType==r.ColumnHeader){i.columns.moveElement(n.col,o.col);i.select(l.row,o.col);i.onDraggedColumn(s)}else if(o.cellType==r.RowHeader){i.rows.moveElement(n.row,o.row);i.select(o.row,l.col);i.onDraggedRow(s)}else if(o.cellType==r.TopLeft){i.topLeftCells.columns.moveElement(n.col,o.col);i.onDraggedColumn(s)}}this.resetMouseState()};_MouseHandler.prototype._hitTest=function(e){var t=this._g;t._rcBounds=null;return t.hitTest(e)};_MouseHandler.prototype._showResizeMarker=function(i){var o,n=this._g,r=n._ptScrl,l=this._szArgs.panel.cellType,s=t.CellType,a=this._dvMarker,c=n.cells.hostElement;a.parentElement!=c&&c.appendChild(a);if(this._szRowCol instanceof t.Column){o={left:this._szRowCol.pos+i-1,top:-1e3,right:"",bottom:0,width:3,height:""};l!=s.TopLeft&&l!=s.RowHeader||(o.left-=n._eTL.offsetWidth+r.x);l==s.Cell&&this._szRowCol.index<n.frozenColumns&&(o.left-=r.x);n.rightToLeft&&(o.left=c.clientWidth-o.left-o.width)}else{o={left:-1e3,top:this._szRowCol.pos+i-1,right:0,bottom:"",width:"",height:3};l!=s.TopLeft&&l!=s.ColumnHeader||(o.top-=n._eTL.offsetHeight+r.y);l==s.Cell&&this._szRowCol.index<n.frozenRows&&(o.top-=r.y)}e.setCss(a,o)};_MouseHandler.prototype._showDragMarker=function(i){var o=this._dvMarker;if(i&&i.panel){if(!i.range.equals(this._rngTarget)){this._rngTarget=i.range;var n=i.panel.hostElement;o.parentElement!=n&&n.appendChild(o);var r=this._g,l=r._ptScrl,s=t.CellType,a={left:0,top:0,width:6,height:6,right:"",bottom:""};switch(i.cellType){case s.TopLeft:case s.ColumnHeader:var c=i.panel.columns[i.col];a.left=c.pos-a.width/2;a.height=i.panel.height;this._htDown&&i.col>this._htDown.col&&(a.left+=c.renderWidth);i.cellType==s.ColumnHeader&&i.col<r.frozenColumns&&(a.left-=l.x);r.rightToLeft&&(a.left=o.parentElement.clientWidth-a.left-a.width);break;case s.RowHeader:var u=i.panel.rows[i.row];a.top=u.pos-a.height/2;a.width=i.panel.width;i.row>this._htDown.row&&(a.top+=u.renderHeight);i.row<r.frozenRows&&(a.top-=l.y)}e.setCss(o,a)}}else{e.removeChild(o);this._rngTarget=null}};_MouseHandler.prototype._finishResizing=function(i){var o=this._g,n=o.selection,r=this._szArgs,l=this._eMouse&&this._eMouse.ctrlKey,s=t.CellType;if(r&&!r.cancel){if(r.col>-1){var a=r.col,c=e.mouseToPage(i).x,u=Math.round(Math.max(_MouseHandler._SZ_MIN,this._szStart+(c-this._htDown.point.x)*(this._g.rightToLeft?-1:1)));r.panel.columns[a].width=Math.round(u);o.onResizedColumn(r);if(l&&this._htDown.cellType==s.ColumnHeader&&n.containsColumn(a))for(var d=n.leftCol;d<=n.rightCol;d++)if(o.columns[d].allowResizing&&d!=a){r=new t.CellRangeEventArgs(o.cells,new t.CellRange(-1,d));if(o.onResizingColumn(r)){o.columns[d].size=o.columns[a].size;o.onResizedColumn(r)}}}if(r.row>-1){a=r.row;var h=e.mouseToPage(i).y;u=Math.round(Math.max(_MouseHandler._SZ_MIN,this._szStart+(h-this._htDown.point.y)));r.panel.rows[a].height=Math.round(u);o.onResizedRow(r);if(l&&this._htDown.cellType==s.RowHeader&&n.containsRow(a))for(var g=n.topRow;g<=n.bottomRow;g++)if(o.rows[g].allowResizing&&g!=a){r=new t.CellRangeEventArgs(o.cells,new t.CellRange(g,-1));if(o.onResizingRow(r)){o.rows[g].size=o.rows[a].size;o.onResizedRow(r)}}}}};_MouseHandler.prototype._startListBoxSelection=function(e){var t=this._g.rows,i=this._lbSelRows={};this._lbSelState=!t[e].isSelected;for(var o=0;o<t.length;o++)t[o].isSelected&&(i[o]=!0)};_MouseHandler.prototype._handleSelection=function(e,i){var o=this._g,n=o.rows,r=o._selHdl.selection,l=new t.CellRange(e.row,e.col);if(e.row>-1&&e.col>-1)if(null!=this._lbSelRows){var s=!1;l=new t.CellRange(e.row,e.col,this._htDown.row,this._htDown.col);for(var a=0;a<n.length;a++){var c=l.containsRow(a)?this._lbSelState:null!=this._lbSelRows[a];if(c!=n[a].isSelected){var u=new t.CellRangeEventArgs(o.cells,new t.CellRange(a,r.col,a,r.col2));if(o.onSelectionChanging(u)){n[a]._setFlag(t.RowColFlags.Selected,c,!0);s=!0;o.onSelectionChanged(u)}}}s&&o.refreshCells(!1,!0,!0);o.scrollIntoView(e.row,e.col)}else{if(i)if(o.anchorCursor){l.row=r.row;l.col=r.col}else{l.row2=r.row2;l.col2=r.col2}if(o.selectionMode==t.SelectionMode.MultiRange){var d=o._mouseHdl._eMouse,h=o._selHdl.extendedSelection;if(d&&(d.ctrlKey||d.metaKey)){var g=o.selection;g.intersects(l)||h.push(g)}else h.clear()}if(e.cellType==t.CellType.RowHeader){l.col=0;l.col2=o.columns.length-1;o.select(l,!1);o.scrollIntoView(e.row,-1)}else o.select(l)}};_MouseHandler._SZ_MIN=0;return _MouseHandler}();t._MouseHandler=n}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){e.grid||(e.grid={}),e._registerModule("wijmo.grid",e.grid)}(wijmo||(wijmo={}));